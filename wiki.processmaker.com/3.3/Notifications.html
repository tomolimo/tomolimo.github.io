<!DOCTYPE html>

<!-- Mirrored from wiki.processmaker.com/3.3/Notifications by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Feb 2024 09:33:46 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta name="keywords" content="BPM, business process management, workflow, processmaker, business, BPM Windows, BPM Linux, wiki, BPM documentation, BPM FAQ, task documentation, BPM PHP, BPM Open Source, BPM Variables, BPM Installation, BPM Programming, BPM Elements, BPM Concepts, BPM Frequently Asked Questions, BPM 3.0, BPM News, Release notes, DynaForms, BPM Community, BPM Enterprise, BPM Mobile, BPM Responsive Web Design, User Manual, BPM Resources" />
<link rel="alternate" hreflang="en" href="../index.html" />
<link rel="shortcut icon" href="../themes/thecompany_responsive_theme/favicon.ico" type="image/vnd.microsoft.icon" />
<meta name="description" content="ProcessMaker is commercial open source workflow and business process management software." />
<meta name="viewport" content="width=device-width" />
<meta name="Generator" content="Drupal 7 (http://drupal.org)" />
<link rel="canonical" href="Notifications.html" />
<link rel="shortlink" href="../node/894.html" />
<title>3.3 -  3.6 - Notifications | Documentation@ProcessMaker</title>
<style type="text/css" media="all">
@import url("../modules/system/system.base2af9.css?s743n7");
@import url("../modules/system/system.menus2af9.css?s743n7");
@import url("../modules/system/system.messages2af9.css?s743n7");
@import url("../modules/system/system.theme2af9.css?s743n7");
</style>
<style type="text/css" media="all">
@import url("../modules/aggregator/aggregator2af9.css?s743n7");
@import url("../modules/comment/comment2af9.css?s743n7");
@import url("../modules/field/theme/field2af9.css?s743n7");
@import url("../modules/node/node2af9.css?s743n7");
@import url("../modules/search/search2af9.css?s743n7");
@import url("../modules/toc_filter/toc_filter2af9.css?s743n7");
@import url("../modules/user/user2af9.css?s743n7");
@import url("../modules/views/css/views2af9.css?s743n7");
</style>
<style type="text/css" media="all">
@import url("../sites/all/modules/colorbox/styles/default/colorbox_style2af9.css?s743n7");
@import url("../modules/ctools/css/ctools2af9.css?s743n7");
@import url("../sites/all/modules/geshifilter/geshifilter2af9.css?s743n7");
@import url("../modules/panels/css/panels2af9.css?s743n7");
@import url("../modules/nice_menus/css/nice_menus2af9.css?s743n7");
@import url("../modules/nice_menus/css/nice_menus_default2af9.css?s743n7");
@import url("../modules/fivestar/css/fivestar2af9.css?s743n7");
</style>
<style type="text/css" media="all">
@import url("../themes/thecompany_responsive_theme/css/style2af9.css?s743n7");
@import url("../themes/thecompany_responsive_theme/css/media2af9.css?s743n7");
</style>
<script type="text/javascript" src="../modules/jquery_update/replace/jquery/1.9/jquery.min4b17.js?v=1.9.1"></script>
<script type="text/javascript" src="../misc/jquery.once7839.js?v=1.2"></script>
<script type="text/javascript" src="../misc/drupal2af9.js?s743n7"></script>
<script type="text/javascript" src="../modules/nice_menus/js/jquery.bgiframef195.js?v=2.1"></script>
<script type="text/javascript" src="../modules/nice_menus/js/jquery.hoverIntent1f6b.js?v=0.5"></script>
<script type="text/javascript" src="../modules/nice_menus/js/superfish099d.js?v=1.4.8"></script>
<script type="text/javascript" src="../modules/nice_menus/js/nice_menusc619.js?v=1.0"></script>
<script type="text/javascript" src="../modules/jquery_update/replace/ui/external/jquery.cookie1683.js?v=67fb34f6a866c40d0570"></script>
<script type="text/javascript" src="../modules/jquery_update/replace/misc/jquery.form.min97e5.js?v=2.69"></script>
<script type="text/javascript" src="../misc/ajax2347.js?v=7.34"></script>
<script type="text/javascript" src="../modules/jquery_update/js/jquery_update241d.js?v=0.0.1"></script>
<script type="text/javascript" src="../modules/toc_filter/toc_filter2af9.js?s743n7"></script>
<script type="text/javascript" src="../sites/all/modules/colorbox/js/colorbox2af9.js?s743n7"></script>
<script type="text/javascript" src="../sites/all/modules/colorbox/styles/default/colorbox_style2af9.js?s743n7"></script>
<script type="text/javascript" src="../sites/all/modules/google_analytics/googleanalytics2af9.js?s743n7"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
(function(i,s,o,g,r,a,m){i["GoogleAnalyticsObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,"script","../../www.google-analytics.com/analytics.js","ga");ga("create", "UA-3380652-1", {"cookieDomain":"auto"});ga("set", "anonymizeIp", true);ga("send", "pageview");
//--><!]]>
</script>
<script type="text/javascript" src="../misc/progress2347.js?v=7.34"></script>
<script type="text/javascript" src="../modules/fivestar/js/fivestar.ajax2af9.js?s743n7"></script>
<script type="text/javascript" src="../modules/fivestar/js/fivestar2af9.js?s743n7"></script>
<script type="text/javascript" src="../themes/thecompany_responsive_theme/js/jquery-1.10.2.min2af9.js?s743n7"></script>
<script type="text/javascript" src="../themes/thecompany_responsive_theme/js/jquery-ui2af9.js?s743n7"></script>
<script type="text/javascript" src="../themes/thecompany_responsive_theme/js/jquery-ui.min2af9.js?s743n7"></script>
<script type="text/javascript" src="../themes/thecompany_responsive_theme/js/custom2af9.js?s743n7"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"thecompany_responsive_theme","theme_token":"jBgRfKYL4VTpwrazAmUsLXAHs0Dr4iIC5hWhf_rFo7o","jquery_version":"1.9","js":{"modules\/jquery_update\/replace\/jquery\/1.9\/jquery.min.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"modules\/nice_menus\/js\/jquery.bgiframe.js":1,"modules\/nice_menus\/js\/jquery.hoverIntent.js":1,"modules\/nice_menus\/js\/superfish.js":1,"modules\/nice_menus\/js\/nice_menus.js":1,"modules\/jquery_update\/replace\/ui\/external\/jquery.cookie.js":1,"modules\/jquery_update\/replace\/misc\/jquery.form.min.js":1,"misc\/ajax.js":1,"modules\/jquery_update\/js\/jquery_update.js":1,"modules\/toc_filter\/toc_filter.js":1,"sites\/all\/modules\/colorbox\/js\/colorbox.js":1,"sites\/all\/modules\/colorbox\/styles\/default\/colorbox_style.js":1,"sites\/all\/modules\/google_analytics\/googleanalytics.js":1,"0":1,"misc\/progress.js":1,"modules\/fivestar\/js\/fivestar.ajax.js":1,"modules\/fivestar\/js\/fivestar.js":1,"themes\/thecompany_responsive_theme\/js\/jquery-1.10.2.min.js":1,"themes\/thecompany_responsive_theme\/js\/jquery-ui.js":1,"themes\/thecompany_responsive_theme\/js\/jquery-ui.min.js":1,"themes\/thecompany_responsive_theme\/js\/custom.js":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/system\/system.theme.css":1,"modules\/aggregator\/aggregator.css":1,"modules\/comment\/comment.css":1,"modules\/field\/theme\/field.css":1,"modules\/node\/node.css":1,"modules\/search\/search.css":1,"modules\/toc_filter\/toc_filter.css":1,"modules\/user\/user.css":1,"modules\/views\/css\/views.css":1,"sites\/all\/modules\/colorbox\/styles\/default\/colorbox_style.css":1,"modules\/ctools\/css\/ctools.css":1,"sites\/all\/modules\/geshifilter\/geshifilter.css":1,"modules\/panels\/css\/panels.css":1,"modules\/nice_menus\/css\/nice_menus.css":1,"modules\/nice_menus\/css\/nice_menus_default.css":1,"modules\/fivestar\/css\/fivestar.css":1,"themes\/thecompany_responsive_theme\/css\/style.css":1,"themes\/thecompany_responsive_theme\/css\/media.css":1}},"colorbox":{"opacity":"0.85","current":"{current} of {total}","previous":"\u00ab Prev","next":"Next \u00bb","close":"Close","maxWidth":"98%","maxHeight":"98%","fixed":true,"mobiledetect":true,"mobiledevicewidth":"480px","specificPagesDefaultValue":"admin*\nimagebrowser*\nimg_assist*\nimce*\nnode\/add\/*\nnode\/*\/edit\nprint\/*\nprintpdf\/*\nsystem\/ajax\nsystem\/ajax\/*"},"toc_filter_smooth_scroll_duration":"","googleanalytics":{"trackOutbound":1,"trackMailto":1,"trackDownload":1,"trackDownloadExtensions":"7z|aac|arc|arj|asf|asx|avi|bin|csv|doc(x|m)?|dot(x|m)?|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt(x|m)?|pot(x|m)?|pps(x|m)?|ppam|sld(x|m)?|thmx|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls(x|m|b)?|xlt(x|m)|xlam|xml|z|zip","trackColorbox":1},"nice_menus_options":{"delay":"800","speed":"slow"},"ajax":{"edit-vote--2":{"callback":"fivestar_ajax_submit","event":"change","url":"\/system\/ajax","submit":{"_triggering_element_name":"vote"}}}});
//--><!]]>
</script>
<!--[if lt IE 9]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','../../connect.facebook.net/en_US/fbevents.js');
// Insert Your Facebook Pixel ID below.
fbq('init', '735235999992228');
fbq('track', 'PageView');
</script>
<!-- Insert Your Facebook Pixel ID below. -->
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=735235999992228&amp;ev=PageView&amp;noscript=1"
/></noscript>
<!-- End Facebook Pixel Code -->

</head>
<body class="html not-front not-logged-in no-sidebars page-node page-node- page-node-894 node-type-processmakerbpm">
    
<div class="wrap">

<div id="header_wrapper">
  <div id="inner_header_wrapper">

    <header id="header" role="banner">
      
      <div class="header_inner_wrapper">
        <div class="header_left">
                      <div id="logo">
              <a href="../index.html" title="Home"><img src="../sites/default/files/full-logo.png"/></a>
            </div>
                    	  <div class="menu_wrapper">
            <nav id="main-menu"  role="navigation">
              <a class="nav-toggle" href="#">Navigation</a>
              <div class="menu-navigation-container">
                <ul class="menu"><li class="first leaf"><a href="../PM_Classic.html" title="Learn how to develop business solutions in ProcessMaker Platform while maintaining your existing ProcessMaker 3 solutions in PM Classic: the perfect bridge between your new and existing solutions with a state-of--the-art BPM platform.">PM Classic</a></li>
<li class="leaf"><a href="http://www.processmaker.com/tutorials" title="">Tutorials</a></li>
<li class="leaf"><a href="../3.1/user_guide.html">User Guide</a></li>
<li class="leaf"><a href="../3.1/developer_info.html">Developer Info</a></li>
<li class="leaf"><a href="../3.2/sys_administration.html">Sys Administration</a></li>
<li class="leaf"><a href="../3.1/resources.html">Helpful Resources</a></li>
<li class="leaf"><a href="../Sitemap.html">Sitemap</a></li>
<li class="last leaf"><a href="https://processmaker.gitbook.io/processmaker/" title="Read ProcessMaker Platform Spring 2023 documentation to learn more about the next generation of BPM.">ProcessMaker Platform</a></li>
</ul>              </div>
              <div class="clear"></div>
            </nav>
          </div>
                  <!--  <h1 id="site-title">
            <a href="/" title="Home">Documentation@ProcessMaker</a>
            <div id="site-description"></div>
          </h1> -->
            
        </div>
      </div>
      <div class="header_right">
          <div class="region region-search">
  <div id="block-search-form" class="block block-search">

        <h2 >_</h2>
    
  <div class="content">
    <form action="https://wiki.processmaker.com/3.3/Notifications" method="post" id="search-block-form" accept-charset="UTF-8"><div><div class="container-inline">
    <div class="form-item form-type-textfield form-item-search-block-form">
  <label class="element-invisible" for="edit-search-block-form--2">Search </label>
 <input title="Enter the terms you wish to search for." placeholder="Search" type="text" id="edit-search-block-form--2" name="search_block_form" value="" size="15" maxlength="128" class="form-text" />
</div>
<div class="form-actions form-wrapper" id="edit-actions"><input type="submit" id="edit-submit" name="op" value="Search" class="form-submit" /></div><input type="hidden" name="form_build_id" value="form-5cAYUFP60_qAnuAB8TTv98n9miD9fFF9MT95MX-QLDg" />
<input type="hidden" name="form_id" value="search_block_form" />
</div>
</div></form>  </div>
  
</div> <!-- /.block -->
</div>
 <!-- /.region -->
                  <h1 class="page-title">3.3 -  3.6 - Notifications</h1>                <p class="page-title-suffix"></p>
                 <div style="margin-top: 5px;"></div>
      </div>
    </header>
    <div class="region-version">
      <span>Version: </span><ul><li><a href="../3.7/Notifications.html" class="">3.8</a></li><li><a href="../3.7/Notifications.html" class="">3.7</a></li><li><a  class="active-version">3.6</a></li><li><a  class="active-version">3.5</a></li><li><a  class="active-version">3.4</a></li><li><a  class="active-version">3.3</a></li><li><a href="../3.2/Notifications.html" class="">3.2</a></li><li><a href="../3.1/Notifications.html" class="">3.1</a></li><li><a href="../3.0/Notifications.html" class="">3.0</a></li><li><a href="../index.php/Notifications.html" class="">2.x</a></li></ul>    </div>
  </div>
</div>
<!-- <ul class="nice-menu nice-menu-down nice-menu-main-menu" id="nice-menu-0"><li class="menu-506 menu-path-node-1078 first odd "><a href="/PM_Classic" title="Learn how to develop business solutions in ProcessMaker Platform while maintaining your existing ProcessMaker 3 solutions in PM Classic: the perfect bridge between your new and existing solutions with a state-of--the-art BPM platform.">PM Classic</a></li>
<li class="menu-319 menu-path-processmakercom-tutorials  even "><a href="http://www.processmaker.com/tutorials" title="">Tutorials</a></li>
<li class="menu-320 menu-path-node-571  odd "><a href="/3.1/user_guide">User Guide</a></li>
<li class="menu-1138 menu-path-node-572  even "><a href="/3.1/developer_info">Developer Info</a></li>
<li class="menu-1197 menu-path-node-876  odd "><a href="/3.2/sys_administration">Sys Administration</a></li>
<li class="menu-1140 menu-path-node-236  even "><a href="/3.1/resources">Helpful Resources</a></li>
<li class="menu-1141 menu-path-node-554  odd "><a href="/Sitemap">Sitemap</a></li>
<li class="menu-1213 menu-path-sprocessmakergitbookio-processmaker-  even last"><a href="https://processmaker.gitbook.io/processmaker/" title="Read ProcessMaker Platform Spring 2023 documentation to learn more about the next generation of BPM.">ProcessMaker Platform</a></li>
</ul>
-->
  
  <div id="container">
    
    <div class="content-sidebar-wrap">

    <div id="content">

              <!-- <div id="breadcrumbs">
        <h2 class="element-invisible">You are here</h2><div class="breadcrumb"><a href="/">Home</a></div></div> -->
      
      <section id="post-content" role="main">
                                        <div class="region region-content">
  <div id="block-system-main" class="block block-system">

      
  <div class="content">
                          <span property="dc:title" content="3.3 -  3.6 - Notifications" class="rdf-meta element-hidden"></span>  
      
    
  <div class="content node-processmakerbpm">
    <div class="field field-name-field-how-useful-did-you-find-th field-type-fivestar field-label-above"><div class="field-label">Please rate how useful you found this document:&nbsp;</div><div class="field-items"><div class="field-item even"><form class="fivestar-widget" action="https://wiki.processmaker.com/3.3/Notifications" method="post" id="fivestar-custom-widget" accept-charset="UTF-8"><div><div  class="clearfix fivestar-average-text fivestar-average-stars fivestar-form-item fivestar-default"><div class="form-item form-type-fivestar form-item-vote">
 <div class="form-item form-type-select form-item-vote">
 <select id="edit-vote--2" name="vote" class="form-select"><option value="-">Select rating</option><option value="20">Give 3.3 -  3.6 - Notifications 1/5</option><option value="40" selected="selected">Give 3.3 -  3.6 - Notifications 2/5</option><option value="60">Give 3.3 -  3.6 - Notifications 3/5</option><option value="80">Give 3.3 -  3.6 - Notifications 4/5</option><option value="100">Give 3.3 -  3.6 - Notifications 5/5</option></select>
<div class="description"><div class="fivestar-summary fivestar-summary-average-count"><span class="average-rating">Average: <span >2</span></span> <span class="total-votes">(<span >4</span> votes)</span></div></div>
</div>

</div>
</div><input class="fivestar-submit form-submit" type="submit" id="edit-fivestar-submit" name="op" value="Rate" /><input type="hidden" name="form_build_id" value="form-xeQ7NCjezv1WemjH_jda432CRPnqC0e4FsZIdQE8h1c" />
<input type="hidden" name="form_id" value="fivestar_custom_widget" />
</div></form></div></div></div><div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><div style="float: right; margin-left: 5px; background-color: #f9f9f9; border: 1px solid #aaaaaa; padding: 5px;"><center><strong>Contents:</strong> [<a href="#" onclick="var el = document.getElementById('toc');
        var txt = ('innerText' in el)? 'innerText' : 'textContent';
        if (el.style.display=='none') { 
           el.style.display = '';
           document.getElementById('hideLabel')[txt] = 'hide';
        }
        else {
	        el.style.display = 'none';
           document.getElementById('hideLabel')[txt] = 'show';
        }"><span id="hideLabel">hide</span></a>]</b></center><div id="toc" ><ol class="toc">
<li class="toc"><a href="#Overview">Overview</a></li>
<li class="toc"><a href="#Task_Notifications">Task Notifications</a></li>
<ol class="toc">
<li class="toc"><a href="#Inserting_Variables">Inserting Variables</a></li>
</ol>
<li class="toc"><a href="#Message_Events">Message Events</a></li>
<li class="toc"><a href="#Trigger_Messages">Trigger Messages</a></li>
<ol class="toc">
<li class="toc"><a href="#Create_the_HTML_Email_Template">Create the HTML Email Template</a></li>
<ol class="toc">
<li class="toc"><a href="#links_in_templates">Links to Cases in Templates</a></li>
<ol class="toc">
<li class="toc"><a href="#redirecting_to_main_page">Redirecting to the <code>../cases/main</code> Page</a></li>
</ol>
<li class="toc"><a href="#grids_in_templates">Grids in Templates</a></li>
</ol>
<li class="toc"><a href="#Sending_emails_with_PMFSendMessage.28.29">Sending Emails with PMFSendMessage() or PMFSendMessageToGroup()</a></li>
<li class="toc"><a href="#Assigning_the_trigger_to_step.28s.29">Assigning the Trigger to Step(s)</a></li>
</ol>
<li class="toc"><a href="#Trigger_Message_Examples">Trigger Message Examples</a></li>
<ol class="toc">
<li class="toc"><a href="#Emailing_the_Current_Assigned_User_for_a_Case">Emailing the Current Assigned User of a Case</a></li>
<li class="toc"><a href="#Emailing_the_Supervisor_of_a_Case.27s_Assigned_User">Emailing the Supervisor of a Case's Assigned User</a></li>
<li class="toc"><a href="#Emailing_the_Previous_User_for_a_Case">Emailing the Previous User of a Case</a></li>
<li class="toc"><a href="#Emailing_the_Previous_User_with_a_Database_Query">Emailing the Previous User with a Database Query</a></li>
<li class="toc"><a href="#Emailing_the_Next_Assigned_User">Emailing the Next Assigned User</a></li>
<ol class="toc">
<li class="toc"><a href="#For_Next_Tasks_with_Cyclical_Assignment">For Next Tasks with Cyclical Assignment</a></li>
<li class="toc"><a href="#For_Next_Tasks_with_Any_Type_of_Assignment_Rule">For Next Tasks with Any Type of Assignment Rule</a></li>
</ol>
<li class="toc"><a href="#Emailing_the_Next_Assigned_Users_of_Parallel_Tasks">Emailing the Next Assigned Users of Parallel Tasks</a></li>
<li class="toc"><a href="#Emailing_all_Assigned_Users_for_a_Task">Emailing all Assigned Users of a Task</a></li>
<li class="toc"><a href="#Emailing_All_Assigned_Users_to_the_Next_Task.28s.29">Emailing All Assigned Users of the Next Task(s)</a></li>
<li class="toc"><a href="#Emailing_all_Participants_in_a_Case">Emailing all Participants in a Case</a></li>
<li class="toc"><a href="#Emailing_Members_of_a_Department">Emailing Members of a Department</a></li>
<li class="toc"><a href="#Emailing_Members_of_a_Group">Emailing Members of a Group</a></li>
<li class="toc"><a href="#Emailing_Users_with_a_Role">Emailing Users with a Role</a></li>
<li class="toc"><a href="#Emailing_when_Cases_are_Canceled.2FPaused.2FReassigned">Emailing when Cases are Canceled/Paused/Reassigned</a></li>
</ol>
<li class="toc"><a href="#Debugging_Email_Notifications">Debugging Email Notifications</a></li>
<ol class="toc">
<li class="toc"><a href="#Check_the_PMFSendMessage.28.29_Return_Value">Check the <tt>PMFSendMessage()</tt> or <tt>PMFSendMessageToGroup()</tt> Return Value</a></li>
<li class="toc"><a href="#Check_the_APP_MESSAGE_table">Check the <tt>APP_MESSAGE</tt> Table</a></li>
<li class="toc"><a href="#Check_the_Output_of_cron.php">Check the Output of <tt>cron.php</tt></a></li>
</ol>
<li class="toc"><a href="#Log_Module_to_manage_notifications">Log Module to Manage Notifications</a></li>
<ol class="toc">
<li class="toc"><a href="#Best_Practices_When_Managing_Large_Amount_Of_Data">Bests Practices When Managing A Large Amount Of Data In The Message Inbox</a></li>
<li class="toc"><a href="#Email_Log_Options">Email Log Options</a></li>
<li class="toc"><a href="#Searching_Emails">Searching Emails</a></li>
</ol>
</div></div>

<h2><span id="Overview">Overview</span></h2>
<p>Notifications can be used to keep users apprised of new cases in their inbox and notify them at specified times while running cases. In ProcessMaker, all notifications are sent to users via email, which is why it is important to enter a valid email address for each user and properly configure ProcessMaker to <a href="../3.0/Email_Settings.html" title="Email Settings">connect to an email server</a> to sent out notifications.</p>

<p><strong>There are three types of notifications:</strong></p>
<ul>
<li><a href="#Task_Notifications">Task Notifications</a>, which are sent when a user is designated to work on a task in a case.</li>
<li><a href="#Message_Events">Message Events</a>, which are sent at specified times based on when tasks (or groups of tasks) begin in a case.</li>
<li><a href="#Trigger_Messages">Trigger Messages</a>, which are sent out using the <a href="#Sending_emails_with_PMFSendMessage.28.29">PMFSendMessage() and PMFSendMessageToGroup()</a> function.</li>
</ul>

<p>The subject line and body of these email notifications can be customized, and system variables and case variables can be inserted to personalize the email for the recipient using data from the current case.</p>

<p>The content of Task Notifications is in plain text, which is defined in the Task Properties. In contrast, the content of Message Events and Trigger Messages is specified inside a template file, which permits the use of HTML formatting. The template file can be created using ProcessMaker's <a href="../3.0/Templates.html" title="Templates">template editor</a> or <a href="../3.0/Templates.html#ManagingTemplates" title="Managing Templates">uploaded</a> after being created in an external HTML editor, such as FrontPage, DreamWeaver or <a class="external text" href="http://bluegriffon.org/" rel="nofollow">BlueGriffon</a>.</p>

<p style="margin-left:25px"><strong><font color="green">Note:</font></strong><font color="dimgray"> Emails are sent to the configured email server when <a href="../3.0/Executing_cron.html" title="Executing cron.php"><tt>cron.php</tt> is executed</a>, so the ProcessMaker server needs to be configured to execute a <tt>cron</tt> job in Linux/UNIX or a <strong>Scheduled Task</strong> in Windows.</font></p>

<h2><span id="Task_Notifications">Task Notifications</span></h2>
<p style="margin-left:25px"><font color="green"><strong>Note:</strong></font> <font color="dimgray">Take into consideration that in cases where the next task of the process routes to a <a href="../3.0/Sub-Processes.html">sub-process</a>, the case number in the Task Notifications will be the case number of the master process.</font></p>

<p>Task Notifications are useful for keeping users apprised when they have been assigned to work on a task in a case.</p>
<p>To create a message to be sent to an assigned user, go to the <strong>Designer</strong> menu and open a process for editing. In the process map, <i>right click</i> on the task that should send out notifications when users are assigned to work on the task when running cases. In the dropdown menu that appears, select the <strong>Properties</strong> option.</p>
<p><img alt="" src="../sites/default/files/PM3_NotificationsProperties.png"></p>

<!--Updated for 3.2 -->
<p>Go to the <strong>Notifications</strong> tab and select to notify either the assigned user of the current task or the next user.<br>
<p><img alt="" src="../sites/default/files/3.3.7NotificationsOption.png"></p>

<ul>
    <li><b>After routing notify the next assigned user(s):</b> This option was included in previous ProcessMaker versions; the process locates the next task and sends the notification to the assigned user.
    <p><img alt="" src="../sites/default/files/3.2AfterRoutingNotifyoption.png"></p></li>

    <li><b>Notify the assigned user to this task:</b> The process will send the notification to the assigned user of the current task when the configured task  is assigned to them. This option is useful when the process design has script tasks, loops or gateways and it is difficult to determine the next assigned user. Notice that when this option is configured in the first task of a process, the notification will not be sent unless there is a loop returning to the first task.
    <p><img alt="" src="../sites/default/files/3.2NotifytheAssignedUseroption.png"></p></li>
</ul>
</p>


<p>Note that both checkboxes can be selected. In that case, two notifications will be sent in different moments.</p>

<p>The notification configuration in both cases are the same:</p>

<p><img src="../sites/default/files/3.3.7TaskNotAfterRoutingSimpleEmail.png"></p>

<ul>
<li><b>Email Account:</b> As of <b>ProcessMaker 3.3.0</b>, the dropdown lists the <strong>Default email account</strong> and <strong>Sender Email</strong> of all the accounts configured in the  <a href="../3.2/Email_Settings.html">email servers</a> of the workspace. Otherwise, the <b>Sender Account</b> value replaces Sender Email if it is empty when the email engine is <a href="../3.2/Email_Settings.html#SMTP_.28PHPMailer.29">SMTP (PHP Mailer)</a> or "Mail (PHP)" replaces Sender Email when the email engine is <a href="../3.2/Email_Settings.html#Mail_.28PHP.29">Mail (PHP)</a>. See <a href="../3.2/Email_Settings.html">this documentation</a> to learn more about Sender Email, Sender Account, SMTP and Mail. Notifications will be sent using the selected email account.
</li>

<li><b>Email from Format:</b> Displays the options "Assigned User" and "Email Account Settings".<br>

<p><img src="../sites/default/files/3.2NotificationsEmailFromFormat.png"></p>

    <ul>
    <li><b>Assigned User: </b>This option sends the email notification to the email account selected in the Email Account field using the <b>name</b> of the user who completed the previous task in the title of the email.<br>
    <img src="../sites/default/files/3.1TaskNotAfterRoutingEmailfromFormat1.png">
    </li>

    <li><b>Email Account Settings: </b>This option sends the email notification using the <b>Sender Email</b> and <b>Sender Name</b> values defined in the email server configuration of the email selected in the <b>Email Account</b> field.<br>
    <img src="../sites/default/files/3.2NotificationsEmailConfig.png">
    
    <p>Note that some mail servers don't allow the <b>Sender Email</b> value to be different from the Sender Account (real email account). In this case, the notification will be sent using the email account selected in the <b>Email Account</b> field.</p>

    </li>
    </ul>
</li>

<li><b>Subject: </b> The subject of the email message. System variables and case variables can be used in the subject of the email message by clicking the @@ button.<br>
<p><img alt="" src="../sites/default/files/3.2NotificationsSubject.png"></p>

</li>

<li><b>Content Type:</b><br>
    <ul>
    <li>For a simple message without formatting, choose the <strong>Plain Text</strong> option. Enter text into the <strong>Message</strong> box. Case variables can be inserted too.<br>
    <img alt="" src="../sites/default/files/3.3.7TaskNotAfterRoutingSimpleEmail.png">
    </li>

    <li>For more control over the formatting, select the <strong>HTML Template</strong> option. Then, select the name of the template file to be used for the body of the email message. To create template files, see <a href="../3.0/Templates.html" title="Templates">Templates</a>.<br>
    <img alt="" src="../sites/default/files/3.3.7TaskNotAfterRoutingHTMLEmail.png">
    </li>
    </ul>
</li>
</ul>

<p>When done defining the Task Notification, click on <strong>Save</strong>.</p>

<p style="margin-left:25px"><strong><font color="green">Note:</font></strong><font color="dimgray"> A Task Notification cannot be sent to a <a href="../3.0/Tasks.html#ScriptTask">Script Task</a> because it doesn't have an assigned user, which is required for a Task Notification to be sent.</font></p>

<h3><span id="Inserting_Variables">Inserting Variables</span></h3>
<p>To insert a variable into the email, click on the <strong>[@@]</strong> button and select the variable to insert. <strong><code>@@<i><font color=blue>variable</font></i></code></strong> will insert the variable enclosed in double quotation marks, whereas <strong><code>@#<i><font color=blue>variable</font></i></code></strong> inserts the variable without quotation marks. Make sure that all variables used in the message have already been created at some earlier point in the process. System variables (such as <code>@@USR_USERNAME</code> and <code>@@APPLICATION</code>) are automatically created and case variables are created in Dynaform fields or defined in triggers.</p>
<p>When a field in a Dynaform is submitted, ProcessMaker stores both a <code>@@<i><font color=blue>variable</font></i></code> and <code>@@<i><font color=blue>variable</font></i>_label</code> for the field, and either variable can be used in the email template. <code>@@<i><font color=blue>variable</font></i></code> is the value that is stored internally by ProcessMaker and <code>@@<i><font color=blue>variable</font></i>_label</code> is the text displayed to the user:
<ul>
<li>For textboxes and textareas, there is no difference between <code>@@<i><font color=blue>variable</font></i></code> and <code>@@<i><font color=blue>variable</font></i>_label</code>.
<p style="margin-left:25px"><strong><font color="green">Note: </font></strong> <font color="dimgray">In order to display line breaks from textareas in email notifications, create the following trigger: 
<div style="margin-left:25px"><div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>myTextArea<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #339933;">@@</span>myTextAreaHtml <span style="color: #339933;">=</span> <a href="http://php.net/preg_replace"><span style="color: #990000;">preg_replace</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;/<span style="color: #000099; font-weight: bold;">\r</span>?<span style="color: #000099; font-weight: bold;">\n</span>/&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'&lt;br&gt;'</span><span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>myTextArea<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> &nbsp;<br />
<span style="color: #009900;">&#125;</span></div></div></div>Set this trigger to execute before the point in the process when the email is sent. Then, insert the variable <code>@#myTextAreaHtml</code> in the notification template</font></p> 
<li>For dropdown boxes and radio buttons, the value of <code>@@<i><font color=blue>variable</font></i></code> is the value/key of the selected option and <code>@@<i><font color=blue>variable</font></i>_label</code> is the displayed text of the selected option. These are defined either in the field's options property or by the first and second fields returned by the sql query. 
<li>A checkbox (which is not in a grid) has a value of <code>["1"]</code> if marked or <code>["0"]</code> if unmarked, so it can't be used directly in a template because it is an array. Instead, use <code>@@<i><font color=blue>variable</font></i>_label</code>, which by default is "<code>true</code>" if marked and "<code>false</code>" if unmarked; however, these values can be changed. If a checkbox is inside a grid, then its <code>@@<i><font color=blue>variable</font></i></code> is set to "<code>1</code>" if marked or "<code>0</code>" if unmarked, which are strings that can be used in templates. 
<li>For datetime fields, <code>@@<i><font color=blue>variable</font></i></code> is the datetime in "<code><font color=blue><i>YYYY-MM-DD HH:MM:SS</i></font></code>" format, such as "<code>2016-02-25 16:03:59</code>". In contrast, <code>@@<i><font color=blue>variable</font></i>_label</code> is the datetime configured by the field's format property. For example, if the format is "<code>MMMM Do, YYYY</code>", then it would be "<code>February 2nd, 2016</code>".
<li>For checkgroup fields, <code>@@<i><font color=blue>variable</font></i></code> is <code>["<font color=blue><i>option1</i></font>", "<font color=blue><i>option2</i></font>", ...]</code>, such as <code>["accounting","landscaping","cleaning"]</code>, which is an array and therefore cannot be inserted into templates. Instead, use <code>@@<i><font color=blue>variable</font></i>_label</code>, which is a string in the form "<code>["<font color=blue><i>Option 1</i></font>","<font color=blue><i>Option 2</i></font>",...]</code>", such as "<code>["Accounting","Landscaping","Cleaning and janitorial"]</code>".<br>
<font color=green><b>Note:</b></font> <font color=dimgrey>For prettier formatting, create a string variable and a trigger that is executed <i>beforehand</i> that stores the selected options in separate lines in the string variable. The <a href="http://php.net/manual/en/function.json-decode.php">json_decode()</a> function can be used to convert <code>@@<i><font color=blue>variable</font></i>_label</code> into an array. For example, the following trigger can be used for a checkgroup whose variable is named "selectServices":
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>selectServicesFormatted <span style="color: #339933;">=</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$aOptions</span> <span style="color: #339933;">=</span> <a href="http://php.net/json_decode"><span style="color: #990000;">json_decode</span></a><span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>selectServices_label<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$aOptions</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$option</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #339933;">@@</span>selectServicesFormatted <span style="color: #339933;">.=</span> <span style="color: #000088;">$option</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;&lt;br&gt;<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
Then, insert <code>@#selectServicesFormatted</code> into the template.</font>  
<li>For file fields, <code>@@<i><font color=blue>variable</font></i>_label</code> has the fil ename of the selected file in a JSON array, such as "<code>["employeePhoto.jpg"]</code>" or "<code>[]</code>" if no file was selected. <code>@@<i><font color=blue>variable</font></i></code> is "<code>["<font color=blue><i>file-uid</i></font>"]</code>", such as "<code>["<font color=blue><i>file-uid</i></font>"]</code>", "<code>["263247890574cd24044f980079517567"]</code>" or "<code>[]</code>" if there is no selected file.<br>
<font color=green><b>Note:</b></font> <font color=dimgrey>To select the file name without the enclosing brackets, create a string variable and a trigger that is executed <i>beforehand</i> that stores the filename in the string variable. The <a href="http://php.net/manual/en/function.json-decode.php">json_decode()</a> function can be used to convert <code>@@<i><font color=blue>variable</font></i>_label</code> into an array. For example, the following trigger can be used for a file field whose variable is named "invoiceFile":
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>invoiceFilename <span style="color: #339933;">=</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$aFilenames</span> <span style="color: #339933;">=</span> <a href="http://php.net/json_decode"><span style="color: #990000;">json_decode</span></a><span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>invoiceFile_label<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aFilenames</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #339933;">@@</span>invoiceFilename <span style="color: #339933;">=</span> <span style="color: #000088;">$aFilenames</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
Then, insert <code>@#invoiceFilename</code> into the template.</font>  
<li>For grids, there is no <code>@@<i><font color=blue>variable</font></i>_label</code> variable. See below.
</ul>
<p><font color=green><strong>Note:</strong></font> <font color=dimgrey>If a case variable doesn't exist, the message will be sent out with the name of the variable in the text. Case variables will not be created if a DynaForm is not submitted, or the process has a <a href="../3.0/Using_Conditions.html" title="Using Conditions">condition</a> that evaluates to <tt>false</tt> so the DynaForm is skipped in the case. To avoid variable names appearing in messages, fire a trigger after the Dynaform to check whether the variable has been set. If not, set the variable to an empty string, so that any subsequent notifications will insert a blank space in place of the variable name:</font></p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span><a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>someVariable<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> &nbsp;<br />
&nbsp; &nbsp;<span style="color: #339933;">@@</span>someVariable <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<h2><span id="Message_Events">Message Events</span></h2>
<p>Message events can be used to send out messages at specified times. For more information, see <a href="../3.0/Events.html" title="Events">Events</a>.</p>

<h2><span id="Trigger_Messages">Trigger Messages</span></h2>
<p>Email notifications can be sent out in triggers using the <a href="../3.2/ProcessMaker_Functions/Email_Functions.html#PMFSendMessage.28.29" title="ProcessMaker Functions"><tt>PMFSendMessage()</tt></a> and <a href="../3.2/ProcessMaker_Functions/Email_Functions.html#PMFSendMessageToGroup.28.29"><tt>PMFSendMessageToGroup()</tt></a> function. Sending out messages in <a href="../3.2/Triggers.html">Triggers</a> provides a great deal of flexibility, since the parameters for the <tt>PMFSendMessage()</tt> function allow the sender, the list of recipients, the subject line, the template file and even customized insertion variables to be specified. In addition, the message can be sent based on the conditions of the particular case, and a <a href="../3.0/Using_Conditions.html" title="Using Conditions">condition</a> can be set for the firing of the trigger, or the <tt>PMFSendMessage()</tt> function can be wrapped inside an <strong><tt>if</tt></strong> clause in the trigger code.</p>

<p>To configure the notification, the following steps are necessary:</p>
<ol><li>Create the <a href="#Create_the_HTML_Email_Template">HTML email template</a></li>
<li>Create a <a href="#Sending_emails_with_PMFSendMessage.28.29">trigger containing the <tt>PMFSendMessage()</tt> or <tt>PMFSendMessageToGroup()</tt> function</a></li>
<li>Assign the <a href="#Assigning_the_trigger_to_step.28s.29">trigger to a step</a> in the process.</li></ol>

<h3><span id="Create_the_HTML_Email_Template">Create the HTML Email Template</span></h3>
<p>Email template files can be created inside ProcessMaker with the WYSIWYG editor in the <a href="../3.0/Templates.html" title="Templates">Templates</a> option in the <a href="../3.0/Processes.html#Main_toolbox">Main Toolbox</a>. 
For greater creativity, create the template file with an external plain text editor or HTML editor and then upload it to ProcessMaker.</p>
<p>Open a process for editing. Click on the <b>Template</b> option in the main toolbox.</p>
<p><img alt="" src="../sites/default/files/PM3_NotificationsToolBox.png"></p>

<p>Then click on either the <strong>Create</strong> or <strong>Upload</strong> links to create or upload the template file.</p>
<p><img alt="" src="../sites/default/files/PM3_NotificationsEmailCreate0.png"></p>

<p>The template file will determine the body of the email message. This text can contain system and case variables and HTML tags. For more information on the format of template files, see <a href="../3.0/Output_Documents.html" title="Output Documents">Output Documents</a>. 

For example, the following template is used when a leave request is approved:
<codeblock>Dear @#reqUserName, <br>
Your leave request has been approved.  Please find details below: <br>
 <b>Date From:</b>      @#fromReq 
 <b>Date To:</b>        @#toReq   
 <b>Days Requested:</b> @#daysReq 
<br>
Once your leave period has ended, please do not forget to fill out a Leave Report upon returning. <br>
Regards, 
 &nbsp; @#reqSupervisor
</codeblock>
<p><img alt="" src="../sites/default/files/PM3_NotificationsEmailCreate.png"></p>

<p>Its HTML code can be edited by clicking on the <img src="../sites/default/files/HtmlButton.png"> button in the editor to see the following HTML code:
<div class="geshifilter"><div class="html4strict geshifilter-html4strict" style="font-family:monospace;"><span style="color: #00bbdd;">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span><br />
<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/html.html"><span style="color: #000000; font-weight: bold;">html</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/head.html"><span style="color: #000000; font-weight: bold;">head</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/head.html"><span style="color: #000000; font-weight: bold;">head</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/body.html"><span style="color: #000000; font-weight: bold;">body</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/p.html"><span style="color: #000000; font-weight: bold;">p</span></a>&gt;</span>Dear @#reqUserName, <span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/br.html"><span style="color: #000000; font-weight: bold;">br</span></a>&gt;</span><br />
Your leave request has been approved. &nbsp;Please find details below: <span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/br.html"><span style="color: #000000; font-weight: bold;">br</span></a>&gt;</span><br />
&nbsp;<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/b.html"><span style="color: #000000; font-weight: bold;">b</span></a>&gt;</span>Date From:<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/b.html"><span style="color: #000000; font-weight: bold;">b</span></a>&gt;</span> &nbsp; &nbsp; &nbsp;@#fromReq <span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/br.html"><span style="color: #000000; font-weight: bold;">br</span></a>&gt;</span><br />
&nbsp;<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/b.html"><span style="color: #000000; font-weight: bold;">b</span></a>&gt;</span>Date To:<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/b.html"><span style="color: #000000; font-weight: bold;">b</span></a>&gt;</span> &nbsp; &nbsp; &nbsp; &nbsp;@#toReq &nbsp; <span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/br.html"><span style="color: #000000; font-weight: bold;">br</span></a>&gt;</span><br />
&nbsp;<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/b.html"><span style="color: #000000; font-weight: bold;">b</span></a>&gt;</span>Days Requested:<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/b.html"><span style="color: #000000; font-weight: bold;">b</span></a>&gt;</span> @#daysReq <span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/br.html"><span style="color: #000000; font-weight: bold;">br</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/br.html"><span style="color: #000000; font-weight: bold;">br</span></a>&gt;</span><br />
Once your leave period has ended, please do not forget to fill out a Leave Report upon returning. <span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/br.html"><span style="color: #000000; font-weight: bold;">br</span></a>&gt;&lt;<a href="http://december.com/html/4/element/br.html"><span style="color: #000000; font-weight: bold;">br</span></a>&gt;</span><br />
Regards, <span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/br.html"><span style="color: #000000; font-weight: bold;">br</span></a>&gt;</span><br />
&nbsp;<span style="color: #ddbb00;">&amp;nbsp;</span> @#reqSupervisor<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/p.html"><span style="color: #000000; font-weight: bold;">p</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/body.html"><span style="color: #000000; font-weight: bold;">body</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/html.html"><span style="color: #000000; font-weight: bold;">html</span></a>&gt;</span></div></div>

<h4><span id="links_in_templates">Links to Cases in Templates</span></h4>
<p>The email template can also contain links to access resources inside ProcessMaker. To learn more about web browser redirection inside ProcessMaker, see <a href="../3.0/JavaScript_in_DynaForms.html#Frames">JavaScript Frames</a>, the <a href="../3.0/Internal_Functions_and_Classes.html#G::header.28.29">G::header()</a> function and the <a href="../3.0/Links.html#Linking_inside_ProcessMaker">Link</a> field. 

<p>An email template can include a link to open a case with a click of the mouse. Links to the current case can be constructed using system variables. For example, to open a link to the current case:</p>
<codeblock><p>Dear @#reqUserName,
<p>Your leave request has not yet been approved. Please find the details below:<br>
 <b>Date From:</b>      @#fromReq 
 <b>Date To:</b>        @#toReq   
 <b>Days Requested:</b> @#daysReq 
<br>
We need you to fill in some details. Please click the link below: <br>
 http://example.com/sys@#SYS_SYS/@#SYS_LANG/@#SYS_SKIN/cases/open?APP_UID=@#APPLICATION&DEL_INDEX=@#INDEX&action=draft </p>
<p>Regards, 
 &nbsp; @#reqSupervisor</p> 
</codeblock>

<p>Its HTML code can be edited by clicking on the <img src="../sites/default/files/HtmlButton.png"> button in the editor to see the following HTML code:
<div class="geshifilter"><div class="html4strict geshifilter-html4strict" style="font-family:monospace;"><span style="color: #00bbdd;">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span><br />
<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/html.html"><span style="color: #000000; font-weight: bold;">html</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/head.html"><span style="color: #000000; font-weight: bold;">head</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/head.html"><span style="color: #000000; font-weight: bold;">head</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/body.html"><span style="color: #000000; font-weight: bold;">body</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/p.html"><span style="color: #000000; font-weight: bold;">p</span></a>&gt;</span>Dear @#reqUserName, <span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/br.html"><span style="color: #000000; font-weight: bold;">br</span></a>&gt;</span><br />
Your leave request has been approved. &nbsp;Please find details below:<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/p.html"><span style="color: #000000; font-weight: bold;">p</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/table.html"><span style="color: #000000; font-weight: bold;">table</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/tr.html"><span style="color: #000000; font-weight: bold;">tr</span></a>&gt;&lt;<a href="http://december.com/html/4/element/td.html"><span style="color: #000000; font-weight: bold;">td</span></a>&gt;&lt;<a href="http://december.com/html/4/element/b.html"><span style="color: #000000; font-weight: bold;">b</span></a>&gt;</span>Date From:<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/b.html"><span style="color: #000000; font-weight: bold;">b</span></a>&gt;</span> &nbsp; &nbsp; <span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/td.html"><span style="color: #000000; font-weight: bold;">td</span></a>&gt;&lt;<a href="http://december.com/html/4/element/td.html"><span style="color: #000000; font-weight: bold;">td</span></a>&gt;</span>@#fromReq<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/td.html"><span style="color: #000000; font-weight: bold;">td</span></a>&gt;&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/tr.html"><span style="color: #000000; font-weight: bold;">tr</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/tr.html"><span style="color: #000000; font-weight: bold;">tr</span></a>&gt;&lt;<a href="http://december.com/html/4/element/td.html"><span style="color: #000000; font-weight: bold;">td</span></a>&gt;&lt;<a href="http://december.com/html/4/element/b.html"><span style="color: #000000; font-weight: bold;">b</span></a>&gt;</span>Date To:<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/b.html"><span style="color: #000000; font-weight: bold;">b</span></a>&gt;</span> &nbsp; &nbsp; &nbsp; <span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/td.html"><span style="color: #000000; font-weight: bold;">td</span></a>&gt;&lt;<a href="http://december.com/html/4/element/td.html"><span style="color: #000000; font-weight: bold;">td</span></a>&gt;</span>@#toReq &nbsp;<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/td.html"><span style="color: #000000; font-weight: bold;">td</span></a>&gt;&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/tr.html"><span style="color: #000000; font-weight: bold;">tr</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/tr.html"><span style="color: #000000; font-weight: bold;">tr</span></a>&gt;&lt;<a href="http://december.com/html/4/element/td.html"><span style="color: #000000; font-weight: bold;">td</span></a>&gt;&lt;<a href="http://december.com/html/4/element/b.html"><span style="color: #000000; font-weight: bold;">b</span></a>&gt;</span>Days Requested:<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/b.html"><span style="color: #000000; font-weight: bold;">b</span></a>&gt;&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/td.html"><span style="color: #000000; font-weight: bold;">td</span></a>&gt;&lt;<a href="http://december.com/html/4/element/td.html"><span style="color: #000000; font-weight: bold;">td</span></a>&gt;</span>@#daysReq<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/td.html"><span style="color: #000000; font-weight: bold;">td</span></a>&gt;&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/tr.html"><span style="color: #000000; font-weight: bold;">tr</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/table.html"><span style="color: #000000; font-weight: bold;">table</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/p.html"><span style="color: #000000; font-weight: bold;">p</span></a>&gt;</span>We need you to fill in some details. Please click the link below:<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/br.html"><span style="color: #000000; font-weight: bold;">br</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/a.html"><span style="color: #000000; font-weight: bold;">a</span></a> <span style="color: #000066;">href</span><span style="color: #66cc66;">=</span><span style="color: #ff0000;">&quot;http://example.com/sys@#SYS_SYS/@#SYS_LANG/@#SYS_SKIN/cases/open?APP_UID=@#APPLICATION&amp;DEL_INDEX=@#INDEX&amp;action=draft&quot;</span>&gt;</span>http://example.com/sys@#SYS_SYS/@#SYS_LANG/@#SYS_SKIN/cases/open?APP_UID=@#APPLICATION<span style="color: #ddbb00;">&amp;amp;</span>DEL_INDEX=@#INDEX<span style="color: #ddbb00;">&amp;amp;</span>action=draft<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/a.html"><span style="color: #000000; font-weight: bold;">a</span></a>&gt;&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/p.html"><span style="color: #000000; font-weight: bold;">p</span></a>&gt;</span><br />
<br />
<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/p.html"><span style="color: #000000; font-weight: bold;">p</span></a>&gt;</span>Regards, <span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/br.html"><span style="color: #000000; font-weight: bold;">br</span></a>&gt;</span><br />
&nbsp;<span style="color: #ddbb00;">&amp;nbsp;</span> @#reqSupervisor<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/p.html"><span style="color: #000000; font-weight: bold;">p</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/body.html"><span style="color: #000000; font-weight: bold;">body</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/html.html"><span style="color: #000000; font-weight: bold;">html</span></a>&gt;</span></div></div>

<p>Remember that the person receiving the email needs to either be assigned to work on the current task in the case or have <a href="../3.0/Process_Permissions.html">process permissions</a> to open the case. If opening a case as a Process Supervisor, a different URL can be used:<br>
<code>http://example.com/sys@#SYS_SYS/@#SYS_LANG/@#SYS_SKIN/cases/open?APP_UID=@#APPLICATION&DEL_INDEX=@#INDEX&to_revise=true&action=to_revise</code></p>

<p>If the case is completed, paused or canceled, or the user doesn't have rights to open the case, then the summary for the case will be displayed. The summary can also be displayed by setting <code>action=sent</code>; it is not necessary to include the delegation index number in the URL:<br>
<code>http://example.com/sys@#SYS_SYS/@#SYS_LANG/@#SYS_SKIN/cases/open?APP_UID=@#APPLICATION&action=sent</code></p>
<p>If the user doesn't currently have an active login session in ProcessMaker, the web browser will first redirect to the login page and then redirect to the specified case after logging in. If the case is opened in a task that has already been completed, then the web browser will redirect to the list of cases in the inbox.</p>

<h5><span id="redirecting_to_main_page">Redirecting to the <code>../cases/main</code> Page</span></h5>
<p>Unfortunately, the page <code>"cases/open?..."</code> is designed to open a case inside an <code>&ltiframe&gt;</code></a> below the main menu bar, so redirecting the web browser to this address will open a window that doesn't have the main menu bar and the <b>Home</b> sidebar. To be able to get back to the principal page after completing the task, it is recommended to add the following trigger to the process that redirects the web browser back to the <code>"../cases/main"</code> page:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #b1b100;">echo</span> <span style="color: #0000ff;">&quot;&lt;script&gt;top.location.href = '../cases/main';&lt;/script&gt;&quot;</span><span style="color: #339933;">;</span></div></div>
<p>Set the above trigger to execute <i>after routing</i> in the task specified by the <code>"cases/open?..."</code> page. When the user completes working on the task and clicks on the Continue button at the end of the task, the web browser will automatically be redirected to the <code>"../cases/main"</code> page, which displays the top-level menu, the Home sidebar and the list of cases in the inbox.</p>

<p>If the user needs to be able to immediately return to the <code>"../cases/main"</code> page, a button that redirects to that page can be added to the Dynaform.</p> 
<p>For example, if a button is added with the ID "goToInbox", then the following JavaScript code can be added to the Dynaform to save the contents of the Dynaform and redirect the web browser:
<div class="geshifilter"><div class="javascript geshifilter-javascript" style="font-family:monospace;">$<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;#goToInbox&quot;</span><span style="color: #009900;">&#41;</span>.<span style="color: #660066;">click</span><span style="color: #009900;">&#40;</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;$<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;form&quot;</span><span style="color: #009900;">&#41;</span>.<span style="color: #660066;">saveForm</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;top.<span style="color: #660066;">location</span>.<span style="color: #660066;">href</span> <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;../cases/main&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<!-- HERE -->
<h4><span id="grids_in_templates">Grids in Templates</span></h4>
<p>The email template can also contain grid data. For example, the grid can be placed inside an HTML table:</p>

<codeblock>Dear @#reqUserName, 
Your leave request has been approved.  Please find details below: <br>
<table style="width: auto;">
<tr><th>Date From</th><th>Date To</th><th>Number Days</th><th>Comment</th></tr>
<!-- @>reqLeaveGrid -->
<tr><td>@#detDateFrom</td><td>@#detDateTo</td><td>@#detNoDays</td><td>@#detComment</td></tr>
<!-- @<reqLeaveGrid -->
</table>
Once your leave period has ended, please do not forget to fill out a Leave Report upon returning. <br>
Regards,
 &nbsp;  @#reqSupervisor
</codeblock>

<p>Its HTML code would be: 
<div class="geshifilter"><div class="html4strict geshifilter-html4strict" style="font-family:monospace;"><span style="color: #00bbdd;">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span><br />
<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/html.html"><span style="color: #000000; font-weight: bold;">html</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/head.html"><span style="color: #000000; font-weight: bold;">head</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/head.html"><span style="color: #000000; font-weight: bold;">head</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/body.html"><span style="color: #000000; font-weight: bold;">body</span></a>&gt;</span><br />
Dear @#reqUserName, <span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/br.html"><span style="color: #000000; font-weight: bold;">br</span></a>&gt;</span><br />
Your leave request has been approved. &nbsp;Please find details below: <span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/br.html"><span style="color: #000000; font-weight: bold;">br</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/table.html"><span style="color: #000000; font-weight: bold;">table</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/tr.html"><span style="color: #000000; font-weight: bold;">tr</span></a>&gt;&lt;<a href="http://december.com/html/4/element/th.html"><span style="color: #000000; font-weight: bold;">th</span></a>&gt;</span>Date From<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/th.html"><span style="color: #000000; font-weight: bold;">th</span></a>&gt;&lt;<a href="http://december.com/html/4/element/th.html"><span style="color: #000000; font-weight: bold;">th</span></a>&gt;</span>Date To<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/th.html"><span style="color: #000000; font-weight: bold;">th</span></a>&gt;&lt;<a href="http://december.com/html/4/element/th.html"><span style="color: #000000; font-weight: bold;">th</span></a>&gt;</span>Number Days<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/th.html"><span style="color: #000000; font-weight: bold;">th</span></a>&gt;&lt;<a href="http://december.com/html/4/element/th.html"><span style="color: #000000; font-weight: bold;">th</span></a>&gt;</span>Comment<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/th.html"><span style="color: #000000; font-weight: bold;">th</span></a>&gt;&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/tr.html"><span style="color: #000000; font-weight: bold;">tr</span></a>&gt;</span><br />
<span style="color: #808080; font-style: italic;">&lt;!-- @&gt;reqLeaveGrid --&gt;</span><br />
<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/tr.html"><span style="color: #000000; font-weight: bold;">tr</span></a>&gt;&lt;<a href="http://december.com/html/4/element/td.html"><span style="color: #000000; font-weight: bold;">td</span></a>&gt;</span>@#detDateFrom<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/td.html"><span style="color: #000000; font-weight: bold;">td</span></a>&gt;&lt;<a href="http://december.com/html/4/element/td.html"><span style="color: #000000; font-weight: bold;">td</span></a>&gt;</span>@#detDateTo<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/td.html"><span style="color: #000000; font-weight: bold;">td</span></a>&gt;&lt;<a href="http://december.com/html/4/element/td.html"><span style="color: #000000; font-weight: bold;">td</span></a>&gt;</span>@#detNoDays<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/td.html"><span style="color: #000000; font-weight: bold;">td</span></a>&gt;&lt;<a href="http://december.com/html/4/element/td.html"><span style="color: #000000; font-weight: bold;">td</span></a>&gt;</span>@#detComment<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/td.html"><span style="color: #000000; font-weight: bold;">td</span></a>&gt;&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/tr.html"><span style="color: #000000; font-weight: bold;">tr</span></a>&gt;</span><br />
<span style="color: #808080; font-style: italic;">&lt;!-- @&lt;reqLeaveGrid --&gt;</span><br />
<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/table.html"><span style="color: #000000; font-weight: bold;">table</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/p.html"><span style="color: #000000; font-weight: bold;">p</span></a>&gt;</span>Once your leave period has ended, please do not forget to fill out a Leave Report upon returning. <span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/br.html"><span style="color: #000000; font-weight: bold;">br</span></a>&gt;&lt;<a href="http://december.com/html/4/element/br.html"><span style="color: #000000; font-weight: bold;">br</span></a>&gt;</span><br />
Regards, <span style="color: #009900;">&lt;<a href="http://december.com/html/4/element/br.html"><span style="color: #000000; font-weight: bold;">br</span></a>&gt;</span><br />
&nbsp;<span style="color: #ddbb00;">&amp;nbsp;</span> &nbsp;@#reqSupervisor<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/p.html"><span style="color: #000000; font-weight: bold;">p</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/body.html"><span style="color: #000000; font-weight: bold;">body</span></a>&gt;</span><br />
<span style="color: #009900;">&lt;<span style="color: #66cc66;">/</span><a href="http://december.com/html/4/element/html.html"><span style="color: #000000; font-weight: bold;">html</span></a>&gt;</span></div></div>

<p>For each row in the grid between <code>@&gt;reqLeaveGrid</code> and <code>@&lt;reqLeaveGrid</code>, the grid fields <code>@#detDateFrom</code>, <code>@#detDateTo</code>, <code>@#detNoDays</code>, and <code>@#detComment</code> will be repeated on a new line. For more information on inserting grids into templates, see <a href="../3.0/Output_Documents.html#Grids_in_Output_documents">Grids in Output Documents</a>.</p>
<p>Moreover, it is possible to introduce images inside the template by editing the HTML code. For example:</p>

<p><code>&lt;img src="http://example.com/companyLogo.jpg"&gt;</code></p>

<p>Images inserted in email templates should be hosted in a server with public access, otherwise they might not be viewable by the person receiving the email. For example, the corporate logo placed in the location <b><tt><a href="../3.0/File_Locations.html#Installation_Directory"><i>INSTALL-DIRECTORY</i></a>/workflow/public_html/companyLogo.jpg</tt></b> on the ProcessMaker server is publicly accessible at the address: <tt>http://example.com/companyLogo.jpg</tt></p>

<h3><span id="Sending_emails_with_PMFSendMessage.28.29">Sending Emails with PMFSendMessage() or PMFSendMessageToGroup()</span></h3>
<p>The <a href="../3.2/ProcessMaker_Functions/Email_Functions.html#PMFSendMessage.28.29"><tt>PMFSendMessage()</tt></a> or <a href="../3.2/ProcessMaker_Functions/Email_Functions.html#PMFSendMessageToGroup.28.29"><tt>PMFSendMessageToGroup()</tt></a> functions are used to send out customized email notifications based on a template file. To use this function, create a <a href="../3.2/Triggers.html" title="Triggers">Trigger</a> and add this function to the code for that trigger. For more information and code examples, see the documentation for the <a href="../3.2/ProcessMaker_Functions/Email_Functions.html#PMFSendMessage.28.29"><tt>PMFSendMessage()</tt></a> or <a href="../3.2/ProcessMaker_Functions/Email_Functions.html#PMFSendMessageToGroup.28.29"><tt>PMFSendMessageToGroup()</tt></a> function. Also see the <a href="#Trigger_Message_Examples">code examples</a> below.</p>

<p>To find which users are assigned to cases, tasks, groups, departments, roles, etc., it is often necessary to use lookup information in the database using the <a href="../3.2/ProcessMaker_Functions/Database_Functions.html#executeQuery.28.29" title="ProcessMaker Functions">executeQuery()</a> function. Then, the email address of those users can be found with the <a href="../3.2/ProcessMaker_Functions/User_Functions.html#userInfo.28.29" title="ProcessMaker Functions">userInfo()</a> function. Emails can be sent to multiple recipients with the <a href="../3.2/ProcessMaker_Functions/Email_Functions.html#PMFSendMessage.28.29" title="ProcessMaker Functions"><tt>PMFSendMessage()</tt></a> function by separating the email addresses with commas (,) in the <strong><tt>$to</tt></strong>, <strong><tt>$cc</tt></strong> or <strong><tt>$bcc</tt></strong> parameters. Emails can also be sent to a users group with the <a href="../3.2/ProcessMaker_Functions/Email_Functions.html#PMFSendMessageToGroup.28.29"><tt>PMFSendMessageToGroup()</tt></a> function.</p>

<h3><span id="Assigning_the_trigger_to_step.28s.29">Assigning the Trigger to Step(s)</span></h3>
<p>Once you have uploaded your template email file and defined a <a href="../3.1/Triggers.html">trigger</a> to send the email, it is possible to assign the related <a href="../3.1/Triggers.html" title="Triggers">trigger</a> to steps in different instances:</p>
<ul><li>Before/after a step (DynaForm, Input Document or Output Document) is displayed.</li>
    <li>Before the case assigns a user to the next task in the case.</li>
    <li>Before/after a case is routed to the next task in the case.</li></ul>
<p>In each instance, it is also possible to define conditions that dictate whether a <a href="../3.1/Triggers.html" title="Triggers">trigger</a> should be executed or not. If the condition evaluates to <tt>false</tt>, the trigger will <strong>not</strong> be fired. If it evaluates to <tt>true</tt>, the trigger will be fired.</p>
<p>For example, the following condition defines that the <a href="../3.1/Triggers.html" title="Triggers">trigger</a> will be executed only if the <code>@@repFinalDec</code> case variable is 0. In other words, the notification will be sent only when this condition is <tt>true</tt>.</p>
<p><img alt="" src="../sites/default/files/3.2Conditional4.png"></p>

<h2><span id="Trigger_Message_Examples">Trigger Message Examples</span></h2>

<h3><span id="Emailing_the_Current_Assigned_User_for_a_Case">Emailing the Current Assigned User of a Case</span></h3>
<p>A message can be sent to the user currently assigned to work on the case by using the <tt>@@USER_LOGGED</tt> system variable to get that user's unique ID. Then, pass that unique ID to the <a href="../3.1/ProcessMaker_Functions.html#userInfo.28.29" title="ProcessMaker Functions">userInfo()</a> function to look up his/her email address. For example:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$aUser</span> <span style="color: #339933;">=</span> userInfo<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$to</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'boss@example.com'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$to</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'Some Message Title'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'someTemplate.html'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<h3><span id="Emailing_the_Supervisor_of_a_Case.27s_Assigned_User">Emailing the Supervisor of a Case's Assigned User</span></h3>
<p>To send a message to the supervisor of the current assigned user for a case, first use the <a href="../3.0/Internal_Functions_and_Classes.html#Cases::loadCase.28.29" title="Internal Functions and Classes">InternaCases::loadCase()</a> to look up who is currently assigned to work on the case and then use the <a href="../3.0/Internal_Functions_and_Classes.html#Users::Load.28.29" title="Internal Functions and Classes">Users::Load()</a> method to get that user's supervisor. Finally, use <a href="../3.1/ProcessMaker_Functions.html#userInfo.28.29" title="ProcessMaker Functions">userInfo()</a> to get the supervisor's email.</p>
<p>For example, to email the supervisor of the user assigned to the current case when the case is overdue:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">G<span style="color: #339933;">::</span><span style="color: #004000;">LoadClass</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;users&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$c</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> Cases<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$aCase</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$c</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">loadCase</span><span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #339933;">@%</span>INDEX<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$u</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> Users<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$aUser</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$u</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">Load</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aCase</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'CURRENT_USER_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_REPORTS_TO'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$aSupervisor</span> <span style="color: #339933;">=</span> userInfo<span style="color: #009900;">&#40;</span><span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_REPORTS_TO'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'admin@example.com'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$aSupervisor</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_EMAIL'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'Case is Overdue'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'overdueTemplate.html'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
<span style="color: #b1b100;">else</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #339933;">@@</span>ERROR <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;There is no supervisor for user <span style="color: #006699; font-weight: bold;">{$aCase['CURRENT_USER']}</span>.&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$g</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> G<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">SendMessageText</span><span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>ERROR<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;ERROR&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<h3><span id="Emailing_the_Previous_User_for_a_Case">Emailing the Previous User of a Case</span></h3>
<p>To send a message to a user who worked on a previous task in the case, create a trigger that fires during that previous task which saves the user's unique ID to a case variable.</p>
<p>For example, in a process to approve purchase requests, an email message needs to be sent to the purchase requester, informing him/her whether the purchase was approved or disapproved. In the first task when the requester fills out the purchase request form, fire the following trigger:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>requesterId <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #339933;">;</span></div></div>
<p>In the subsequent task, when the manager decides to approve or disapprove the purchase request, fire the following trigger to send an email to the requester:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #666666; font-style: italic;">//check if the case variable has been set and is not empty</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>requesterId<span style="color: #009900;">&#41;</span> and <span style="color: #339933;">!</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>requesterId<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$aUserTo</span> <span style="color: #339933;">=</span> userInfo<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>requesterId<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$aUserFrom</span> <span style="color: #339933;">=</span> userInfo<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #000088;">$aUserFrom</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="color: #000088;">$aUserTo</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail], '</span><span style="color: #0000ff;">', '</span><span style="color: #0000ff;">', '</span>Purchase Request Decision<span style="color: #0000ff;">', <br />
&nbsp; &nbsp; &nbsp; '</span>purchaseDecision<span style="color: #339933;">.</span>html<span style="color: #0000ff;">');<br />
}</span></div></div>

<h3><span id="Emailing_the_Previous_User_with_a_Database_Query">Emailing the Previous User with a Database Query</span></h3>
<p>Another way to find the user who worked on a previous task in a case is to look up the record for that task in the <strong><tt>wf_&lt;WORKSPACE&gt;.APP_DELEGATION</tt></strong> table. There is a record for each task in a case with the <i>last</i> user to work on that task. First, look up the unique ID for the task with the taskList() web service at <strong>ADMIN &gt; Settings &gt; Web Services Test</strong> (or look it up in the <strong><tt>wf_&lt;WORKSPACE&gt;.TASK.TAS_UID</tt></strong> field in the database). Then, use <a href="../3.1/ProcessMaker_Functions.html#executeQuery.28.29" title="ProcessMaker Functions">executeQuery()</a> in a trigger to look up the user who worked on a particular task for the case in the <strong><tt>wf_&lt;WORKSPACE&gt;.APP_DELEGATION.USR_UID</tt></strong> field.</p>
<p>For example, to send a message to a user who worked on a task with the ID "7710617204e67abaabfb1c9082177702" in the current case:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$taskId</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;7710617204e67abaabfb1c9082177702&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$caseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span><br />
<span style="color: #000088;">$query</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;SELECT USR_UID FROM APP_DELEGATION WHERE APP_UID='<span style="color: #006699; font-weight: bold;">$caseId</span>' AND TAS_UID='<span style="color: #006699; font-weight: bold;">$taskId</span>'&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$tasks</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$query</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$tasks</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$tasks</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//get the last record, in case the task was repeated in the case</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$userId</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$tasks</span><span style="color: #009900;">&#91;</span><a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$tasks</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$aUser</span> <span style="color: #339933;">=</span> userInfo<span style="color: #009900;">&#40;</span><span style="color: #000088;">$userId</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'boss@example.com'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'Some Message Title'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'someTemplate.html'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<h3><span id="Emailing_the_Next_Assigned_User">Emailing the Next Assigned User</span></h3>
<p>An email can be sent out to the user assigned to work on the <i>next</i> task in two ways:</p>
<!-- <ol style="line-height: 19.0499992370605px; margin-top: 0.3em; margin-bottom: 0px; margin-left: 3.2em; list-style-image: none; font-family: sans-serif; font-size: 12.6999998092651px;>"-->
<ol><li><a href="#For_Next_Tasks_with_Cyclical_Assignment">Using the <tt>PMFGetNextAssignedUser()</tt> function</a> for tasks with Cyclical Assignment.</li><li><a href="#For_Next_Tasks_with_Any_Type_of_Assignment_Rule">Looking up the next user in the <strong><tt>APP_DELEGATION</tt></strong> table</a> after routing from the previous task.</li></ol>
<p>The second way is more reliable and works with any type of assignment rule.</p>
<h4><span id="For_Next_Tasks_with_Cyclical_Assignment">For Next Tasks with Cyclical Assignment</span></h4>
<p>If the next task uses <a href="../3.0/Tasks.html#Cyclical_Assignment" title="Processes">cyclical assignment</a>, the next assigned user in a case can be looked up using the <a href="../3.1/ProcessMaker_Functions.html#PMFGetNextAssignedUser.28.29" title="ProcessMaker Functions">PMFGetNextAssignedUser()</a> function. The parameters of this function require the unique IDs for the case and the task, which can be looked up with <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#taskList.28.29" title="ProcessMaker WSDL Web Services">taskList()</a> at <strong>ADMIN &gt; Settings &gt; Web Services Test</strong> or by querying the <strong><tt>wf_&lt;WORKFLOW&gt;.TASK.TAS_UID</tt></strong> field in the database.</p>
<p>For example, the following trigger sends an email message to the next user who will be assigned to work on the current case.</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$taskId</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'XXXXXXXXXXXXXXXXXXXXXXXX'</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//set to the unique ID for next task</span><br />
<span style="color: #000088;">$aUser</span> <span style="color: #339933;">=</span> PMFGetNextAssignedUser<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #000088;">$taskId</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aUser</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aUser</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp;PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;Mr. Boss &lt;boss@example.com&gt;&quot;</span><span style="color: #339933;">,</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_EMAIL'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <br />
&nbsp; &nbsp;<span style="color: #0000ff;">'You are assigned to next task'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'template.html'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
<span style="color: #b1b100;">else</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$g</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> G<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">SendMessageText</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Unable to lookup next assigned user!&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;ERROR&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<p>Remember that the <a href="../3.1/ProcessMaker_Functions.html#PMFGetNextAssignedUser.28.29"><tt>PMFGetNextAssignedUser()</tt></a> function only works if the next task uses cyclical assignment. If the next task uses any other type of <a href="../3.0/Tasks.html#Assignment_Rules" title="Processes">assignment rule</a>, it is necessary to use the following method.</p>
<!--<h4 style="margin-top: 0px; margin-bottom: 0.3em; overflow: hidden; padding-top: 0.5em; padding-bottom: 0.17em; border-bottom-style: none; width: auto; font-size: 14.7319993972778px; font-family: sans-serif; line-height: 19.0499992370605px; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">-->
<h4><span id="For_Next_Tasks_with_Any_Type_of_Assignment_Rule">For Next Tasks with Any Type of Assignment Rule</span></h4>

<p>The assigned user in the next task can be looked up in the <strong><tt>wf_&lt;WORKSPACE&gt;.APP_DELEGATION.USR_UID</tt></strong> field in the database with a trigger that fires <i>after routing</i> from the previous task. At that point, the next task has already been created in the database, although the case is still in the previous task. This method works for tasks with <i>any</i> type of <a href="../3.0/Tasks.html#Assignment_Rules" title="Processes">assignment rule</a>.</p>
<p>For example, the following trigger sends an email message to the next user who will be assigned to work on the current case.</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #666666; font-style: italic;">//ID of next task which can be found in the @@TASK variable in the next task in the debugger:</span><br />
<span style="color: #000088;">$nextTaskId</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'67156450657e5b7bc47c393009386672'</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$caseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span> <br />
<span style="color: #666666; font-style: italic;">//lookup the user assigned to the next task in the case</span><br />
<span style="color: #000088;">$query</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;SELECT USR_UID FROM APP_DELEGATION WHERE APP_UID='<span style="color: #006699; font-weight: bold;">$caseId</span>' AND<br />
&nbsp; &nbsp; DEL_INDEX=( SELECT MAX(DEL_INDEX) FROM APP_DELEGATION WHERE APP_UID='<span style="color: #006699; font-weight: bold;">$caseId</span>' <br />
&nbsp; &nbsp; AND TASK_UID='<span style="color: #006699; font-weight: bold;">$nextTaskId</span>' )&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$query</span><span style="color: #009900;">&#41;</span> or<br />
&nbsp; &nbsp;<a href="http://php.net/die"><span style="color: #990000;">die</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Error in query: <span style="color: #006699; font-weight: bold;">$query</span>&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$aUser</span> <span style="color: #339933;">=</span> userInfo<span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$to</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'firstname'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">.</span><span style="color: #0000ff;">' '</span><span style="color: #339933;">.</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'lastname'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">.</span><span style="color: #0000ff;">' &lt;'</span><span style="color: #339933;">.</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">.</span><span style="color: #0000ff;">'&gt;'</span><span style="color: #339933;">;</span><br />
PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;Mr. Boss &lt;boss@example.com&gt;&quot;</span><span style="color: #339933;">,</span> <span style="color: #000088;">$to</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <br />
&nbsp; &nbsp;<span style="color: #0000ff;">'You are assigned to next task'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'template.html'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
<h3><span id="Emailing_the_Next_Assigned_Users_of_Parallel_Tasks">Emailing the Next Assigned Users of Parallel Tasks</span></h3>
<p>The previous code example will have problems if the next tasks are parallel tasks, because their index numbers might not be the maximum index number. In that case, search for particular task IDs in the <strong><tt>wf_&lt;WORKSPACE&gt;.APP_DELEGATION.TAS_UID</tt></strong> field in the database. Task IDs can be found with <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#taskList.28.29" title="ProcessMaker WSDL Web Services">taskList()</a> at <strong>ADMIN &gt; Settings &gt; Web Services Test</strong> or by querying the <strong><tt>wf_&lt;WORKFLOW&gt;.TASK.TAS_UID</tt></strong> field in the database.</p>
<p>For example, the following trigger code set to fire <i>after routing</i> in the previous task will look up the next tasks in the process, which are three parallel tasks with the unique IDs "8494848774f28459638eb76005941643", "3466222164f2951faaf2915011308833" and "2935650394f297698b78467062625755":</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$caseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span><br />
<span style="color: #666666; font-style: italic;">//lookup the user assigned to the next task in the case</span><br />
<span style="color: #000088;">$query</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;SELECT USR_UID FROM APP_DELEGATION WHERE APP_UID='<span style="color: #006699; font-weight: bold;">$caseId</span>' AND DEL_THREAD_STATUS='OPEN' AND<br />
&nbsp; &nbsp;(TAS_UID='8494848774f28459638eb76005941643' OR '3466222164f2951faaf2915011308833' <br />
&nbsp; &nbsp;OR '2935650394f297698b78467062625755')&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$aUsers</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$query</span><span style="color: #009900;">&#41;</span> or <a href="http://php.net/die"><span style="color: #990000;">die</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Error executing query: <span style="color: #000099; font-weight: bold;">\n</span><span style="color: #006699; font-weight: bold;">$query</span>&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aUsers</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aUsers</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$to</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$aUsers</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$aInfo</span> <span style="color: #339933;">=</span> userInfo<span style="color: #009900;">&#40;</span><span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$to</span> <span style="color: #339933;">.=</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$to</span> <span style="color: #339933;">==</span> <span style="color: #0000ff;">''</span> ? <span style="color: #0000ff;">''</span> <span style="color: #339933;">:</span> <span style="color: #0000ff;">', '</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$aInfo</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;Mr. Boss &lt;boss@example.com&gt;&quot;</span><span style="color: #339933;">,</span> <span style="color: #000088;">$to</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <br />
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'You are assigned to the next tasks'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'template.html'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<!--<h3 style="margin-bottom: 0.6em; overflow: hidden; padding-top: 0.5em; padding-bottom: 0.17em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(170, 170, 170); width: auto; background: none;">-->
<h3><span id="Emailing_all_Assigned_Users_for_a_Task">Emailing all Assigned Users of a Task</span></h3>
<p>Sending out an email to all users in the assignment pool of a specified task can be useful, especially for <a href="../3.0/Tasks.html#Self-Service" title="Processes">self-service</a> tasks, where a user is not automatically assigned to a task.</p>
<p>To send an email to all assigned users of a specified task, first look up the unique ID for the task by either using the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#taskList.28.29" title="ProcessMaker WSDL Web Services">taskList()</a> web service <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#Testing_ProcessMaker.27s_WSDL_Web_Services" title="ProcessMaker WSDL Web Services">test</a> or by querying the database:</p>
<div class="geshifilter"><div class="sql geshifilter-sql" style="font-family:monospace;"><span style="color: #993333; font-weight: bold;">SELECT</span> TAS_UID <span style="color: #993333; font-weight: bold;">FROM</span> TASK</div></div>

<p>Using the unique ID of the task, look up all the users that are assigned to that task in the <strong><tt>wf_&lt;WORKSPACE&gt;.TASK_USER</tt></strong> table. If a group is assigned to the task, then also look up all the members of that group in the <strong><tt>wf_&lt;WORKSPACE&gt;.GROUP_USER</tt></strong> table.</p>

<p>In this example, an email is sent to all users that are assigned to the "Review Proposal" task, which has a unique ID of "2180652364e08ac6275dbb7037406882":</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$taskId</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;2180652364e08ac6275dbb7037406882&quot;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//change to unique ID for the task</span><br />
<span style="color: #000088;">$assignedUsers</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//empty array to hold the UIDs of the assigned users to the task</span><br />
<span style="color: #000088;">$userQuery</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;SELECT USR_UID FROM TASK_USER WHERE TAS_UID = '<span style="color: #006699; font-weight: bold;">$taskId</span>' AND TU_RELATION = 1&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$groupQuery</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;SELECT GU.USR_UID FROM GROUP_USER GU, TASK_USER TU WHERE<br />
&nbsp; &nbsp;TU.TAS_UID = '<span style="color: #006699; font-weight: bold;">$taskId</span>' AND TU.TU_RELATION = 2 AND TU.USR_UID = GU.GRP_UID&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$users</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$userQuery</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$user</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$assignedUsers</span><span style="color: #009900;">&#91;</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$user</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
<span style="color: #000088;">$users</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$groupQuery</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$user</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$assignedUsers</span><span style="color: #009900;">&#91;</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$user</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
&nbsp;<br />
<span style="color: #000088;">$assignedUsers</span> <span style="color: #339933;">=</span> <a href="http://php.net/array_unique"><span style="color: #990000;">array_unique</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$assignedUsers</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//eliminate any duplicates in array</span><br />
<span style="color: #000088;">$emailTo</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;&quot;</span><span style="color: #339933;">;</span> &nbsp; <br />
<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$assignedUsers</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$assignedUser</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$aUser</span> <span style="color: #339933;">=</span> userInfo<span style="color: #009900;">&#40;</span><span style="color: #000088;">$assignedUser</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$emailTo</span> <span style="color: #339933;">.=</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$emailTo</span><span style="color: #009900;">&#41;</span> ? <span style="color: #0000ff;">&quot;&quot;</span> <span style="color: #339933;">:</span> <span style="color: #0000ff;">&quot;,&quot;</span> <span style="color: #009900;">&#41;</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$emailTo</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'boss@example.com'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$emailTo</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <br />
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">&quot;New self-service case to be claimed&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'unassignedCase.html'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<h3><span id="Emailing_All_Assigned_Users_to_the_Next_Task.28s.29">Emailing All Assigned Users of the Next Task(s)</span></h3>
<p>Like the previous example, an email can be sent out to all the users in the assignment pool for the <i>next</i> task(s) in the process. Unlike the previous example, the unique ID of the task(s) does not need to be known, since it is automatically looked up in the <strong><tt>ROUTE</tt></strong> table based on the current task stored in the <tt>@@TASK</tt> system variable.</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$taskId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>TASK<span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//current task</span><br />
<span style="color: #666666; font-style: italic;">//lookup next task(s), if the current task isn't a final task</span><br />
<span style="color: #000088;">$tasks</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT ROU_NEXT_TASK FROM ROUTE WHERE TAS_UID='<span style="color: #006699; font-weight: bold;">$taskId</span>' AND ROU_NEXT_TASK&lt;&gt;'-1'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$taskList</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//build list of next task(s)</span><br />
<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$tasks</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$task</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$taskList</span> <span style="color: #339933;">.=</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$taskList</span><span style="color: #009900;">&#41;</span> ? <span style="color: #0000ff;">''</span> <span style="color: #339933;">:</span> <span style="color: #0000ff;">', '</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;'&quot;</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$task</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'ROU_NEXT_TASK'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;'&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
&nbsp;<br />
<span style="color: #000088;">$assignedUsers</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//empty array to hold the UIDs of the assigned users to the task</span><br />
<span style="color: #000088;">$userQuery</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;SELECT USR_UID FROM TASK_USER WHERE TAS_UID IN (<span style="color: #006699; font-weight: bold;">$taskList</span>) AND TU_RELATION = 1&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$groupQuery</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;SELECT GU.USR_UID FROM GROUP_USER GU, TASK_USER TU WHERE<br />
&nbsp; &nbsp;TU.TAS_UID IN (<span style="color: #006699; font-weight: bold;">$taskList</span>) AND TU.TU_RELATION = 2 AND TU.USR_UID = GU.GRP_UID&quot;</span><span style="color: #339933;">;</span><br />
&nbsp;<br />
<span style="color: #000088;">$users</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$userQuery</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$user</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$assignedUsers</span><span style="color: #009900;">&#91;</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$user</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
&nbsp;<br />
<span style="color: #000088;">$users</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$groupQuery</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$user</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$assignedUsers</span><span style="color: #009900;">&#91;</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$user</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
&nbsp;<br />
<span style="color: #000088;">$assignedUsers</span> <span style="color: #339933;">=</span> <a href="http://php.net/array_unique"><span style="color: #990000;">array_unique</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$assignedUsers</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//eliminate any duplicates in array</span><br />
<span style="color: #000088;">$emailTo</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;&quot;</span><span style="color: #339933;">;</span> &nbsp; <br />
<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$assignedUsers</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$assignedUser</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$aUser</span> <span style="color: #339933;">=</span> userInfo<span style="color: #009900;">&#40;</span><span style="color: #000088;">$assignedUser</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$emailTo</span> <span style="color: #339933;">.=</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$emailTo</span><span style="color: #009900;">&#41;</span> ? <span style="color: #0000ff;">&quot;&quot;</span> <span style="color: #339933;">:</span> <span style="color: #0000ff;">&quot;,&quot;</span> <span style="color: #009900;">&#41;</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$emailTo</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'boss@example.com'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$emailTo</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <br />
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">&quot;New self-service case to be claimed&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'unassignedCase.html'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<h3><span id="Emailing_all_Participants_in_a_Case">Emailing all Participants in a Case</span></h3>
<p>An email can be sent out to all the users who have participated in a specified case to keep them apprised of the progress of that case.</p>
<p>To send an email to all users who have participated in a case, first look up the unique ID for the case in one of the following ways:</p>
<!--<ol style="line-height: 19.0499992370605px; margin-top: 0.3em; margin-bottom: 0px; margin-left: 3.2em; list-style-image: none; font-family: sans-serif; font-size: 12.6999998092651px;">-->
<ol>
<li>Use the <tt>@@APPLICATION</tt> <a href="../3.1/Triggers.html#System_Variables_in_Triggers" title="Triggers">system variable</a> of the current case.</li><li>Look up the case with the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#caseList.28.29" title="ProcessMaker WSDL Web Services">caseList()</a> web service.</li><li>Look up the case in the <strong><tt>wf_&lt;WORKSPACE&gt;.APPLICATION.APP_UID</tt></strong> or <strong><tt>wf_&lt;WORKSPACE&gt;.APP_DELEGATION.APP_UID</tt></strong> fields with an SQL query.</li></ol>
<p>With the unique ID of the case, look up all the users who have been assigned to the case in the <strong><tt>wf_&lt;WORKSPACE&gt;.APP_DELEGATION.USR_UID</tt></strong> field and add them to the list of email recipients.</p>
<p>In this example, an email is sent to all users who have participated in the current case:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$caseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//UID for current case</span><br />
<span style="color: #000088;">$users</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT DISTINCT USR_UID FROM APP_DELEGATION WHERE APP_UID = '<span style="color: #006699; font-weight: bold;">$caseId</span>'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$emailTo</span><span style="color: #339933;">;</span> &nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//empty string to hold the emails of the participants in case</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$user</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$aUser</span> <span style="color: #339933;">=</span> userInfo<span style="color: #009900;">&#40;</span><span style="color: #000088;">$user</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$emailTo</span> <span style="color: #339933;">.=</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$emailTo</span><span style="color: #009900;">&#41;</span> ? <span style="color: #0000ff;">&quot;&quot;</span> <span style="color: #339933;">:</span> <span style="color: #0000ff;">&quot;,&quot;</span> <span style="color: #009900;">&#41;</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'boss@example.com'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$emailTo</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <br />
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">&quot;Update on Case Progress&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'caseStatus.html'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<h3><span id="Emailing_Members_of_a_Department">Emailing Members of a Department</span></h3>
<p>Sending an email to all members of a department is very similar to sending an email to members of a group, but the <strong><tt>USERS.DEP_UID</tt></strong> field is queried.</p>
<p>In this example, the members of a department named "Sales" are looked up in the ProcessMaker database and an email is sent to all members:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$dptName</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'Sales'</span><span style="color: #339933;">;</span> &nbsp;<span style="color: #666666; font-style: italic;">//change to name of department</span><br />
<span style="color: #000088;">$query</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;SELECT DISTINCT U.USR_UID FROM USERS AS U, CONTENT AS C WHERE &quot;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp;<span style="color: #0000ff;">&quot;C.CON_CATEGORY='DEPO_TITLE' AND C.CON_VALUE='<span style="color: #006699; font-weight: bold;">$dptName</span>' AND C.CON_ID=U.DEP_UID&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$query</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> or <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&lt;</span> <span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$g</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> G<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">SendMessageText</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Unable to find any users in department '<span style="color: #006699; font-weight: bold;">$dptName</span>'.&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;WARNING&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
<span style="color: #b1b100;">else</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$to</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$record</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$aInfo</span> <span style="color: #339933;">=</span> userInfo<span style="color: #009900;">&#40;</span><span style="color: #000088;">$record</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$to</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000088;">$to</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$aInfo</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">else</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000088;">$to</span> <span style="color: #339933;">.=</span> <span style="color: #0000ff;">', '</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$aInfo</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'boss@example.com'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$to</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <br />
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">&quot;Work for <span style="color: #006699; font-weight: bold;">$dptName</span>&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'positiveExpense.html'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<p>In this example, an email is sent to all users who have participated in the current case, and all master process or subprocess cases associated with the current case:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$caseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//UID for current case</span><br />
<span style="color: #000088;">$query</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;SELECT DISTINCT USR_UID FROM APP_DELEGATION WHERE APP_UID = <br />
&nbsp; &nbsp;(SELECT APP_UID FROM SUB_APPLICATION WHERE APP_UID = '<span style="color: #006699; font-weight: bold;">$caseId</span>' OR APP_PARENT = '<span style="color: #006699; font-weight: bold;">$caseId</span>')&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$users</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$query</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$emailTo</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//empty string to hold the emails of the participants in case</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$user</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$aUser</span> <span style="color: #339933;">=</span> userInfo<span style="color: #009900;">&#40;</span><span style="color: #000088;">$user</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$emailTo</span> <span style="color: #339933;">.=</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$emailTo</span><span style="color: #009900;">&#41;</span> ? <span style="color: #0000ff;">&quot;&quot;</span> <span style="color: #339933;">:</span> <span style="color: #0000ff;">&quot;,&quot;</span> <span style="color: #009900;">&#41;</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'boss@example.com'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$emailTo</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <br />
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">&quot;Update on Case Progress&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'caseStatus.html'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<h3><span id="Emailing_Members_of_a_Group">Emailing Members of a Group</span></h3>
<p>In this example, the members of a group are looked up in the ProcessMaker database and an email is sent to each member of a group named "employees". </p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$groupName</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'employees'</span><span style="color: #339933;">;</span> &nbsp;<span style="color: #666666; font-style: italic;">//change to name of group</span><br />
<span style="color: #000088;">$query</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;SELECT &quot;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;DISTINCT GROUP_USER.USR_UID &quot;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;FROM GROUP_USER &quot;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;INNER JOIN GROUPWF ON ( &quot;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot; GROUP_USER.GRP_ID=GROUPWF.GRP_ID AND &quot;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot; &nbsp; &nbsp;GROUPWF.GRP_TITLE='<span style="color: #006699; font-weight: bold;">{$groupName}</span>' &quot;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;) &quot;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$query</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$msg</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;Unable to find any users in group '<span style="color: #006699; font-weight: bold;">{$groupName}</span>'.&quot;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #000088;">$g</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> G<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">SendMessageText</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$msg</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;WARNING&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span> <span style="color: #b1b100;">else</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$to</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$record</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000088;">$userInfo</span> <span style="color: #339933;">=</span> userInfo<span style="color: #009900;">&#40;</span><span style="color: #000088;">$record</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$to</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000088;">$to</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$userInfo</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span> <span style="color: #b1b100;">else</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000088;">$to</span> <span style="color: #339933;">.=</span> <span style="color: #0000ff;">', '</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$userInfo</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #000088;">$departmentExample</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'boss@example.com'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$to</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;Work for <span style="color: #006699; font-weight: bold;">{$departmentExample}</span>&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'positiveExpense.html'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<p style="margin-left:25px"><strong><font color="green">Note:</font></strong> <font color="dimgray">Instead the example in this section, you can use the <a href="../3.2/ProcessMaker_Functions/Email_Functions.html#PMFSendMessageToGroup.28.29"><tt>PMFSendMessageToGroup()</tt></a> function.</font></p>

<h3><span id="Emailing_Users_with_a_Role">Emailing Users with a Role</span></h3>
<p>Sending an email to all users with a specific role requires first looking up the unique ID of the role in the <strong><tt>rb_&lt;WORKSPACE&gt;.ROLES</tt></strong> table and then querying the <strong><tt>wf_&lt;WORKSPACE&gt;.USERS.USR_ROLE</tt></strong> field for that unique ID.</p>
<p>In this example, the users with the "PROCESSMAKER_MANAGER" role are looked up in the ProcessMaker database and an email is sent to all those users:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$roleCode</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'PROCESSMAKER_MANAGER'</span><span style="color: #339933;">;</span> &nbsp;<span style="color: #666666; font-style: italic;">//change to code for role</span><br />
<span style="color: #000088;">$roleQuery</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT ROL_UID FROM ROLES WHERE ROL_CODE='<span style="color: #006699; font-weight: bold;">$roleCode</span>'&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'rbac'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$roleUid</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$roleQuery</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'ROL_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT USR_UID FROM USERS WHERE USR_ROLE='<span style="color: #006699; font-weight: bold;">$roleUid</span>'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> or <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&lt;</span> <span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$g</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> G<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">SendMessageText</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Unable to find any users with role '<span style="color: #006699; font-weight: bold;">$roleCode</span>'.&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;WARNING&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
<span style="color: #b1b100;">else</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$to</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$record</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$aInfo</span> <span style="color: #339933;">=</span> userInfo<span style="color: #009900;">&#40;</span><span style="color: #000088;">$record</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$to</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000088;">$to</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$aInfo</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">else</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000088;">$to</span> <span style="color: #339933;">.=</span> <span style="color: #0000ff;">', '</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$aInfo</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'boss@example.com'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$to</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <br />
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">&quot;Meeting for all managers next Friday&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'managersMeeting.html'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<h3><span id="Emailing_when_Cases_are_Canceled.2FPaused.2FReassigned">Emailing when Cases are Canceled/Paused/Reassigned</span></h3>
<p>To send out a email message when a case is created, deleted, canceled, paused, unpaused, reassigned or opened, create a trigger which calls PMFSendMessage(). Then, <i>right click</i> in the process map and select  select <b>Edit Process</b> from the context menu. In the process properties dialog box that opens, there are options to set the trigger to execute when the case is created, deleted, canceled, paused, unpaused, reassigned or opened. For more information, see <a href="../3.2/Triggers.html#When_action_cases">Triggers when Committing an Action in Cases</a> 

<p>For example, the following trigger sends an email notification to the next assigned user when a case reassigned:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #666666; font-style: italic;">//look up the user to whom the case was just reassigned in the database:</span><br />
<span style="color: #000088;">$caseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span><br />
<span style="color: #000088;">$sql</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;SELECT * FROM APP_DELEGATION WHERE APP_UID='<span style="color: #006699; font-weight: bold;">$caseId</span>' ORDER BY DEL_INDEX DESC&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$sql</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #000088;">$nextUserId</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$result</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$aUser</span> <span style="color: #339933;">=</span> userInfo<span style="color: #009900;">&#40;</span><span style="color: #000088;">$nextUserId</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;admin@example.com&quot;</span><span style="color: #339933;">,</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp;<span style="color: #339933;">@@</span>USR_USERNAME<span style="color: #339933;">.</span><span style="color: #0000ff;">&quot; reassigned you to case #&quot;</span><span style="color: #339933;">.@@</span>APP_NUMBER<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;reassigned.html&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<h2><span id="Debugging_Email_Notifications">Debugging Email Notifications</span></h2>
<p>Email notifications can fail for a number of reasons. If emails aren't being received, check the following issues to figure out what is causing the problem.</p>
<p>First, <a href="Email_Settings.html#Checking_the_Email_Configuration" title="Email Settings">check the email server connection configuration</a> and make sure that the email server is functioning by <a href="Email_Settings.html#Check_the_Address" title="Email Settings">pinging</a> it. Also make sure that the ProcessMaker server is configured to <a href="../3.2/Executing_cron.html" title="Executing cron.php">periodically execute <tt>cron.php</tt></a>, and then send the emails.</p>

<h3><span id="Check_the_PMFSendMessage.28.29_Return_Value">Check the <tt>PMFSendMessage()</tt> or <tt>PMFSendMessageToGroup()</tt> Return Value</span></h3>
<p>If the email was sent out by <a href="../3.2/ProcessMaker_Functions/Email_Functions.html#PMFSendMessage.28.29">PMFSendMessage()</a> or <a href="../3.2/ProcessMaker_Functions/Email_Functions.html#PMFSendMessageToGroup.28.29">PMFSendMessageToGroup()</a> in a trigger, then check the return value. If <tt>0</tt>, then there is probably a problem in the parameters of the function. Perhaps one of the email addresses is not recognized as an email address. Perhaps the name of the template file was misspelled. Remember that template names are case sensitive.</p>

<p>Assign the return value of the <tt>PMFSendMessage()</tt> or <tt>PMFSendMessageToGroup()</tt> function to a case variable and run a case with the <a href="../3.2/Triggers.html#Debugging_Triggers" title="Triggers">debugger turned on</a> to see the return value.</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>ret <span style="color: #339933;">=</span> PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">...</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p style="margin-left:25px"><strong><font color="green">Note:</font></strong> <font color="dimgray"> As of <b>ProcessMaker 3.4.0</b>, all Parameters send through the trigger function normally. However, the behavior changes when the function returns an integer number for confirmation: instead of confirming an email has been sent through the email server, the <code>artisan queue:work</code> command adds the ProcessMaker function in the queue with a <code>0</code> or <code>1</code> to confirm for the job was created. For more information about it, see the <a href="processmaker_command.html#artisan">artisan</a> command.</font></p>

<h3><span id="Check_the_APP_MESSAGE_table">Check the <tt>APP_MESSAGE</tt> Table</span></h3>
<p>Check whether a record has been written to the <strong><tt>wf_&lt;WORKSPACE&gt;.APP_MESSAGE</tt></strong> table in the database. (To avoid <a href="../3.0/Consulting_the_ProcessMaker_databases.html#From_the_Command_Line" title="Consulting the ProcessMaker databases">logging in MySQL</a> from the command line, phpMyAdmin can be used to <a href="../3.0/Consulting_the_ProcessMaker_databases.html#From_the_phpMyAdmin_GUI" title="Consulting the ProcessMaker databases">view the database from a web browser</a>.)</p>

<p>Every email message to be sent out will be stored in the <strong><tt>wf_&lt;WORKSPACE&gt;.APP_MESSAGE</tt></strong> table in the database. When the record is first written to the database, the <strong><tt>APP_MSG_SENT</tt></strong> field will be set to the current datetime. (Note that the <strong><tt>APP_MSG_SENT</tt></strong> field doesn't indicate the time when the message was sent to the email server.) When the email message is sent to the email server by the <strong><tt>cron.php</tt></strong> script, the <strong><tt>APP_MSG_STATUS</tt></strong> field will change from <tt>"pending"</tt> to <tt>"sent"</tt>.</p>

<h3 style="margin-bottom: 0.6em; overflow: hidden; padding-top: 0.5em; padding-bottom: 0.17em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(170, 170, 170); width: auto; background: none;"><span id="Check_the_Output_of_cron.php">Check the Output of <tt>cron.php</tt></span></h3>
<p>When the <strong><tt>cron.php</tt></strong> script is executed, it sends every message in the <strong><tt>wf_&lt;WORKSPACE&gt;.APP_MESSAGE</tt></strong> table whose status is <tt>"pending"</tt> to the email server. <strong><tt>cron.php</tt></strong> keeps a <a href="../3.0/Executing_cron.html#cron.php_Log_Files" title="Executing cron.php">log of its activities</a>. If emails were sent out, a record should be written in the <strong><tt>shared/log/cron.log</tt></strong> file. If an error occurred while trying to send out emails, a record should be written to the <strong><tt>shared/log/cronError.log</tt></strong> file.</p>

<p>If the log files don't indicate anything, execute <strong><tt>cron.php</tt></strong> manually from the command line and check the output.</p>


<h2><span id="Log_Module_to_manage_notifications">Log Module to Manage Notifications</span></h2>

<p>The log module displays information of all mails sent inside a process. This feature is optimized by emulating <tt>APP_MESSAGE</tt> inside the log, allowing emails to be searched using different search parameters.</p> 

<p>Take into consideration that only users with the <a href="../3.1/Roles.html#PM_SETUP"><tt>PM_SETUP</tt></a> and <a href="../3.1/Roles.html#PM_SETUP_LOGS"><tt>PM_SETUP_LOGS</tt></a> permissions assigned to their role will have access to the email log.</p>

<p>The following notifications will be stored inside it:</p>
<ul><li><a href="../3.2/Tasks.html" title="Tasks">Tasks</a></li>
<li><a href="Events.html" title="Events">Events</a></li>
<li><a href="../3.2/Case_Notes.html" title="Case Notes">Case Notes</a></li>
<li><a href="#Sending_emails_with_PMFSendMessage.28.29" title="Notifications">PMFSendMessage() or PMFSendMessageToGroup() function:</a> When sending emails using the <a href="#Sending_emails_with_PMFSendMessage.28.29" title="Notifications">PMFSendMessage() or PMFSendMessageToGroup()</a> function.</li></ul>

<p>When emails are sent, their registry is stored at <strong>ADMIN &gt; Settings &gt; Logs &gt; Emails</strong></p>

<p><img alt="" src="../sites/default/files/3.3.8LogsEmailLog.png"></p>

<h3><span id="Best_Practices_When_Managing_Large_Amount_Of_Data">Bests Practices When Managing A Large Amount Of Data In The Message Inbox</span></h3>
<p>When the number of rows in the message list contains several hundred thousand or more rows, as a best practice follow these guidelines to ensure ProcessMaker displays all messages in the list:</p>
<ul>
    <li>
        <p>To avoid time issues, <a href="../3.5/Configuration_File_env.html#Editing_the_env.ini_file">edit the <code>env.ini</code></a> and set the <a href="../3.5/Configuration_File_env.html#ext_ajax_timeout"><code>ext_ajax_timeout</code></a> property to <b>600000</b>.</p>
    </li>
    <li><p>To improve performance on the database, add an <code>INDEX</code> into the <code>APP_MESSAGE</code> ProcessMaker table. Run the following SQL query:</p>
<div class="geshifilter"><div class="text geshifilter-text" style="font-family:monospace;">ALTER TABLE `APP_MESSAGE` ADD INDEX `indexAppUidSendDate`<br />
(`APP_UID`, `APP_MSG_SEND_DATE`); &nbsp; </div></div>
</li>
</ul>

<h3><span id="Email_Log_Options">Email Log Options</span></h3>

<p>Once an email has been sent, it will be stored in <tt>wf_&lt;workspace&gt.APP_MESSAGE</tt> table and displayed in the log list with the following information:</p>
<ul><li><tt><strong>#</strong></tt>: Displays the number of the case where the email was sent.</li>
<li><tt><strong>Case</strong></tt>: Displays the name of the case where the email was sent.</li>
<li><tt><strong>Process</strong></tt>: Name of the process where the email was sent.</li>
<li><tt><strong>Task</strong></tt>: Name of the task where the email was configured to be sent.</li>
<li><tt><strong>Type</strong></tt>: Displays the type of notification. 
<ul>
    <li>Until <b>ProcessMaker 3.3.7:</b> There are two types of notifications. <tt>"Trigger"</tt> if an email was sent using a trigger (using the <a href="#Sending_emails_with_PMFSendMessage.28.29" title="Notifications">PMFSendMessage()</a> function, for example), and <tt>"Derivation"</tt> if the email was sent using a <a href="../3.2/Tasks.html#NOTIFICATIONS" title="Processes">Task Notification</a> or a <a href="../3.2/Case_Notes.html" title="Case Notes">Case Note</a>.</li>
    <li>As of <b>ProcessMaker 3.3.8:</b> There are the following types. These changes apply to new logs in this version.
        <ul>
            <li><b>PM_FUNCTION</b>: Triggers inside a task (<a href="../3.2/ProcessMaker_Functions/Email_Functions.html">Email functions like <tt>PMFSendMessage()</tt> and <tt>PMFSendMessageToGroup()</tt></a>), process status, plugins.</li>
            <li><b>ROUTING</b>: <a href="../3.2/Tasks.html#NOTIFICATIONS" title="Processes">Task Notifications</a>.</li>
            <li><b>EVENT</b>: <a href="Events.html">Email events</a>.</li>
            <li><b>ACTION_BY_EMAIL</b>: <a href="Actions_by_Email.html">Actions by Email</a>.</li>
            <li><b>EXTERNAL_REGISTRATION</b>: <a href="../3.0/External_Registration.html">External Registration</a>.</li>
            <li><b>TEST</b>: <a href="Email_Settings.html#Testing_the_Email_Configuration">Testing the Email Configuration</a>.</li>
            <li><b>CASE_NOTE</b>: <a href="../3.2/Case_Notes.html" title="Case Notes">Case Notes</a>.</li>
            <li><b>SOAP</b>: Using the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#sendMessage.28.29"><tt>sendMessage()</tt></a> function.</li>
            <li><b>RETRIEVE_PASSWORD</b>: <a href="login-2.html#Enable_Password_Recovery">Password recovery</a>.</li>
        </ul>
    </li>
</ul></li>
<li><tt><strong>Date</strong></tt>: Date when the email was sent.</li>
<li><tt><strong>Subject</strong></tt>: The subject (title) of the email.</li>
<li><tt><strong>From</strong></tt>: The email address of the person who sent the email.</li>
<li><tt><strong>To</strong></tt>: The email address to whom the email was sent.</li>
<li><tt><strong>Error</strong></tt>: Displays any error that might have occurred if the email wasn't sent correctly.</li>
<li><tt><strong>Status</strong></tt>: Displays the status of the message. If the email was sent its status will be <tt>Sent</tt>, otherwise it will be <tt>Pending</tt>. This status can be changed in if a lot of mails were on queue and they weren't sent correctly. If this value is changed, it will also be changed in the <tt>APP_MESSAGE</tt> table.</li></ul>

<p style="margin-left:25px"><strong><font color="green">Note:</font></strong> <font color="dimgray">As of <b>ProcessMaker 3.3.8</b> new logs, the default text is <b><tt>N/A</tt></b> that stands for not applicable. Review the following table for new types and <b><tt>N/A</tt></b>. If no value is in the cell, it means that the email logs display the name.
<table style="margin-left:25px">
    <tr>
        <td>Type/Columns</td>
        <td><b>#</b></td>
        <td><b>Case</b></td>
        <td><b>Process</b></td>
        <td><b>Task</b></td>
        <td><b>Type</b></td>
    </tr>
    <tr>
        <td><b>Functions like <a href="../3.2/ProcessMaker_Functions/Email_Functions.html#PMFSendMessage.28.29"><tt>PMFSendMessage()</tt></a></b></td>
        <td></td>
        <td></td>
        <td></td>
        <td>N/A if the parameter <tt>delIndex</tt> is <tt>0</tt>.</td>
        <td>PM_FUNCTION</td>
    </tr>
    <tr>
        <td><b>Task Notifications</b></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td>ROUTING</td>
    </tr>
    <tr>
        <td><b>Email Events</b></td>
        <td></td>
        <td></td>
        <td></td>
        <td>Event name or INTERMEDIATE-THROW-EMAIL-EVENT if the event does not have name</td>
        <td>EVENT</td>
    </tr>
    <tr>
        <td><b>Actions by Email</b></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td>ACTION_BY_EMAIL</td>
    </tr>
    <tr>
        <td><b>External Registration</b></td>
        <td>N/A</td>
        <td>N/A</td>
        <td>N/A</td>
        <td>N/A</td>
        <td>EXTERNAL_REGISTRATION</td>
    </tr>
    <tr>
        <td><b>Test Email</b></td>
        <td>N/A</td>
        <td>N/A</td>
        <td>N/A</td>
        <td>N/A</td>
        <td>TEST</td>
    </tr>
    <tr>
        <td><b>Case Notes</b></td>
        <td></td>
        <td></td>
        <td></td>
        <td>N/A</td>
        <td>CASE_NOTE</td>
    </tr>
    <tr>
        <td><b><tt>sendMessage()</tt> in SOAP</b></td>
        <td></td>
        <td></td>
        <td></td>
        <td>N/A</td>
        <td>SOAP</td>
    </tr>
    <tr>
        <td><b>Password recovery</b></td>
        <td>N/A</td>
        <td>N/A</td>
        <td>N/A</td>
        <td>N/A</td>
        <td>RETRIEVE_PASSWORD</td>
    </tr>
</table>
</font></p>

<p>Below each email description, a preview of the message body is displayed. Click on the <img alt="" src="../sites/default/files/Iconexpand.png" height="9" width="10"> icon to expand the information, and the <img alt="" src="../sites/default/files/Iconcontract.png" height="9" width="8"> icon to contract it.</p>

<p><img alt="" src="../sites/default/files/3.1NotificationsEmailLogsDetails.png" ></p>

<p>In the example above, an email was sent by adding a case note.</p>
<p>If the template was created with a customized style, font size, color, etc. the format will be displayed in the preview. In the example below, an event was executed and its template was created using a customized style:</p>
<p><img alt="" src="../sites/default/files/EmailBodyPreviewStyles.png" height="120" width="1075"></p>

<h3><span id="Searching_Emails">Searching Emails</span></h3>

<p>One of the advantages of the email log is the ability to search for an email using selected criteria. The search criteria are:</p>

<p><img alt="" src="../sites/default/files/3.3.8NotificationsEmailLogsSearch.png" ></p>

<ul>
<li><tt><strong>Filter by</strong></tt>: Applies a filter.
    <ul>
    <li><b>All:</b> Displays all the emails sent.</li>
    <li><b>Cases:</b> Displays only emails that have been sent inside cases. This includes: Triggers, Task Notifications, Events.</li>
    <li><b>Test:</b> Displays only records of emails that were sent by testing an <a href="Email_Settings.html">Email Server</a> configuration. If this option is selected, the Process dropdown filter will be disabled.</li>
    <li><b>External Registration:</b> Displays only records of emails that were sent by this plugin. This option is only available when the <a href="../3.0/External_Registration.html">External Registration</a> plugin is enabled. If this option is selected, the Process dropdown filter will be disabled</li>
    </ul>
</li>
<li><tt><strong>Process</strong></tt>: Search by process name or by all processes created in the current workspace.</li>
<li><tt><strong>Status</strong></tt>: Search by status: <i>All, Participated or Pending</i>.</li>
<li><tt><strong>Date From: / To:</strong></tt> Search by the date when email was sent.</li>
<li><tt><strong>Filter:</strong></tt> Click <b>Filter</b> to filter the email logs. The criteria displays.
<p><img alt="" src="../sites/default/files/3.3.8NotificationsEmailLogsFilterbyCases.png" ></p>
</li>
</ul></div></div></div>  </div>

      <footer>
          </footer>
  
    </div>
  
</div> <!-- /.block -->
</div>
 <!-- /.region -->
      </section>
    </div>
  
      
    </div>

      
</div>

 <!---add diego--->
  <div id="download-app-section" class="download-app mobile-none">
			<div class="row">
				<div class="col-md-12">
					<div class="text_app">Download our app</div>
							<a href="https://itunes.apple.com/us/app/processmaker/id992576284?ls=1&amp;mt=8" target="_blank">
								<img src="../themes/thecompany_responsive_theme/images/appstore.png">
							<a href="https://play.google.com/store/apps/details?id=com.colosa.processmaker" target="_blank">
								<img src="../themes/thecompany_responsive_theme/images/playstore.png">				
				</div>
			</div>
  </div>
  <!---end diego--->
<!----add diego----->    
		<div class="logo_processmaker"><a href="http://www.processmaker.com/">
		<img src="../themes/thecompany_responsive_theme/images/logo_processmaker.png"></div>
<!----end diego----->
<div id="footer">
  <div id="footer_wrapper">
      </div>

  <div class="social-media-wrapper">
         <div id="social-media-icons">
       <ul>
       	<div class="text_contact">Contact us</div>
				<div class="text_number">+1-617-340-3377</div>
        <!--<li><a class="rss" href="/rss.xml">rss</a></li> <!--edit diego-->
        <li><a class="facebook" href="http://facebook.com/processmaker/" target="_blank" rel="me">facebook</a></li>
        <li><a class="twitter" href="https://twitter.com/processmaker" target="_blank" rel="me">twitter</a></li>
        <li><a class="gplus" href="https://www.google.com/+ProcessMakerOpenSource" target="_blank" rel="me">Gplus</a></li>
        <li><a class="linkedin" href="https://www.linkedin.com/groups?mostRecent=&amp;gid=3970335&amp;trk=my_groups-tile-flipgrp" target="_blank" rel="me">Linked in</a></li>
        <!--<li><a class="dribbble" href="http://dribbble.com" target="_blank" rel="me">Dribbble</a></li>
        <li><a class="vimeo" href="http://vimeo.com" target="_blank" rel="me">Vimeo</a></li>-->
        <li><a class="youtube" href="https://www.youtube.com/user/processmaker" target="_blank" rel="me">Youtube</a></li>
       </ul>
      </div>
      </div>
  
  <div class="footer_credit">
    <div class="footer_inner_credit">
           <div id="foot"><div class="region region-footer">
  <div id="block-block-2" class="block block-block">

      
  <div class="content">
    <p><font style="font-family:arial,sans-serif; font-size:15px; font-weight: none; color:#FFF">Automate your Workflow with Business Process Management<br>Software licensed under the <a 1px="" class="external text" href="http://www.gnu.org/licenses/agpl.html" rel="nofollow" style="padding-right: 13px; color:white;">GNU Affero General Public License version 3</a><br>Contact us:&nbsp;<a class="external free" href="mailto:community@processmaker.com" rel="nofollow" style="font-weight:bold;color:white;text-decoration:underline;">community@processmaker.com</a><br><a class="external free" href="https://www.processmaker.com/privacy-statement" rel="nofollow" style="font-weight:bold;color:white;text-decoration:underline;">Privacy Statement</a></font><br><font style="font-family:arial,sans-serif; font-size:15px; font-weight: none; color:#FFF">© Copyright 2000-2024 ProcessMaker Inc. All rights reserved.</font></p>
  </div>
  
</div> <!-- /.block -->
</div>
 <!-- /.region -->
</div>
         
   <!-- <div id="copyright">
      <p class="copyright">Copyright &copy; 2024, Documentation@ProcessMaker </p>
      <!--<p class="credits"> Developed by  <a href="http://www.zymphonies.com">Zymphonies</a></p>
      <div class="clear"></div>
    </div>-->
  </div>
  
  </div>
</div>

</div>

<script type="text/javascript">
  /* <![CDATA[ */
  document.write (
    '<img src="https://marketing.processmaker.com/acton/bn/3812/visitor.gif?ts='+ new Date().getTime()+ '&ref='+escape(document.referrer) + '">'
  );
  /* ]]> */
</script>
  
</div>
    <style>
    .center-div{
        width: 100%;        
        margin: 0 auto;
        z-index:10000;
        position:fixed;
        bottom: 0px;
        cursor:pointer;
    }
    .round-popup{
        margin:0 auto;
        font-family: 'Montserrat', sans-serif;
        font-size: 15px;
        font-weight: lighter;
        width: 412px;
        height: 50px;
        padding-top: 7px;
        text-align: center;
        position:relative;
    }
    .round-popup-button{
        position:absolute;
        top: 11px;
        right: 15px;
        background: transparent;
        border:none;
        font-size:15px;
        font-weight:normal;
        line-height:20px;
        width:20px;
        height:20px;
        padding:0;
    }
    .round-background-blue{
        background: url('http://www.processmaker.com/uploads/blue.png')no-repeat;
        color:white;
        
    }
    #box-pm31-button-blue{
        color: rgba(255, 255, 255, 0.5);
    }
    
    #box-pm31-button-blue:active,#box-pm31-button-blue:focus{
        border:none;
        outline:none;
    }
    .round-background-blue a{
        color: white!important;
        text-decoration: none;
        font-size: 15px;
        line-height:45px;
        font-family:Montserrat, sans-serif;
    }
    .round-background-blue span{
        font-weight: bold;
    }
    /*WHITE background*/
    .round-background-white{
        background: url('http://www.processmaker.com/uploads/white.png')no-repeat;
        background-position-x: -9px;        
        color: #3397E1;
    }
    .round-background-white a:hover{
        color: #3397E1!important;
        text-decoration: none;
        font-size: 15px;
    }
    #box-pm31-button-white{
        color: rgba(51, 151, 225, 0.7);
    }
</style>
    <div id="box-pm31" class="center-div" style="display:none;">
        <div class="round-popup round-background-blue">
            <a onclick="ga('send', 'event', 'WikiBlueBanner','click','PM31Release');" href="http://www.processmaker.com/download-processmaker-landing-page">
                <span>ProcessMaker 3.1</span> is Here! Download Now <span style="font-size:20px;font-weigth:normal;">»</span>
            </a>
            <button id="box-pm31-button-blue" class="round-popup-button">&times;</button>
        </div>
    </div>
    <script>

function pmCreateCookie(name,value,days) {
    if (days) {
        var date = new Date();
        date.setTime(date.getTime()+(days*24*60*60*1000));
        var expires = "; expires="+date.toGMTString();
    }
    else var expires = "";
    document.cookie = name+"="+value+expires+"; path=/";
}

function pmReadCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return null;
}

function pmEraseCookie(name) {
    createCookie(name,"",-1);
}



     jQuery(document).ready(function( $ ) {
        $('#box-pm31-button-blue').click(function(e){
                e.stopPropagation();
                $('#box-pm31').slideUp('fast');
                pmCreateCookie('ppcookie','val',10);
            });
        });
        jQuery(window).load(function() {
            if(pmReadCookie('ppcookie') !== 'val'){
                //jQuery('#box-pm31').delay( 2000 ).slideDown('slow');
            }
        });
    </script>
<link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet">

<script type="text/javascript">
  (function() {
    window._pa = window._pa || {};
    // _pa.orderId = "myOrderId"; // OPTIONAL: attach unique conversion identifier to conversions
    // _pa.revenue = "19.99"; // OPTIONAL: attach dynamic purchase values to conversions
    // _pa.productId = "myProductId"; // OPTIONAL: Include product ID for use with dynamic ads
    var pa = document.createElement('script'); pa.type = 'text/javascript'; pa.async = true;
    pa.src = ('https:' == document.location.protocol ? 'https:' : 'http:') + "//tag.marinsm.com/serve/586a7ec3a2ae6b728400003d.js";
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(pa, s);
  })();
</script>

</body>

<!-- Mirrored from wiki.processmaker.com/3.3/Notifications by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Feb 2024 09:33:46 GMT -->
</html>
