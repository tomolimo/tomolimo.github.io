<!DOCTYPE html>

<!-- Mirrored from wiki.processmaker.com/3.1/ProcessMaker_Functions by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Feb 2024 09:32:22 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta name="keywords" content="BPM, business process management, workflow, processmaker, business, BPM Windows, BPM Linux, wiki, BPM documentation, BPM FAQ, task documentation, BPM PHP, BPM Open Source, BPM Variables, BPM Installation, BPM Programming, BPM Elements, BPM Concepts, BPM Frequently Asked Questions, BPM 3.0, BPM News, Release notes, DynaForms, BPM Community, BPM Enterprise, BPM Mobile, BPM Responsive Web Design, User Manual, BPM Resources" />
<link rel="alternate" hreflang="en" href="../index.html" />
<link rel="shortcut icon" href="../themes/thecompany_responsive_theme/favicon.ico" type="image/vnd.microsoft.icon" />
<meta name="description" content="ProcessMaker is commercial open source workflow and business process management software." />
<meta name="viewport" content="width=device-width" />
<meta name="Generator" content="Drupal 7 (http://drupal.org)" />
<link rel="canonical" href="ProcessMaker_Functions.html" />
<link rel="shortlink" href="../node/558.html" />
<title>3.1 - ProcessMaker Functions | Documentation@ProcessMaker</title>
<style type="text/css" media="all">
@import url("../modules/system/system.base2af9.css?s743n7");
@import url("../modules/system/system.menus2af9.css?s743n7");
@import url("../modules/system/system.messages2af9.css?s743n7");
@import url("../modules/system/system.theme2af9.css?s743n7");
</style>
<style type="text/css" media="all">
@import url("../modules/aggregator/aggregator2af9.css?s743n7");
@import url("../modules/comment/comment2af9.css?s743n7");
@import url("../modules/field/theme/field2af9.css?s743n7");
@import url("../modules/node/node2af9.css?s743n7");
@import url("../modules/search/search2af9.css?s743n7");
@import url("../modules/toc_filter/toc_filter2af9.css?s743n7");
@import url("../modules/user/user2af9.css?s743n7");
@import url("../modules/views/css/views2af9.css?s743n7");
</style>
<style type="text/css" media="all">
@import url("../sites/all/modules/colorbox/styles/default/colorbox_style2af9.css?s743n7");
@import url("../modules/ctools/css/ctools2af9.css?s743n7");
@import url("../sites/all/modules/geshifilter/geshifilter2af9.css?s743n7");
@import url("../modules/panels/css/panels2af9.css?s743n7");
@import url("../modules/nice_menus/css/nice_menus2af9.css?s743n7");
@import url("../modules/nice_menus/css/nice_menus_default2af9.css?s743n7");
@import url("../modules/fivestar/css/fivestar2af9.css?s743n7");
</style>
<style type="text/css" media="all">
@import url("../themes/thecompany_responsive_theme/css/style2af9.css?s743n7");
@import url("../themes/thecompany_responsive_theme/css/media2af9.css?s743n7");
</style>
<script type="text/javascript" src="../modules/jquery_update/replace/jquery/1.9/jquery.min4b17.js?v=1.9.1"></script>
<script type="text/javascript" src="../misc/jquery.once7839.js?v=1.2"></script>
<script type="text/javascript" src="../misc/drupal2af9.js?s743n7"></script>
<script type="text/javascript" src="../modules/nice_menus/js/jquery.bgiframef195.js?v=2.1"></script>
<script type="text/javascript" src="../modules/nice_menus/js/jquery.hoverIntent1f6b.js?v=0.5"></script>
<script type="text/javascript" src="../modules/nice_menus/js/superfish099d.js?v=1.4.8"></script>
<script type="text/javascript" src="../modules/nice_menus/js/nice_menusc619.js?v=1.0"></script>
<script type="text/javascript" src="../modules/jquery_update/replace/ui/external/jquery.cookie1683.js?v=67fb34f6a866c40d0570"></script>
<script type="text/javascript" src="../modules/jquery_update/replace/misc/jquery.form.min97e5.js?v=2.69"></script>
<script type="text/javascript" src="../misc/ajax2347.js?v=7.34"></script>
<script type="text/javascript" src="../modules/jquery_update/js/jquery_update241d.js?v=0.0.1"></script>
<script type="text/javascript" src="../modules/toc_filter/toc_filter2af9.js?s743n7"></script>
<script type="text/javascript" src="../sites/all/modules/colorbox/js/colorbox2af9.js?s743n7"></script>
<script type="text/javascript" src="../sites/all/modules/colorbox/styles/default/colorbox_style2af9.js?s743n7"></script>
<script type="text/javascript" src="../sites/all/modules/google_analytics/googleanalytics2af9.js?s743n7"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
(function(i,s,o,g,r,a,m){i["GoogleAnalyticsObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,"script","../../www.google-analytics.com/analytics.js","ga");ga("create", "UA-3380652-1", {"cookieDomain":"auto"});ga("set", "anonymizeIp", true);ga("send", "pageview");
//--><!]]>
</script>
<script type="text/javascript" src="../misc/progress2347.js?v=7.34"></script>
<script type="text/javascript" src="../modules/fivestar/js/fivestar.ajax2af9.js?s743n7"></script>
<script type="text/javascript" src="../modules/fivestar/js/fivestar2af9.js?s743n7"></script>
<script type="text/javascript" src="../themes/thecompany_responsive_theme/js/jquery-1.10.2.min2af9.js?s743n7"></script>
<script type="text/javascript" src="../themes/thecompany_responsive_theme/js/jquery-ui2af9.js?s743n7"></script>
<script type="text/javascript" src="../themes/thecompany_responsive_theme/js/jquery-ui.min2af9.js?s743n7"></script>
<script type="text/javascript" src="../themes/thecompany_responsive_theme/js/custom2af9.js?s743n7"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"thecompany_responsive_theme","theme_token":"oFGBobJV-K9HikZu5UbqBVtFE3rGE9S19_Zulx94-Bw","jquery_version":"1.9","js":{"modules\/jquery_update\/replace\/jquery\/1.9\/jquery.min.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"modules\/nice_menus\/js\/jquery.bgiframe.js":1,"modules\/nice_menus\/js\/jquery.hoverIntent.js":1,"modules\/nice_menus\/js\/superfish.js":1,"modules\/nice_menus\/js\/nice_menus.js":1,"modules\/jquery_update\/replace\/ui\/external\/jquery.cookie.js":1,"modules\/jquery_update\/replace\/misc\/jquery.form.min.js":1,"misc\/ajax.js":1,"modules\/jquery_update\/js\/jquery_update.js":1,"modules\/toc_filter\/toc_filter.js":1,"sites\/all\/modules\/colorbox\/js\/colorbox.js":1,"sites\/all\/modules\/colorbox\/styles\/default\/colorbox_style.js":1,"sites\/all\/modules\/google_analytics\/googleanalytics.js":1,"0":1,"misc\/progress.js":1,"modules\/fivestar\/js\/fivestar.ajax.js":1,"modules\/fivestar\/js\/fivestar.js":1,"themes\/thecompany_responsive_theme\/js\/jquery-1.10.2.min.js":1,"themes\/thecompany_responsive_theme\/js\/jquery-ui.js":1,"themes\/thecompany_responsive_theme\/js\/jquery-ui.min.js":1,"themes\/thecompany_responsive_theme\/js\/custom.js":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/system\/system.theme.css":1,"modules\/aggregator\/aggregator.css":1,"modules\/comment\/comment.css":1,"modules\/field\/theme\/field.css":1,"modules\/node\/node.css":1,"modules\/search\/search.css":1,"modules\/toc_filter\/toc_filter.css":1,"modules\/user\/user.css":1,"modules\/views\/css\/views.css":1,"sites\/all\/modules\/colorbox\/styles\/default\/colorbox_style.css":1,"modules\/ctools\/css\/ctools.css":1,"sites\/all\/modules\/geshifilter\/geshifilter.css":1,"modules\/panels\/css\/panels.css":1,"modules\/nice_menus\/css\/nice_menus.css":1,"modules\/nice_menus\/css\/nice_menus_default.css":1,"modules\/fivestar\/css\/fivestar.css":1,"themes\/thecompany_responsive_theme\/css\/style.css":1,"themes\/thecompany_responsive_theme\/css\/media.css":1}},"colorbox":{"opacity":"0.85","current":"{current} of {total}","previous":"\u00ab Prev","next":"Next \u00bb","close":"Close","maxWidth":"98%","maxHeight":"98%","fixed":true,"mobiledetect":true,"mobiledevicewidth":"480px","specificPagesDefaultValue":"admin*\nimagebrowser*\nimg_assist*\nimce*\nnode\/add\/*\nnode\/*\/edit\nprint\/*\nprintpdf\/*\nsystem\/ajax\nsystem\/ajax\/*"},"toc_filter_smooth_scroll_duration":"","googleanalytics":{"trackOutbound":1,"trackMailto":1,"trackDownload":1,"trackDownloadExtensions":"7z|aac|arc|arj|asf|asx|avi|bin|csv|doc(x|m)?|dot(x|m)?|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt(x|m)?|pot(x|m)?|pps(x|m)?|ppam|sld(x|m)?|thmx|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls(x|m|b)?|xlt(x|m)|xlam|xml|z|zip","trackColorbox":1},"nice_menus_options":{"delay":"800","speed":"slow"},"ajax":{"edit-vote--2":{"callback":"fivestar_ajax_submit","event":"change","url":"\/system\/ajax","submit":{"_triggering_element_name":"vote"}}}});
//--><!]]>
</script>
<!--[if lt IE 9]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','../../connect.facebook.net/en_US/fbevents.js');
// Insert Your Facebook Pixel ID below.
fbq('init', '735235999992228');
fbq('track', 'PageView');
</script>
<!-- Insert Your Facebook Pixel ID below. -->
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=735235999992228&amp;ev=PageView&amp;noscript=1"
/></noscript>
<!-- End Facebook Pixel Code -->

</head>
<body class="html not-front not-logged-in no-sidebars page-node page-node- page-node-558 node-type-community-edition">
    
<div class="wrap">

<div id="header_wrapper">
  <div id="inner_header_wrapper">

    <header id="header" role="banner">
      
      <div class="header_inner_wrapper">
        <div class="header_left">
                      <div id="logo">
              <a href="../index.html" title="Home"><img src="../sites/default/files/full-logo.png"/></a>
            </div>
                    	  <div class="menu_wrapper">
            <nav id="main-menu"  role="navigation">
              <a class="nav-toggle" href="#">Navigation</a>
              <div class="menu-navigation-container">
                <ul class="menu"><li class="first leaf"><a href="../PM_Classic.html" title="Learn how to develop business solutions in ProcessMaker Platform while maintaining your existing ProcessMaker 3 solutions in PM Classic: the perfect bridge between your new and existing solutions with a state-of--the-art BPM platform.">PM Classic</a></li>
<li class="leaf"><a href="http://www.processmaker.com/tutorials" title="">Tutorials</a></li>
<li class="leaf"><a href="user_guide.html">User Guide</a></li>
<li class="leaf"><a href="developer_info.html">Developer Info</a></li>
<li class="leaf"><a href="../3.2/sys_administration.html">Sys Administration</a></li>
<li class="leaf"><a href="resources.html">Helpful Resources</a></li>
<li class="leaf"><a href="../Sitemap.html">Sitemap</a></li>
<li class="last leaf"><a href="https://processmaker.gitbook.io/processmaker/" title="Read ProcessMaker Platform Spring 2023 documentation to learn more about the next generation of BPM.">ProcessMaker Platform</a></li>
</ul>              </div>
              <div class="clear"></div>
            </nav>
          </div>
                  <!--  <h1 id="site-title">
            <a href="/" title="Home">Documentation@ProcessMaker</a>
            <div id="site-description"></div>
          </h1> -->
            
        </div>
      </div>
      <div class="header_right">
          <div class="region region-search">
  <div id="block-search-form" class="block block-search">

        <h2 >_</h2>
    
  <div class="content">
    <form action="https://wiki.processmaker.com/3.1/ProcessMaker_Functions" method="post" id="search-block-form" accept-charset="UTF-8"><div><div class="container-inline">
    <div class="form-item form-type-textfield form-item-search-block-form">
  <label class="element-invisible" for="edit-search-block-form--2">Search </label>
 <input title="Enter the terms you wish to search for." placeholder="Search" type="text" id="edit-search-block-form--2" name="search_block_form" value="" size="15" maxlength="128" class="form-text" />
</div>
<div class="form-actions form-wrapper" id="edit-actions"><input type="submit" id="edit-submit" name="op" value="Search" class="form-submit" /></div><input type="hidden" name="form_build_id" value="form-ZcvyVoZIX4t1YSiQONav1ntEBEA_MrXf3DF0W_xxQ5g" />
<input type="hidden" name="form_id" value="search_block_form" />
</div>
</div></form>  </div>
  
</div> <!-- /.block -->
</div>
 <!-- /.region -->
                  <h1 class="page-title">3.1 - ProcessMaker Functions</h1>                <p class="page-title-suffix"></p>
                 <div style="margin-top: 5px;"></div>
      </div>
    </header>
    <div class="region-version">
      <span>Version: </span><ul><li><a href="../3.7/ProcessMaker_Functions/User_Functions.html" class="">3.8</a></li><li><a href="../3.7/ProcessMaker_Functions/User_Functions.html" class="">3.7</a></li><li><a href="../3.2/ProcessMaker_Functions.html" class="">3.6</a></li><li><a href="../3.2/ProcessMaker_Functions.html" class="">3.5</a></li><li><a href="../3.2/ProcessMaker_Functions.html" class="">3.4</a></li><li><a href="../3.2/ProcessMaker_Functions.html" class="">3.3</a></li><li><a href="../3.2/ProcessMaker_Functions.html" class="">3.2</a></li><li><a  class="active-version">3.1</a></li><li><a href="../3.0/ProcessMaker_Functions.html" class="">3.0</a></li><li><a href="../index.php/ProcessMaker_Functions.html" class="">2.x</a></li></ul>    </div>
  </div>
</div>
<!-- <ul class="nice-menu nice-menu-down nice-menu-main-menu" id="nice-menu-0"><li class="menu-506 menu-path-node-1078 first odd "><a href="/PM_Classic" title="Learn how to develop business solutions in ProcessMaker Platform while maintaining your existing ProcessMaker 3 solutions in PM Classic: the perfect bridge between your new and existing solutions with a state-of--the-art BPM platform.">PM Classic</a></li>
<li class="menu-319 menu-path-processmakercom-tutorials  even "><a href="http://www.processmaker.com/tutorials" title="">Tutorials</a></li>
<li class="menu-320 menu-path-node-571  odd "><a href="/3.1/user_guide">User Guide</a></li>
<li class="menu-1138 menu-path-node-572  even "><a href="/3.1/developer_info">Developer Info</a></li>
<li class="menu-1197 menu-path-node-876  odd "><a href="/3.2/sys_administration">Sys Administration</a></li>
<li class="menu-1140 menu-path-node-236  even "><a href="/3.1/resources">Helpful Resources</a></li>
<li class="menu-1141 menu-path-node-554  odd "><a href="/Sitemap">Sitemap</a></li>
<li class="menu-1213 menu-path-sprocessmakergitbookio-processmaker-  even last"><a href="https://processmaker.gitbook.io/processmaker/" title="Read ProcessMaker Platform Spring 2023 documentation to learn more about the next generation of BPM.">ProcessMaker Platform</a></li>
</ul>
-->
  
  <div id="container">
    
    <div class="content-sidebar-wrap">

    <div id="content">

              <!-- <div id="breadcrumbs">
        <h2 class="element-invisible">You are here</h2><div class="breadcrumb"><a href="/">Home</a></div></div> -->
      
      <section id="post-content" role="main">
                                        <div class="region region-content">
  <div id="block-system-main" class="block block-system">

      
  <div class="content">
                          <span property="dc:title" content="3.1 - ProcessMaker Functions" class="rdf-meta element-hidden"></span>  
      
    
  <div class="content node-community-edition">
    <div class="field field-name-field-how-useful field-type-fivestar field-label-above"><div class="field-label">Please rate how useful you found this document:&nbsp;</div><div class="field-items"><div class="field-item even"><form class="fivestar-widget" action="https://wiki.processmaker.com/3.1/ProcessMaker_Functions" method="post" id="fivestar-custom-widget" accept-charset="UTF-8"><div><div  class="clearfix fivestar-average-text fivestar-average-stars fivestar-form-item fivestar-default"><div class="form-item form-type-fivestar form-item-vote">
 <div class="form-item form-type-select form-item-vote">
 <select id="edit-vote--2" name="vote" class="form-select"><option value="-">Select rating</option><option value="20">Give 3.1 - ProcessMaker Functions 1/5</option><option value="40">Give 3.1 - ProcessMaker Functions 2/5</option><option value="60">Give 3.1 - ProcessMaker Functions 3/5</option><option value="80" selected="selected">Give 3.1 - ProcessMaker Functions 4/5</option><option value="100">Give 3.1 - ProcessMaker Functions 5/5</option></select>
<div class="description"><div class="fivestar-summary fivestar-summary-average-count"><span class="average-rating">Average: <span >3.7</span></span> <span class="total-votes">(<span >3</span> votes)</span></div></div>
</div>

</div>
</div><input class="fivestar-submit form-submit" type="submit" id="edit-fivestar-submit" name="op" value="Rate" /><input type="hidden" name="form_build_id" value="form-52Zbm3OHJj0ILw-TaRvsKvrCYI6GuipFm8Rha36GUV4" />
<input type="hidden" name="form_id" value="fivestar_custom_widget" />
</div></form></div></div></div><div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><div style="float: right; margin-left: 5px; background-color: #f9f9f9; border: 1px solid #aaaaaa; padding: 5px;"><center><strong>Contents:</strong> [<a href="#" onclick="var el = document.getElementById('toc');
        var txt = ('innerText' in el)? 'innerText' : 'textContent';
        if (el.style.display=='none') { 
           el.style.display = '';
           document.getElementById('hideLabel')[txt] = 'hide';
        }
        else {
	        el.style.display = 'none';
           document.getElementById('hideLabel')[txt] = 'show';
        }"><span id="hideLabel">hide</span></a>]</b></center><div id="toc" ><ol class="toc">
<li class="toc"><a href="#Overview">Overview</a></li>
<li class="toc"><a href="#Case_Functions">Case Functions</a></li>
<ol class="toc">
<li class="toc"><a href="#PMFCancelCase.28.29">PMFCancelCase()</a></li>
<li class="toc"><a href="#PMFCaseLink_function">PMFCaseLink()</a></li>
<ol class="toc">
<li class="toc"><a href="#Different_uses_of_Direct_Case_Link">Different uses of Direct Case Link</a></li>
<li class="toc"><a href="#Example_in_a_Trigger">Example in a Trigger</a></li>
<li class="toc"><a href="#Open_the_case_using_URL">Open the case using the URL</a></li>
<li class="toc"><a href="#Permissions_and_Considerations">Permissions and Considerations</a></li>
<ol class="toc">
<li class="toc"><a href="#ProcessMaker_Active_Session">ProcessMaker Active Session</a></li>
<li class="toc"><a href="#Case_Status_and_User_Permissions">Case Status and User Permissions</a></li>
<li class="toc"><a href="#Other_considerations">Other considerations</a></li>
</ol>
</ol>
<li class="toc"><a href="#PMFCaseList.28.29">PMFCaseList()</a></li>
<li class="toc"><a href="#PMFDeleteCase.28.29">PMFDeleteCase()</a></li>
<li class="toc"><a href="#PMFNewCase.28.29">PMFNewCase()</a></li>
<li class="toc"><a href="#PMFNewCaseImpersonate.28.29">PMFNewCaseImpersonate()</a></li>
<li class="toc"><a href="#PMFPauseCase.28.29">PMFPauseCase()</a></li>
<li class="toc"><a href="#PMFSendVariables.28.29">PMFSendVariables()</a></li>
<li class="toc"><a href="#PMFTaskCase.28.29">PMFTaskCase()</a></li>
<li class="toc"><a href="#PMFUnCancelCase.28.29">PMFUnCancelCase()</a></li>
<li class="toc"><a href="#PMFUnpauseCase.28.29">PMFUnpauseCase()</a></li>
<li class="toc"><a href="#setCaseTrackerCode.28.29">setCaseTrackerCode()</a></li>
</ol>
<li class="toc"><a href="#Case_Notes_Functions">Case Notes Functions</a></li>
<ol class="toc">
<li class="toc"><a href="#PMFAddCaseNote.28.29">PMFAddCaseNote()</a></li>
<li class="toc"><a href="#PMFGetCaseNotes.28.29">PMFGetCaseNotes()</a></li>
<ol class="toc">
<li class="toc"><a href="#Showing_Case_Notes_in_a_Grid">Showing Case Notes in a Grid</a></li>
<li class="toc"><a href="#Showing_Case_Notes_in_a_Textbox">Showing Case Notes in a Textbox</a></li>
</ol>
</ol>
<li class="toc"><a href="#Case_Routing_Functions">Case Routing Functions</a></li>
<ol class="toc">
<li class="toc"><a href="#jumping.28.29">jumping()</a></li>
<li class="toc"><a href="#PMFDerivateCase.28.29">PMFDerivateCase()</a></li>
<li class="toc"><a href="#PMFGetNextAssignedUser.28.29">PMFGetNextAssignedUser()</a></li>
<li class="toc"><a href="#PMFGetNextDerivationInfo.28.29">PMFGetNextDerivationInfo()</a></li>
<li class="toc"><a href="#PMFRedirectToStep.28.29">PMFRedirectToStep()</a></li>
</ol>
<li class="toc"><a href="#Database_Functions">Database Functions</a></li>
<ol class="toc">
<li class="toc"><a href="#executeQuery.28.29">executeQuery()</a></li>
</ol>
<li class="toc"><a href="#Date_Functions">Date Functions</a></li>
<ol class="toc">
<li class="toc"><a href="#formatDate.28.29">formatDate()</a></li>
<li class="toc"><a href="#getCurrentDate.28.29">getCurrentDate()</a></li>
<li class="toc"><a href="#getCurrentTime.28.29">getCurrentTime()</a></li>
<li class="toc"><a href="#literalDate.28.29">literalDate()</a></li>
</ol>
<li class="toc"><a href="#Document_Functions">Document Functions</a></li>
<ol class="toc">
<li class="toc"><a href="#PMFAddInputDocument.28.29">PMFAddInputDocument()</a></li>
<li class="toc"><a href="#PMFAssociateUploadedFilesWithInputFile.28.29">PMFAssociateUploadedFilesWithInputFile()</a></li>
<li class="toc"><a href="#PMFCopyDocumentCase.28.29">PMFCopyDocumentCase()</a></li>
<li class="toc"><a href="#PMFGenerateOutputDocument.28.29">PMFGenerateOutputDocument()</a></li>
</ol>
<li class="toc"><a href="#Dynaform_and_Field_Functions">Dynaform and Field Functions</a></li>
<ol class="toc">
<li class="toc"><a href="#PMFDynaFormFields.28.29">PMFDynaFormFields()</a></li>
<li class="toc"><a href="#PMFGetDynaformUID.28.29">PMFGetDynaformUID()</a></li>
<li class="toc"><a href="#PMFgetLabelOption.28.29">PMFgetLabelOption()</a></li>
<li class="toc"><a href="#PMFRemoveMask.28.29">PMFRemoveMask()</a></li>
</ol>
<li class="toc"><a href="#Email_Functions">Email Functions</a></li>
<ol class="toc">
<li class="toc"><a href="#getEmailConfiguration.28.29">getEmailConfiguration()</a></li>
<li class="toc"><a href="#PMFAddAttachmentToArray.28.29">PMFAddAttachmentToArray()</a></li>
<li class="toc"><a href="#PMFGetUserEmailAddress.28.29">PMFGetUserEmailAddress()</a></li>
<li class="toc"><a href="#PMFSendMessage.28.29">PMFSendMessage()</a></li>
<li class="toc"><a href="#PMFSendMessageToGroup.28.29">PMFSendMessageToGroup()</a></li>
</ol>
<li class="toc"><a href="#Grid_Functions">Grid Functions</a></li>
<ol class="toc">
<li class="toc"><a href="#evaluateFunction.28.29">evaluateFunction()</a></li>
<li class="toc"><a href="#orderGrid.28.29">orderGrid()</a></li>
</ol>
<li class="toc"><a href="#Group_Functions">Group Functions</a></li>
<ol class="toc">
<li class="toc"><a href="#PMFAssignUserToGroup.28.29">PMFAssignUserToGroup()</a></li>
<li class="toc"><a href="#PMFGetGroupName.28.29">PMFGetGroupName()</a></li>
<li class="toc"><a href="#PMFGetGroupUID.28.29">PMFGetGroupUID()</a></li>
<li class="toc"><a href="#PMFGetGroupUsers.28.29">PMFGetGroupUsers()</a></li>
<li class="toc"><a href="#PMFGroupList.28.29">PMFGroupList()</a></li>
<li class="toc"><a href="#PMFRemoveUsersFromGroup.28.29">PMFRemoveUsersFromGroup()</a></li>
</ol>
<li class="toc"><a href="#Process_Functions">Process Functions</a></li>
<ol class="toc">
<li class="toc"><a href="#PMFGetProcessUidByName.28.29">PMFGetProcessUidByName()</a></li>
<li class="toc"><a href="#PMFProcessList.28.29">PMFProcessList()</a></li>
</ol>
<li class="toc"><a href="#String_Functions">String Functions</a></li>
<ol class="toc">
<li class="toc"><a href="#capitalize.28.29">capitalize()</a></li>
<li class="toc"><a href="#lowerCase.28.29">lowerCase()</a></li>
<li class="toc"><a href="#upperCase.28.29">upperCase()</a></li>
</ol>
<li class="toc"><a href="#Task_Functions">Task Functions</a></li>
<ol class="toc">
<li class="toc"><a href="#PMFAddUserGroupToTask.28.29">PMFAddUserGroupToTask()</a></li>
<li class="toc"><a href="#PMFGetTaskName.28.29">PMFGetTaskName()</a></li>
<li class="toc"><a href="#PMFGetTaskUID.28.29">PMFGetTaskUID()</a></li>
<li class="toc"><a href="#PMFRemoveUserGroupFromTask.28.29">PMFRemoveUserGroupFromTask()</a></li>
<li class="toc"><a href="#PMFTaskList.28.29">PMFTaskList()</a></li>
<li class="toc"><a href="#PMFTasksListByProcessId.28.29">PMFTasksListByProcessId()</a></li>
</ol>
<li class="toc"><a href="#Unique_ID_Functions">Unique ID Functions</a></li>
<ol class="toc">
<li class="toc"><a href="#generateCode.28.29">generateCode()</a></li>
<li class="toc"><a href="#PMFGeti18nText">PMFGeti18nText()</a></li>
<li class="toc"><a href="#PMFGetUidFromText">PMFGetUidFromText()</a></li>
</ol>
<li class="toc"><a href="#User_Functions">User Functions</a></li>
<ol class="toc">
<li class="toc"><a href="#PMFCreateUser.28.29">PMFCreateUser()</a></li>
<li class="toc"><a href="#PMFInformationUser.28.29">PMFInformationUser()</a></li>
<li class="toc"><a href="#PMFRoleList.28.29">PMFRoleList()</a></li>
<li class="toc"><a href="#PMFUpdateUser.28.29">PMFUpdateUser()</a></li>
<li class="toc"><a href="#PMFUserList.28.29">PMFUserList()</a></li>
<li class="toc"><a href="#userInfo.28.29">userInfo()</a></li>
</ol>
</div></div>


<h2><span id="Overview">Overview</span></h2>
<p>ProcessMaker has made a number of its PHP functions available to be used in <a href="Triggers.html" title="Triggers">triggers</a> and <a href="Using_Conditions.html" title="Using Conditions">conditions</a>. These functions are defined in the file <strong><tt>workflow/engine/classes/class.pmFunctions.php</tt></strong>. Many of these functions are wrappers for internal class methods used by ProcessMaker or in <a href="#Gulliver_Functions">Gulliver</a>, which is the development framework used by ProcessMaker.<!-- To call ProcessMaker's internal functions and classes in triggers and plugins, see <a href="/3.0/Internal_Functions_and_Classes" title="Internal Functions and Classes">Internal Functions and Classes</a>.--></p>

<p>ProcessMaker Functions are generally named <code>PMF...()</code> and are designed to work with ProcessMaker from inside a trigger. These functions can be executed by user who is currently logged-in and running the case, as long as they have the correct permissions. If it is necessary to execute these functions as a different user, use the corresponding <a href="../3.0/ProcessMaker_WSDL_Web_Services.html" title="ProcessMaker WSDL Web Services">WSDL Web Services</a> or <a href="../3.0/Calling_REST_Endpoints.html">REST endpoints</a>.</p>

<!-- CASE Functions -->
<h2><span id="Case_Functions">Case Functions</span></h2>

<h3><span id="PMFCancelCase.28.29">PMFCancelCase()</span></h3>
<p><code>PMFCancelCase()</code> cancels a specified case in "TO DO" status. A <a href="../3.0/Cases.html#Cancel"> canceled case</a> can be reviewed in the Participated tray. Use <a href="#PMFDeleteCase.28.29">PMFDeleteCase</a> for cases in "DRAFT" status that cannot be canceled.</p>

<codeblock><i>int</i> <strong>PMFCancelCase</strong>(<i>string</i> caseUID, <i>int</i> delIndex, <i>string</i> userUID)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>caseUID</strong>: The unique ID of the case, which can be found in the following ways:
<ul><li>Use the <code>@@APPLICATION</code> system variable to get the unique ID of the current case.</li>
    <li>Use the <a href="#PMFCaseList.28.29">PMFCaseList()</a>, <a href="../index.php/Simple_Trigger_Web_Services.html#WSCaseList" title="Simple Trigger Web Services">WSCaseList()</a> or the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#caseList.28.29" title="3.0/ProcessMaker WSDL Web Services">caseList()</a> web service.</li></ul>
</li>
<li><i>int</i> <strong>delIndex</strong>: The delegation index of the current task in the case. For the current case, use the <code>@%INDEX</code> system variable.</li>
<li><i>string</i> <strong>userUID</strong>: The unique ID of the user who will cancel the case. For the currently logged-in user, use the <code>@@USER_LOGGED</code> system variable.</li></ul>
<p><strong>Return value:</strong></p>
<ul>
        <li>Returns <tt>1</tt> if the case was successfully canceled.</li>
        <li>Returns <tt>0</tt> if the case is in "DRAFT" status.</li>
</ul>
<p><strong>Example:</strong></p>
<p>The following trigger code cancels the current case and uses the die() function to prevent the next step from being executed:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span><span style="color: #b1b100;">return</span> <span style="color: #339933;">=</span> PMFCancelCase<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #339933;">@%</span>INDEX<span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span><span style="color: #b1b100;">return</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #b1b100;">print</span> <span style="color: #0000ff;">&quot;Case cancelled.&quot;</span><br />
<span style="color: #009900;">&#125;</span><br />
<a href="http://php.net/die"><span style="color: #990000;">die</span></a><span style="color: #339933;">;</span></div></div>

<p><strong><font color="red">Warning:</font></strong> <font color="dimgray">Take into consideration that when using the <code>PMFCancelCase</code> function in parallel tasks, <b>ONLY the thread of the current parallel task will be canceled</b>. The rest of parallel tasks will remain open. This is a known issue that will be fixed in upcoming versions of ProcessMaker.</font></p>

<h3><span id="PMFCaseLink_function">PMFCaseLink()</span></h3>
<p>This new ProcessMaker feature makes possible to open a case inside ProcessMaker using only a link. This link can be used in <a href="Notifications.html">notifications</a>, <a href="../3.0/Templates.html">templates</a>, <a href="../3.0/Output_Documents.html">output documents</a>, <a href="../3.0/Links.html">links</a> inside Dynaforms or can be defined or stored in <a href="Variables.html">variables</a>. The Direct Case Link remains unique regardless of the case status. This means that the link generated will respect the case status and open the case in the corresponding task.</p>

<p><code>PMFCaseLink</code> function creates a case direct link.</p>

<codeblock><i>string</i> <strong>PMFCaseLink</strong> (<i>string</i> caseUID, <i>string</i> workspace, <i>string</i> language, <i>string</i> skin)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul>
<li><i>string</i> <strong>caseUID</strong>: (Required) The unique ID of the case, which can be found in the following ways:
<ul><li>Use the <code>@@APPLICATION</code> system variable to get the unique ID of the current case.</li>
<li>Use <a href="#PMFCaseList.28.29">PMFCaseList()</a>, <a href="../index.php/Simple_Trigger_Web_Services.html#WSCaseList" title="Simple Trigger Web Services">WSCaseList()</a>, or the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#caseList.28.29" title="3.0/ProcessMaker WSDL Web Services">caseList()</a> web service.</li></ul>
</li>
<li><i>string</i> <strong>workspace</strong>: (Optional) The workspace. Note that if not set the current workspace where the case is executed is selected.</li>
<li><i>string</i> <strong>language</strong>: (Optional) The language to display the case. If not set, each user will open the case in the default language configured in his/her own profile. If the user didn't define a default language or in the community edition, the default system language is selected (Admin/settings/system/default language).</li>
<li><i>string</i> <strong>skin</strong>: (Optional) The skin name. Note that if not set the default skin is selected (neoclassic). </li>
</ul>

<p><strong>Return Value</strong></p>
<p>Returns a <b>string</b> if the case link was generated succesfully. Returns <code>false</code> if an error ocurred.</p>

<p><strong>Example:</strong></p>
<codeblock>@@app_link = PMFCaseLink(@@APPLICATION, 'workflow', 'en', 'neoclassic');
</codeblock>

<p>The returned value of this example will be:<br>
<codeblock>http://192.168.51.113/sysworkflow/en/neoclassic/cases/opencase/68619581958515d1adf0bb9076920199</codeblock></p>

<h4><span id="Different_uses_of_Direct_Case_Link">Different uses of Direct Case Link</span></h4>

<p>The URL can be stored in a string, it can be used in different cases:
<ul>
    <li>Emails</li>
    <li>Templates</li>
    <li>Output Documents</li>
    <li>Variables (Defined or stored)</li>
</ul>
</p>

<h4><span id="Example_in_a_Trigger">Example in a Trigger</span></h4>
<p>In order to do the example follow these steps:</p>
<p><b>1. </b>Create a new string variable named <b>app_Link</b> to store the link.</p>
<p><img src="../sites/default/files/3.1DirectCaseLinkCreatevariable.png"></p>

<p><b>2. </b>Create a trigger named <b>Case Link</b> and place the following code:</p>

<codeblock>$link = PMFCaseLink(@@APPLICATION);
@@app_link = $link;</codeblock>
<p><img src="../sites/default/files/3.1DirectCaseLinkCreateTrigger.png"></p>

<p><b>3. </b>Place the trigger <i>before Dynaform</i> in the first step of the first task to generate the Direct Case Link.</p>
<p><img src="../sites/default/files/3.1DirectCaseLinkTriggerPlace.png"></p>

<p><b>4. </b>Create a notification on the First task, to notify the next assigned user(s) by email.</p>
<p><img src="../sites/default/files/3.1DirectCaseLinkNotification.png"></p>

<p><b>5. </b>When running a new case, after the first task is routed, an email containing the Direct Case Link will be send to all the users assigned to the next task.</p>
<p><img src="../sites/default/files/3.1DirectCaseLinkEmailNotification.png"></p>

<h4><span id="Open_the_case_using_URL">Open the case using the URL</span></h4>
<p>Open the case in your favorite browser using the generated Direct Case Link. This link opens the ProcessMaker interface including the main menu and the cases list menu (inbox, draft, etc.). The defined case will be displayed in the central area.</p>

<p><img src="../sites/default/files/3.1DirectCaseLinkRedirected.png"></p>

<h4><span id="Permissions_and_Considerations">Permissions and Considerations</span></h4>

<h5><span id="ProcessMaker_Active_Session">ProcessMaker Active Session</span></h5>
<p>To open the case of the link, the user needs to be logged in into ProcessMaker. Therefore, take into consideration the following:</p>

<ul>
<li><b>Case opened in a new tab: </b> If the link is open inside a browser with an active ProcessMaker session, then the case will be opened in a new tab. An active session means that the user logged in using the ProcessMaker login screen or the configured SSO.
</li>
<li><b>The user is not logged in: </b> If the user is not logged in into Processmaker, then the Processmaker login page or the Single Sign On Login page is displayed.
<p><img src="../sites/default/files/3.1DirectCaseLinkNotLogged.png"></p>
</li>
</ul>

<p>Once logged in, ProcessMaker will be automatically redirected to the case.</p>

<h5><span id="Case_Status_and_User_Permissions">Case Status and User Permissions</span></h5>
<p>Since the same Direct Case Link can be used to open the case for the current assigned user, the supervisor or another user that participated in the case. ProcessMaker is going to display the case information depending on the user's permissions and case status. The possible situations opening the case are describe as follows:</p>

<ul>
<li><b>The user is not participating in the case: </b> If the user doesn't participate in the case and donâ€™t have specific process permissions, the generic case information is displayed.
<p><img src="../sites/default/files/3.1DirectCaseLinkNotParticipated.png"></p>
</li>

<li><b>The user participated in the case and is assigned to a task: </b> If the user is currently assigned to a task, then is automatically redirected to the specific task of the case.
<p><img src="../sites/default/files/3.1DirectCaseLinkRedirected.png"></p>
</li>

<li><b>The user participated in the case but is not currently assigned to the current task/step: </b>
If the user participates in the case and is not assigned to a task or the case is completed, paused, or deleted then the summary form of the case is displayed.

<p><img src="../sites/default/files/3.1DirectCaseLinkNotAssigned.png"></p>
</li>

<li><b>The user participated in the case and is assigned to more than one task: </b> If the user has more than one task of the same case in his inbox, the inbox cases list is display, and the inbox is filtered by the case number, in orden to show all the parallel tasks assigned to the user in the same case and the user must select the task to open.

<p><img src="../sites/default/files/3.1DirectCaseLinkMoreTasks.png"></p>
</li>

</ul>

<h5><span id="Other_considerations">Other considerations</span></h5>
<p>Take into consideration the following additional considerations:</p>
<ul>
<li>A Direct Case Link can be generated with different language, skin or even workspace to the one in which was generated.</li>

<li>If the language parameter was set, the user that receives the Direct Case Link, will open ProcessMaker in the language defined in the link regardless of his profile language.</li>
</ul>

<h3><span id="PMFCaseList.28.29">PMFCaseList()</span></h3>
<p><code>PMFCaseList()</code> returns a list of the pending cases (i.e., cases that have a status of "To Do" or "Draft") belonging to a specified user. Note that the specified user must be designated to work on the current task of these cases.</p>

<codeblock><i>array</i> <strong>PMFCaseList</strong>(<i>string</i> userUID)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>userUID</strong>: The unique ID of a user who is assigned to work on the cases.</li></ul>
<p><strong>Return Value:</strong></p>
<p>A list of cases, with the following structure:</p>

<codeblock>[0] <i>array</i>
(
    <i>associative array</i>
    (
        [<i>string</i> guid]
        [<i>string</i> name]
        [<i>string</i> status]
        [<i>int</i> delIndex]
    )
)
...
</codeblock>

<p><strong>Where:</strong></p>
<ul><li><i>string</i> <strong>guid</strong>: The unique ID of a case.</li>
    <li><i>string</i> <strong>name</strong>: The label of a case.</li>
    <li><i>string</i> <strong>status</strong>: The status of a case.</li>
    <li><i>int</i> <strong>delIndex</strong>: The current delegation index.</li></ul>
<p><strong>Example:</strong></p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>GRID_CASES <span style="color: #339933;">=</span> PMFCaseList<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<h3><span id="PMFDeleteCase.28.29">PMFDeleteCase()</span></h3>
<p><code>PMFDeleteCase()</code> deletes a specified case. Note that the case will be deleted completely and it will not appear in the Participated tray.
To cancel a case use <a href="#PMFCancelCase.28.29">PMFCancelCase()</a> instead of <code>PMFDeleteCase()</code>.</p>

<codeblock><i>int</i> <strong>PMFDeleteCase</strong>(<i>string</i> caseUID)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>caseUID</strong>: The unique ID of a case. For the current case use the system variable <code>@@APPLICATION</code>. Other case UIDs can be found with <a href="#PMFCaseList.28.29">PMFCaseList()</a>, <a href="../index.php/Simple_Trigger_Web_Services.html#WSCaseList" title="Simple Trigger Web Services">WSCaseList()</a>, <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#caseList.28.29" title="ProcessMaker WSDL Web Services">caseList()</a> or by querying the field <strong><tt>wf_&lt;WORKSPACE&gt;.APPLICATION.APP_UID</tt></strong>.</li></ul>
<p><strong>Return value:</strong></p>
<ul><li>Returns 1 if the case was successfully deleted, otherwise returns 0 if an error occurred.</li></ul>

<p><strong>Example:</strong></p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span><span style="color: #b1b100;">return</span> <span style="color: #339933;">=</span> PMFDeleteCase<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<a href="http://php.net/header"><span style="color: #990000;">header</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Location: casesListExtJsRedirector&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<a href="http://php.net/die"><span style="color: #990000;">die</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p>This example uses <a href="http://php.net/manual/en/function.header.php">header()</a> with <code>"Location: casesListExtJsRedirector"</code> to go back to the list of cases in the Inbox after deleting the case.</span></p>


<h3><span id="PMFNewCase.28.29">PMFNewCase()</span></h3>
<p><code>PMFNewCase()</code> creates a new case starting in the specified task.</p>

<codeblock><i>variant</i> <strong>PMFNewCase</strong>(<i>string</i> processUID, <i>string</i> userUID, <i>string</i> taskUID, <i>array</i> variables)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>processUID</strong>: The unique ID of the process, which can be found in the following ways:
<ul><li>Use the <code>@@PROCESS</code> system variable to get the unique ID of the current process.</li>
<li>Use the <a href="#PMFProcessList.28.29">PMFProcessList()</a> function or <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#processList.28.29" title="3.0/ProcessMaker WSDL Web Services">processList()</a> web service.</li>
<li>Query the <strong><tt>wf_&lt;WORKSPACE&gt;.PROCESS.PRO_UID</tt></strong> field in the database or use a query like:
<div class="geshifilter"><div class="sql geshifilter-sql" style="font-family:monospace;"><span style="color: #993333; font-weight: bold;">SELECT</span> PRO_UID <span style="color: #993333; font-weight: bold;">FROM</span> PROCESS <span style="color: #993333; font-weight: bold;">WHERE</span> PRO_TITLE <span style="color: #66cc66;">=</span> <span style="color: #ff0000;">'Expense Report Process'</span></div></div>
</li>
</ul>
</li>
</ul>

<ul><li><i>string</i> <strong>userUID</strong>: The unique ID of the user, which can be found in the following ways:
<ul><li>Use the @@USER_LOGGED system variable to get the unique ID of the user currently logged in.</li>
<li>Use the <a href="#PMFUserList.28.29">PMFUserList()</a> function or <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#userList.28.29" title="3.0/ProcessMaker WSDL Web Services">userList()</a> web service.</li>
<li>Query the <strong><tt>wf_&lt;WORKSPACE&gt;.USERS.USR_UID</tt></strong> field in the database.</li></ul>
</li>
<li><i>string</i> <strong>taskUID</strong>: The unique ID of the task, which can be found in the following ways:
<ul><li>Use the <code>@@TASK</code> system variable to get the unique ID of the current task.</li>
<li>Use the <a href="#PMFTaskList.28.29">PMFTaskList()</a> function or <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#taskList.28.29" title="3.0/ProcessMaker WSDL Web Services">taskList()</a> web service.</li>
<li>Query the <strong><tt>wf_&lt;WORKSPACE&gt;.TASK.TAS_UID</tt></strong> field in the database or get the starting task of the current process with the following query:
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT TAS_UID FROM TASK WHERE PRO_UID='&quot;</span> <span style="color: #339933;">.</span> <span style="color: #339933;">@@</span>PROCESS <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;' AND TAS_START='TRUE'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
</li>
</ul>
</li>
</ul>

<ul>
    <li><i>array</i> <strong>variables</strong>: An associative array of the variables that will be sent to the case. The keys are the variable names and the values are the values of the case variables. If the case variable is a grid, then set the value to an associative array of associative arrays. See Example 3 below. If no variables are needed, then set to an empty array: <span class="kw3" style="color: rgb(153, 0, 0);">array</span>(</span>)</span></span></li></ul>
<p><strong>Return Value:</strong></p>
<p>If an error occurred, it returns zero. Otherwise, it returns a string with the case UID of the new case.</p>

<p><font color=green><b>Note:</b></font> <font color=dimgrey>The status of the new case will automatically be set to <code>"DRAFT"</code>. To change the status so the new case will appear in the user's <b>Inbox</b> (instead of the <b>Draft</b> box), see <a href="../3.0/Trigger_Examples.html#Changing_Case_Status_to_TO_DO">Create new case and change its status</a>.</font></p>

<p><strong>Example 1:</strong><br>Create a new case of the current process, designating the current user to work on the new case. The starting task ID is hard coded in the trigger code and no case variables are set in the new case. After creating the new case, call <code>Cases::LoadCase()</code> to find out the new case number and the name of its assigned user. Then, call the <code>G::SendMessageText()</code> function to display a message in the next screen about the new case. </p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$taskUID</span> &nbsp;<span style="color: #339933;">=</span> <span style="color: #0000ff;">'7766592404f358fb90dcdc9043579725'</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//set to the starting task's unique ID</span><br />
<span style="color: #000088;">$newCaseUID</span> <span style="color: #339933;">=</span> PMFNewCase<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>PROCESS<span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #339933;">,</span> <span style="color: #000088;">$taskUID</span><span style="color: #339933;">,</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #666666; font-style: italic;">//if a new case was created, display a message in the next screen:</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$newCaseUID</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$c</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> Cases<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$aCaseInfo</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$c</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">LoadCase</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$newCaseUID</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$msg</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'New Case #'</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$aCaseInfo</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_NUMBER'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">' is assigned to '</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$aCaseInfo</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">&quot;CURRENT_USER&quot;</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$g</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> G<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">SendMessageText</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$msg</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'INFO'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
<span style="color: #b1b100;">else</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$msg</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;Unable to create new case.&quot;</span> <span style="color: #339933;">.</span> <a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>__ERROR__<span style="color: #009900;">&#41;</span> ? <span style="color: #339933;">@@</span>__ERROR__ <span style="color: #339933;">:</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$g</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> G<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">SendMessageText</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$msg</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'ERROR'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<p><strong>Example 2:</strong><br>Look up the ID of a process named "Expense Report Process" and its starting task in the database. Then, call the <code>Derivation::getAllUsersFromAnyTask()</code> method to get an array of the users who are assigned to that starting task. Use the <a href="http://php.net/manual/en/function.rand.php">rand()</a> function to randomly choose one to assign to the new case. Set the values of case variables named "Model", "Price" and "OrderDate" in the new case.</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #666666; font-style: italic;">//Look up the process UID</span><br />
<span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT PRO_UID FROM PROCESS WHERE PRO_TITLE = 'Expense Report Process'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$processUID</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$result</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'PRO_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #666666; font-style: italic;">//Look up the UID of the starting task for the process:</span><br />
<span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT TAS_UID FROM TASK WHERE PRO_UID='<span style="color: #006699; font-weight: bold;">$processUID</span>' AND TAS_START='TRUE'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$taskUID</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$result</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'TAS_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #666666; font-style: italic;">//Randomly choose a user from the list of assigned users for the starting task:</span><br />
<span style="color: #000088;">$d</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> Derivation<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$aUsers</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$d</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getAllUsersFromAnyTask</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$taskUID</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aUsers</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">==</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #b1b100;">throw</span> <span style="color: #000000; font-weight: bold;">new</span> Exception<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;There are no assigned users for task <span style="color: #006699; font-weight: bold;">$taskUID</span>&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
<span style="color: #000088;">$noUser</span> <span style="color: #339933;">=</span> <a href="http://php.net/rand"><span style="color: #990000;">rand</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span> <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aUsers</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">-</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$userUID</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$aUsers</span><span style="color: #009900;">&#91;</span><span style="color: #000088;">$noUser</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #666666; font-style: italic;">//Create an associative array of case variables named &quot;Model&quot;, &quot;Price&quot; and &quot;OrderDate&quot;:</span><br />
<span style="color: #000088;">$aData</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Model'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'Acme Coyote Trap'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'Price'</span> <span style="color: #339933;">=&gt;</span> <span style="color:#800080;">29.99</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'OrderDate'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'2010-12-31'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
PMFNewCase<span style="color: #009900;">&#40;</span><span style="color: #000088;">$processUID</span><span style="color: #339933;">,</span> <span style="color: #000088;">$userUID</span><span style="color: #339933;">,</span> <span style="color: #000088;">$taskUID</span><span style="color: #339933;">,</span> <span style="color: #000088;">$aData</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p><strong>Example 3:</strong><br>Start a new case, setting a grid case variable named "clientsGrid" that has the fields "firstName", "lastName" and "telephone" and has 3 rows of data:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$taskUID</span> &nbsp;<span style="color: #339933;">=</span> <span style="color: #0000ff;">'7766592404f358fb90dcdc9043579725'</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//look up the starting task's unique ID</span><br />
<span style="color: #000088;">$aGrid</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;1&quot;</span> <span style="color: #339933;">=&gt;</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;firstName&quot;</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;Greg&quot;</span><span style="color: #339933;">,</span> &nbsp;<span style="color: #0000ff;">&quot;lastName&quot;</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;Brown&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;telephone&quot;</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;471.826-4329&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;2&quot;</span> <span style="color: #339933;">=&gt;</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;firstName&quot;</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;Anne&quot;</span><span style="color: #339933;">,</span> &nbsp;<span style="color: #0000ff;">&quot;lastName&quot;</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;Smith&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;telephone&quot;</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;913.626-9518&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;3&quot;</span> <span style="color: #339933;">=&gt;</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;firstName&quot;</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;Sally&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;lastName&quot;</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;Slim&quot;</span><span style="color: #339933;">,</span> &nbsp;<span style="color: #0000ff;">&quot;telephone&quot;</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;765.652-8608&quot;</span><span style="color: #009900;">&#41;</span><br />
<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$newCaseId</span> <span style="color: #339933;">=</span> PMFNewCase<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>PROCESS<span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #339933;">,</span> <span style="color: #000088;">$taskUID</span><span style="color: #339933;">,</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;clientsGrid&quot;</span> <span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$aGrid</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<h3><span id="PMFNewCaseImpersonate.28.29">PMFNewCaseImpersonate()</span></h3>
<p><code>PMFNewCaseImpersonate()</code> creates a new case. It is similar to <a href="#PMFNewCase.28.29">PMFNewCase()</a>, but it impersonates the session variables, so it is more robust than PMFNewCase().</p>

<codeblock><i>int</i> <strong>PMFNewCaseImpersonate</strong>(<i>string</i> processUID, <i>string</i> userUID, <i>array</i> variables, <i>string</i> taskUID)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>processUID</strong>: The unique ID of the process.</li>
    <li><i>string</i> <strong>userUID</strong>: The unique ID of the user.</li>
    <li><i>array</i> <strong>variables</strong>: An associative array of the variables that will be sent to the case. The array keys are the variable names and the array values are the values of the case variables. See <a href="#PMFSendVariables.28.29">PMFSendVariables()</a> for the format of different variables in ProcessMaker. If no variables are needed, then set to an empty array: <span class="geshifilter"><code class="php geshifilter-php"><a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span></code></span></li>
    <li><i>string</i> <strong>taskUID</strong>: <i>Optional.</i> The unique ID of the task where the case will start. If the process only has <i>one</i> starting task or the user is only assigned to <i>one</i> of the starting tasks, then it is not necessary to specify the task.</li>
</ul>

<p><strong>Return Value:</strong></p>
<p>Returns <code>1</code> if new case was created successfully; otherwise, returns <code>0</code> if an error occurred.</p>

<p><font color=green><b>Note:</b></font> <font color=dimgrey> The status of the new case will automatically be set to <code>"DRAFT"</code>. To change the status so the new case will appear in the user's <b>Inbox</b> (instead of the <b>Draft</b> box), see <a href="../3.0/Trigger_Examples.html#Changing_Case_Status_to_TO_DO">Create new case and change its status</a>.</font></p>

<p><font color=green><b>Note:</b></font> <font color=dimgrey>It is possible to send file variables to new cases, but the files themselves will not be available in the new case. If users working on the new case need to access the files, then either send the files to the new case with the <a href="#PMFCopyDocumentCase.28.29">PMFCopyDocumentCase()</a> function or upload the files to the new case using the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#Uploading_Files">POST .../services/upload</a> or <a href="../3.0/REST_API_Cases.html#Upload_Input_Document:_POST_.2Fcases.2F.7Bapp_uid.7D.2Finput-document">POST .../cases/{app_uid}/input-document</a> endpoints.</font></p>

<p><strong>Example:</strong></p>
<p>The following example creates a new case in the same process and sends variables to the new case. It is possible that the user skipped a Dynaform and a variable was not set in the case, so the <a href="http://php.net/manual/en/function.isset.php">isset()</a> function is used to check whether the case variable exists, before using it.
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$aData</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><br />
&nbsp; <span style="color: #0000ff;">'orderNo'</span> &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'FL-3478'</span><span style="color: #339933;">,</span><br />
&nbsp; <span style="color: #0000ff;">'partId'</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>partOrdered<span style="color: #009900;">&#41;</span> ? <span style="color: #339933;">@@</span>partOrdered <span style="color: #339933;">:</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span><br />
&nbsp; <span style="color: #0000ff;">'quantity'</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #cc66cc;">24</span><br />
<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
PMFNewCaseImpersonate<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>PROCESS<span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #339933;">,</span> <span style="color: #000088;">$aData</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>


<h3><span id="PMFPauseCase.28.29">PMFPauseCase()</span></h3>
<p><code>PMFPauseCase()</code> pauses a specified case.</p>

<codeblock><i>int</i> <strong>PMFPauseCase</strong>(<i>string</i> caseUID, <i>int</i> delIndex, <i>string</i> userUID, <i>string</i> unpauseDate=null)
</codeblock>

<p><strong>Parameters:</strong></p>
<p>
<ul><li><i>string</i> <strong>caseUID</strong>: The unique ID of the case, which can be found in the following ways:
<ul><li>Use the <code>@@APPLICATION</code> system variable to get the unique ID of the current case.</li>
<li>Use <a href="#PMFCaseList.28.29">PMFCaseList()</a>, <a href="../index.php/Simple_Trigger_Web_Services.html#WSCaseList" title="Simple Trigger Web Services">WSCaseList()</a>, or the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#caseList.28.29" title="3.0/ProcessMaker WSDL Web Services">caseList()</a> web service.</li></ul></li>

<li><i>int</i> <strong>delIndex</strong>: The delegation index of the current task in the case. For the current case, use the system variable <code>@%INDEX</code>.</li>

<li><i>string</i> <strong>userUID</strong>: The unique ID of the user who will pause the case. Note that PMFPauseCase() allows any user to pause any case. The user's unique ID can be found in the following ways:
<ul><li>Get the UID of the currently logged-in user with the <code>@@USER_LOGGED</code> system variable or <code>$_SESSION['USER_LOGGED']</code>.</li>

<li>Use the <a href="#PMFUserList.28.29">PMFUserList()</a> or <a href="../index.php/Simple_Trigger_Web_Services.html#WSUserList" title="Simple Trigger Web Services">WSUserList()</a> functions, or the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#userList.28.29" title="ProcessMaker WSDL Web Services">userList()</a> web service.</li>

<li>Query the <strong><tt>wf_&lt;WORKSPACE&gt;.USERS.USR_UID</tt></strong> field in the database with <a href="#executeQuery.28.29">executeQuery()</a>.</li></ul></li>

<li><i>string</i> <strong>unpauseDate</strong>: <i>Optional.</i> The datetime in the format <code>"YYYY-MM-DD HH:MM:SS"</code> indicates when the case will be unpaused. If set to NULL or "" (empty string), then the case will be paused indefinitely, until a user manually unpauses it. If the hours, minutes or seconds aren't included in the datetime, then they automatically set to zero. Note that the case will be automatically unpaused at the configured datetime by the <b><tt>cron.php</tt></b> script, so the server needs to <a href="Executing_cron.html">periodically execute this script</a>.  Ex: <code>"2015-12-31 17:59:59"</code> <i>or</i> <code>"2017-01-08"</code></li></ul>
</p>

<p><strong>Return Value:</strong></p>
<p>Returns <code>1</code> if the case is paused successfully; otherwise, returns <code>0</code> if an error occurred.</p>

<p><b>Example:</b><br>
Pause the current case. Then, call <a href="http://php.net/manual/en/function.header.php">header("Location: <i>URL</i>")</a> to redirect the web browser to the Inbox and call <a href="http://php.net/manual/en/function.die.php">die()</a> to stop the case from trying to advance to the next step.</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">PMFPauseCase<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #339933;">@%</span>INDEX<span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;2016-09-23&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<a href="http://php.net/header"><span style="color: #990000;">header</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Location: casesListExtJsRedirector&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<a href="http://php.net/die"><span style="color: #990000;">die</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
<p style="margin-left:25px"><font color=green><b>Note 1:</b></font> <font color=dimgrey>If calling <code>die()</code> in a trigger that is executed immediately <i>after</i> a Dynaform, it will prevent the form's data from being saved. Therefore, it is recommended to set this trigger to execute <i>before</i> the next step in the task (or <i>before assignment</i> if the last step in the task), so that the form's data will be saved.</font></p>
<p style="margin-left:25px"><strong><font color="green">Note 2:</font></strong> <font color="dimgray">A case that is currently being executed cannot be paused by using the <code>PMFPauseCase()</code> function inside a script task.</font></p>
<p><font color=green><b>Note 3:</b></font> <font color=dimgrey>If the <code>$caseUID</code> is set to the ID of the current case and the <code>$delIndex</code> is set to the delegation index of the current task, then <code>PMFPauseCase()</code> will call <code>die()</code> to prevent the current case from advancing. This means that any code after calling <code>PMFPauseCase()</code> will not be executed.</font></p>


<h3><span id="PMFSendVariables.28.29">PMFSendVariables()</span></h3>
<p><code>PMFSendVariables()</code> sends an array of case variables to a specified case in "TO_DO" status. These variables are stored in the <strong><tt>wf_&lt;WORKSPACE&gt;.APPLICATION.APP_DATA</tt></strong> field and can be displayed by any subsequent Dynaform that has field controls associated with variables of the same name.</p>

<codeblock><i>int</i> <strong>PMFSendVariables</strong>(<i>string</i> caseUID, <i>array</i> variables)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>caseUID</strong>: The unique ID of the case that will receive the variable. Note that the case ID changes with each new task in the process. To send variables to the current case, use the system variable <code>@@APPLICATION</code>.</li>
    <li><i>array</i> <strong>variables</strong>: An associative array that will hold the case variables to sent to the case. The keys are the case variable names and the values are the values of the case variables.</li></ul>
<p><strong>Return Value:</strong></p>
<p>Returns 1 if the variables were sent successfully to the case; otherwise, returns 0 if an error occurred.</p>
<p><strong>Example 1:</strong></p>
<p>Send variables from a subprocess case to its parent case. The <a href="#executeQuery.28.29">executeQuery()</a> function is used to look up the case ID of the parent case in the <tt>SUB_APPLICATION</tt> table in the database. </p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$caseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span><br />
<span style="color: #000088;">$aCase</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT APP_PARENT FROM SUB_APPLICATION WHERE APP_UID='<span style="color: #006699; font-weight: bold;">$caseId</span>'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aCase</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aCase</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$aData</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'Model'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'Acme Blender #2'</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'Price'</span> <span style="color: #339933;">=&gt;</span> <span style="color:#800080;">27.40</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'OrderDate'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'2010-12-31'</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;PMFSendVariables<span style="color: #009900;">&#40;</span><span style="color: #000088;">$aCase</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_PARENT'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="color: #000088;">$aData</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<p><strong>Example 2:</strong></p>
<p>This example send variables from the current case (which is a parent case) to all its subprocess cases. It uses the <code>Cases::LoadCase()</code> function to get all the variables for the current case which are stored in the <code>['APP_DATA']</code> array key. It then <a href="http://php.net/manual/en/function.unset.php">unsets</a> the system variables in the array and sends all those variables to a new case. Note that <code>Cases::LoadCase()</code> gets the case variables which are stored in the database, so this code should not be used in a trigger <i>immediately after</i> a Dynaform, because the variables from the Dynaform have not yet been saved at that point.
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$caseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span><br />
<span style="color: #666666; font-style: italic;">//get the current case variables:</span><br />
<span style="color: #000088;">$c</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> Cases<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$aCase</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$c</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">LoadCase</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$caseId</span><span style="color: #339933;">,</span> <span style="color: #339933;">@%</span>INDEX<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$aVars</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$aCase</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_DATA'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<span style="color: #666666; font-style: italic;">//unset the system variables:</span><br />
<span style="color: #000088;">$aSystemVars</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'SYS_SYS'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'SYS_LANG'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'SYS_SKIN'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'PROCESS'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'TASK'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'APPLICATION'</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp;<span style="color: #0000ff;">'INDEX'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'APP_NUMBER'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'USER_LOGGED'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'USR_USERNAME'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'PIN'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$aSystemVars</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$var</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <a href="http://php.net/unset"><span style="color: #990000;">unset</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aVars</span><span style="color: #009900;">&#91;</span><span style="color: #000088;">$var</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
<span style="color: #666666; font-style: italic;">//lookup the subprocess cases in the SUB_APPLICATION table:</span><br />
<span style="color: #000088;">$aSubcases</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT APP_UID FROM SUB_APPLICATION WHERE APP_PARENT='<span style="color: #006699; font-weight: bold;">$caseId</span>'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$aSubcases</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$aSubcase</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;PMFSendVariables<span style="color: #009900;">&#40;</span><span style="color: #000088;">$aSubcase</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="color: #000088;">$aVars</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<p><strong>Example 3:</strong></p>
<p>This example shows how to send different types of variables to a case. Note that it is not necessary to send the label variables (<code>@@<i>variable</i>_label</code>) for textboxes, textareas and hidden controls, because they have the same value as the normal variable (<code>@@<i>variable</i></code>). Grids don't have a label variable.
<p>File controls have a label variable which holds the filename of the uploaded file in a JSON string. In version 3.0.1.18 and later, file controls also have a normal variable which holds the ID for the uploaded file in a JSON string, but this variable is not created if no file is uploaded, so it is necessary to use <a href="http://php.net/manual/en/function.isset.php">isset()</a> to check whether the variable exists before trying to pass it to another case. With the file's ID it is possible to look up information about the file using the <code>AppDocument::Load()</code> function or use <a href="#executeQuery.28.29">executeQuery()</a> to do a database search in the <tt>APP_DOCUMENT</tt> table. However, if users working in the new case need to access the file, then either send the files to the new case with the <a href="#PMFCopyDocumentCase.28.29">PMFCopyDocumentCase()</a> function or upload the files to the new case using the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#Uploading_Files">POST .../services/upload</a> or <a href="../3.0/REST_API_Cases.html#Upload_Input_Document:_POST_.2Fcases.2F.7Bapp_uid.7D.2Finput-document">POST .../cases/{app_uid}/input-document</a> endpoints.</font></p></p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$aData</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><br />
&nbsp; <span style="color: #0000ff;">'orderNo'</span> &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'FL-3478'</span><span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//string</span><br />
&nbsp; <span style="color: #0000ff;">'partId'</span> &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #339933;">@@</span>partOrdered<span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//string variable for textbox, textarea, dropdown, suggest, radio or hidden</span><br />
&nbsp; <span style="color: #0000ff;">'quantity'</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #cc66cc;">24</span><span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//integer</span><br />
&nbsp; <span style="color: #0000ff;">'daysToShip'</span> &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #339933;">@%</span>daysToShip<span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//integer variable for textbox, textarea, dropdown, radio or hidden</span><br />
&nbsp; <span style="color: #0000ff;">'taxRate'</span> &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color:#800080;">0.055</span><span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//float (real number)</span><br />
&nbsp; <span style="color: #0000ff;">'price'</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #339933;">@</span><span style="color: #666666; font-style: italic;">#partPrice, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//float variable for textbox, textarea, dropdown, radio or hidden<br />
</span><br />
&nbsp; <span style="color: #0000ff;">'orderDate'</span> &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'2017-10-30 18:03:50'</span><span style="color: #339933;">,</span><span style="color: #666666; font-style: italic;">//datetime in &quot;YYYY-MM-DD HH:MM:SS&quot; format</span><br />
&nbsp; <span style="color: #0000ff;">'orderDate_label'</span><span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'Oct 10, 2017'</span><span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//datetime according to control's format property</span><br />
&nbsp; <span style="color: #0000ff;">'shipDate'</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #339933;">@@</span>shipDate<span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//variable for datetime control</span><br />
&nbsp; <span style="color: #0000ff;">'shipDate_label'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #339933;">@@</span>shipDate_label<span style="color: #339933;">,</span> &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//label variable for datetime control</span><br />
<br />
&nbsp; <span style="color: #0000ff;">'rushOrder'</span> &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'1'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//checkbox values set by options. By default: array('1') or array('0')</span><br />
&nbsp; <span style="color: #0000ff;">'rushOrder_label'</span><span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'true'</span><span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//checkbox label set by options. By default: 'true' or 'false'</span><br />
&nbsp; <span style="color: #0000ff;">'shipByAir'</span> &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #339933;">@=</span>shipByAir<span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//variable for checkbox</span><br />
&nbsp; <span style="color: #0000ff;">'shipByAir_label'</span><span style="color: #339933;">=&gt;</span> <span style="color: #339933;">@@</span>shipByAir_label<span style="color: #339933;">,</span> &nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//label variable for checkbox</span><br />
<br />
&nbsp; <span style="color: #0000ff;">'partType'</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'engine'</span><span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//value of selected option in dropdown,suggest,radio. Values set by options</span><br />
&nbsp; <span style="color: #0000ff;">'partType_label'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'Engine component'</span><span style="color: #339933;">,</span> &nbsp; <span style="color: #666666; font-style: italic;">//label of selected option in dropdown,suggest,radio. Labels set by options</span><br />
&nbsp; <span style="color: #0000ff;">'shipType'</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #339933;">@@</span>shipType<span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//variable for dropdown,suggest,radio (can also be @%variable or @#variable)</span><br />
&nbsp; <span style="color: #0000ff;">'shipType_label'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #339933;">@@</span>shipType<span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//label variable for dropdown,suggest,radio.</span><br />
<br />
&nbsp; <span style="color: #0000ff;">'rushOrder'</span> &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'1'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//checkbox values set by options property. By default: array('1') or array('0')</span><br />
&nbsp; <span style="color: #0000ff;">'rushOrder_label'</span><span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'true'</span><span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//checkbox labels set by options property. By default: 'true' or 'false'</span><br />
&nbsp; <span style="color: #0000ff;">'shipByAir'</span> &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #339933;">@=</span>shipByAir<span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//variable for checkbox</span><br />
&nbsp; <span style="color: #0000ff;">'shipByAir_label'</span><span style="color: #339933;">=&gt;</span> <span style="color: #339933;">@@</span>shipByAir_label<span style="color: #339933;">,</span> &nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//label variable for checkbox</span><br />
<br />
&nbsp; <span style="color: #0000ff;">'services'</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'cleaning'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'accounting'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> &nbsp;<span style="color: #666666; font-style: italic;">//array of selected options in checkgroup</span><br />
&nbsp; <span style="color: #0000ff;">'services_label'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'[&quot;Janitorial&quot;,&quot;Accounting&quot;]'</span><span style="color: #339933;">,</span> &nbsp; <span style="color: #666666; font-style: italic;">//JSON string of selected labels in an array for checkgroup</span><br />
&nbsp; <span style="color: #0000ff;">'classes'</span> &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #339933;">@=</span>classes<span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//variable for checkgroup</span><br />
&nbsp; <span style="color: #0000ff;">'classes_label'</span> &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #339933;">@@</span>classes_label &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//label variable for checkgroup</span><br />
<br />
&nbsp; <span style="color: #0000ff;">'specFile'</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'[&quot;2157955725880e1bb747882058967964&quot;]'</span><span style="color: #339933;">,</span> <span style="color: #666666; font-style: italic;">//JSON string with ID of AppDocument in an array. Variable only</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//created if file selected and only in version 3.0.1.18 and later.</span><br />
&nbsp; <span style="color: #0000ff;">'specFile_label'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'[&quot;FL-3478_Specs.pdf&quot;]'</span><span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//JSON string with filename in an array</span><br />
&nbsp; <span style="color: #0000ff;">'clientDoc'</span> &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>clientDoc<span style="color: #009900;">&#41;</span> ? <span style="color: #339933;">@@</span>clientDoc <span style="color: #339933;">:</span> <span style="color: #0000ff;">'[]'</span><span style="color: #339933;">,</span><span style="color: #666666; font-style: italic;">//variable for file control, not created if no file selected</span><br />
&nbsp; <span style="color: #0000ff;">'clientDoc_label'</span><span style="color: #339933;">=&gt;</span> <span style="color: #339933;">@@</span>clientDoc_label<span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//label variable for file control</span><br />
<br />
&nbsp; <span style="color: #0000ff;">'contractFiles'</span> &nbsp;<span style="color: #339933;">=&gt;</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//multiple file control with array for each selected file</span><br />
&nbsp; &nbsp; <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'appDocUid'</span> &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'5027371035880e1a3a0de93013055939'</span><span style="color: #339933;">,</span> &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//ID of AppDocument for selected file</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'name'</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'contract17Mar2014.docx'</span><span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//filename of selected file</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'version'</span> &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'1'</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//version number of selected file (always '1')</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'appDocUid'</span> &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'1478887215880e1a3c07a36097363616'</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'name'</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'contract03Nov2017.odt'</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'version'</span> &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'1'</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#41;</span><br />
&nbsp; <span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><br />
&nbsp; <span style="color: #0000ff;">'receiptFiles'</span> &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #339933;">@=</span>receiptFiles<span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//variable for multiple file control</span><br />
<br />
&nbsp; <span style="color: #0000ff;">'clientsList'</span> &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//array of arrays for each row in grid</span><br />
&nbsp; &nbsp; &nbsp;<a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//first row, keys are the IDs of fields in grid</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'company'</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'Acme, Inc.'</span><span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//textbox</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'address'</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;234 Main St.<span style="color: #000099; font-weight: bold;">\n</span>Portland, OR 23876&quot;</span><span style="color: #339933;">,</span> <span style="color: #666666; font-style: italic;">//textarea</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'canShip'</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'1'</span><span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//checkbox values of '1' or '0' (not inside array)</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'canShip_label'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'true'</span><span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//checkbox labels of 'true' or 'false' by default</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'service'</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'landscaping'</span><span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//dropdown: selected value</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'service_label'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'Lawn Service'</span><span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//dropdown: selected label</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'endDate'</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'2018-06-01 00:00:00'</span><span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//datetime in &quot;YYYY-MM-DD HH:MM:SS&quot; format</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'endDate_label'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'June 1, 2018'</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//datetime label</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'specFile_label'</span><span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'[&quot;AcmeSpecs.pdf&quot;]'</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//file: JSON string of filename in array</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//Note that ID of AppDocument for file is not in grid</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp;<a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//second row</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'company'</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;Serious Eat'n&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'address'</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;275 Oak Av.<span style="color: #000099; font-weight: bold;">\n</span>Miami, FL 653420&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'canShip'</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'0'</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'canShip_label'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'false'</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'service'</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'catering'</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'service_label'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'Food Service'</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'endDate'</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'2020-12-31 23:59:59'</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'endDate_label'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'December 31, 2020'</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'specFile_label'</span><span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'[&quot;food_selection.pdf&quot;]'</span><br />
&nbsp; &nbsp; &nbsp;<span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//Variables for files in grid in version 3.0.1.18 and later and only created if file is selected in row:</span><br />
&nbsp; &nbsp;<span style="color: #0000ff;">'clientsList_1_specFile'</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'[&quot;9652344485880e1bbb826e5060565812&quot;]'</span><span style="color: #339933;">,</span><span style="color: #666666; font-style: italic;">//File in row 1</span><br />
&nbsp; &nbsp;<span style="color: #0000ff;">'clientsList_1_specFile_label'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'[&quot;AcmeSpecs.pdf&quot;]'</span><span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//Filename in row 1</span><br />
&nbsp; &nbsp;<span style="color: #0000ff;">'clientsList_2_specFile'</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'[&quot;2157955725880e1bb747882058967964&quot;]'</span><span style="color: #339933;">,</span><span style="color: #666666; font-style: italic;">//File in row 2</span><br />
&nbsp; &nbsp;<span style="color: #0000ff;">'clientsList_2_specFile_label'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'[&quot;food_selection.pdf&quot;]'</span><span style="color: #339933;">,</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//Filename in row 2</span><br />
<br />
&nbsp; &nbsp;<span style="color: #0000ff;">'contractsGrid'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #339933;">@=</span>contractsGrid &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//variable for grid</span><br />
<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
PMFSendVariables<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'2648391115880de3d598d26021145506'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$aData</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<h3><span id="PMFTaskCase.28.29">PMFTaskCase()</span></h3>
<p><code>PMFTaskCase()</code> returns all the tasks that have open delegations in the specified case.</p>

<codeblock><i>array</i> <strong>PMFTaskCase</strong>(<i>string</i> caseUID)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>caseUID</strong>: The unique ID of a case.</li></ul>
<p><strong>Return Value:</strong></p>
<p>A list of tasks, with the following structure:</p>

<codeblock>[0] <i>array</i>
(
   <i>associative array</i>
   (
      [<i>string</i> guid]
      [<i>string</i> name]
   )
)
...
</codeblock>

<p><strong>Where:</strong></p>
<ul><li><i>string</i> <strong>guid</strong>: The unique ID of a task.</li>
    <li><i>string</i> <strong>name</strong>: The name of a task.</li></ul>
<p><strong>Example:</strong></p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">&nbsp;<span style="color: #339933;">@@</span>pendingTasksForCase <span style="color: #339933;">=</span> PMFTaskCase<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>


<h3><span id="PMFUnCancelCase.28.29">PMFUnCancelCase()</span></h3>
<p><code>PMFUnCancelCase()</code> un-cancels a specified case. A <a href="Cases.html#Cancel">case cancelled</a> can be reviewed in the Inbox tray. Take into consideration that only roles with the <a href="Roles.html#PM_UNCANCELCASE">PM_UNCANCELCASE</a> permission will be able to uncancel a case.</p>

<codeblock><i>int</i> <strong>PMFUnCancelCase</strong>(<i>string</i> caseUID, <i>string</i> userUID)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>caseUID</strong>: The unique ID of the case, which can be found in the following ways:
<ul><li>Use the <code>@@APPLICATION</code> system variable to get the unique ID of the current case.</li>
    <li>Use the <a href="#PMFCaseList.28.29">PMFCaseList()</a>, <a href="../index.php/Simple_Trigger_Web_Services.html#WSCaseList" title="Simple Trigger Web Services">WSCaseList()</a> or the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#caseList.28.29" title="3.0/ProcessMaker WSDL Web Services">caseList()</a> web service.</li></ul>
</li>
<li><i>string</i> <strong>userUID</strong>: The unique ID of the user  who will receive the case when uncancelling the case. For the currently logged-in user, use the <code>@@USER_LOGGED</code> system variable.</li></ul>

<p><strong>Return value:</strong></p>
<ul><li>Returns 1 if the case was successfully uncancelled, otherwise returns 0 if an error occurred. If the user does not have the <a href="Roles.html#PM_UNCANCELCASE">PM_UNCANCELCASE</a> permission assigned, it will return 0.</li></ul>

<p><strong>Example:</strong></p>
<p>The following trigger code uncancels the current case and uses the die() function to prevent the next step from being executed:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span><span style="color: #b1b100;">return</span> <span style="color: #339933;">=</span> PMFUnCancelCase<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">print</span> <span style="color: #0000ff;">&quot;Case uncancelled.&quot;</span><br />
<a href="http://php.net/die"><span style="color: #990000;">die</span></a><span style="color: #339933;">;</span></div></div>

<h3><span id="PMFUnpauseCase.28.29">PMFUnpauseCase()</span></h3>
<p><code>PMFunpauseCase()</code> unpauses a specified case.</p>

<codeblock><i>int</i> <strong>PMFUnpauseCase</strong>(<i>string</i> caseUID, <i>string</i> delIndex, <i>string</i> userUID)
</codeblock>

<p><strong>Parameters:</strong></p>
<p>
<ul>
<li><i>string</i> <strong>caseUID</strong>: The unique ID of the case, which can be found in the following ways:
  <ul>
  <li>Use the <code>@@APPLICATION</code> system variable to get the unique ID of the current case.</li>
  <li>Use the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#caseList.28.29" title="3.0/ProcessMaker WSDL Web Services">caseList()</a> web service.</li>
  </ul>
  </li>

<li><i>string</i> <strong>delIndex</strong>: The delegation index of the current task in the case. For the current case, use the system variable <code>@%INDEX</code>.</li>

<li><i>string</i> <strong>userUID</strong>: The unique ID of the user who will unpause the case, which can be found in the following ways:
  <ul>
  <li>Get the UID of the currently logged-in user with the <code>@@USER_LOGGED</code> system variable or <span class="re0" style="color: rgb(0, 0, 136);">$_SESSION</span>[</span><span class="st_h" style="color: rgb(0, 0, 255);">'USER_LOGGED'</span>]</span></span>.</li>
  <li>Use the <a href="#PMFUserList.28.29">PMFUserList()</a> or <a href="../index.php/Simple_Trigger_Web_Services.html#WSUserList" title="Simple Trigger Web Services">WSUserList()</a> functions, or the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#userList.28.29" title="ProcessMaker WSDL Web Services">userList()</a> web service.</li>
  <li>Query the <strong><tt>wf_&lt;WORKSPACE&gt;.USERS.USR_UID</tt></strong> field in the database with <a href="#executeQuery.28.29">executeQuery()</a>.</li>
  </ul>
</li>
</ul>
</p>

<p><strong>Return Value:</strong></p>
<p>Returns <code>1</code> if the case is unpaused successfully; otherwise, returns <code>0</code> if an error occurred.</p>

<h3><span id="setCaseTrackerCode.28.29">setCaseTrackerCode()</span></h3>
<p><code>setCaseTrackerCode()</code> sets the code and PIN of a case, which are used when an unregistered user logs into the <a href="../3.0/Case_Tracker.html" title="Case Tracker">Case Tracker</a> to view the details of a particular case. By default, the code for a case is its case number and its PIN (public identification number) is a semi-random string of 4 characters (numbers and letters) autogenerated by ProcessMaker; however, <code>setCaseTrackerCode()</code> can set the case code and PIN to any desired values.</p>

<codeblock><i>int</i> <strong>setCaseTrackerCode</strong>(<i>string</i> caseUID, <i>string</i> code, <i>string</i> PIN = '')
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>caseUID</strong>: The unique ID of a case. For the current case use the system variable <code>@@APPLICATION</code>. Other case UIDs can be found with <a href="#PMFCaseList.28.29">PMFCaseList()</a>, <a href="../index.php/Simple_Trigger_Web_Services.html#WSCaseList" title="Simple Trigger Web Services">WSCaseList()</a>, <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#caseList.28.29" title="ProcessMaker WSDL Web Services">caseList()</a> or by querying the <strong><tt>wf_&lt;WORKSPACE&gt;.APPLICATION.APP_UID</tt></strong> field in the database.</li>
    <li><i>string</i> <strong>code</strong>: The new code of a case up to 100 characters long, which will be stored in the <strong><tt>wf_&lt;WORKSPACE&gt;.APPLICATION.APP_PROC_CODE</tt></strong> field in the database. To keep the case code as the case number, set it to @@APP_NUMBER for the case number of the current case or for another case look up its case number in the <strong><tt>wf_&lt;WORKSPACE&gt;.APPLICATION.APP_NUMBER</tt></strong> field in the database.</li>
    <li><i>string</i> <strong>PIN</strong>: <i>Optional.</i> The new PIN (personal identification number) in UPPERCASE of a case, which will be stored in the <strong><tt>wf_&lt;WORKSPACE&gt;.APPLICATION.APP_PIN</tt></strong> field as an MD5 hash and will be available in the system variable <code>@@PIN</code> for the current case. If not included or set to <code>''</code> (an empty string), then the PIN will not be changed. Note that if the PIN is not in UPPERCASE, then it will not be possible to login to the Case Tracker.</li></ul>
<p><strong>Return Value:</strong></p>
<p>If successful, returns one; otherwise returns zero or an error number.</p>
<p><strong>Example:</strong></p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">setCaseTrackerCode<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'999'</span><span style="color: #339933;">,</span> generateCode<span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">4</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'ALPHANUMERIC'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<!-- END CASE Functions -->

<!-- CASE NOTES Functions -->
<h2><span id="Case_Notes_Functions">Case Notes Functions</span></h2>

<h3><span id="PMFAddCaseNote.28.29">PMFAddCaseNote()</span></h3>

<p><code>PMFAddCaseNote()</code> adds a case note to a specified case.</p>

<codeblock><i>int</i> <strong>PMFAddCaseNote</strong>(<i>string</i> $caseUID, <i>string</i> $processUID, <i>string</i> $taskUID, <i>string</i> $userUID, <i>string</i> $note, <i>int</i> $sendMail = 1)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>caseUID</strong>: (Required) The unique ID of the case, which can be found in the following ways:
<ul><li>Use the <code>@@APPLICATION</code> system variable to get the unique ID of the current case.</li>
    <li>Use the <a href="#PMFCaseList.28.29">PMFCaseList()</a>, <a href="../index.php/Simple_Trigger_Web_Services.html#WSCaseList" title="Simple Trigger Web Services">WSCaseList()</a> or the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#caseList.28.29" title="3.0/ProcessMaker WSDL Web Services">caseList()</a> web service.</li></ul>
</li>
<li><i>string</i> <strong>processUID</strong>: (Required) The unique ID of the process, which can be found in the following ways:
<ul><li>For the current process, use the <code>@@PROCESS</code> system variable.</li>
<li>Use executeQuery() to look up the unique ID in the <strong><tt>wf_&lt;WORKSPACE&gt;.PROCESS.PRO_UID</tt></strong> field.</li></ul>
</li>
<li><i>string</i> <strong>taskUID</strong>: (Required) The unique ID of the task, which can be found in the following ways:
<ul><li>Use the <code>@@TASK</code> system variable to get the unique ID of the current task.</li>
<li>Use the <a href="#PMFTaskList.28.29">PMFTaskList()</a> function or <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#taskList.28.29" title="3.0/ProcessMaker WSDL Web Services">taskList()</a> web service.</li>
<li>Query the <strong><tt>wf_&lt;WORKSPACE&gt;.TASK.TAS_UID</tt></strong> field in the database or get the starting task of the current process with the following query:</li></ul>
</li>
</ul>
<dl>
    <dd>
        <dl>
            <dd>executeQuery("SELECT TAS_UID FROM TASK WHERE PRO_UID='"</span> <span class="sy0" style="color: rgb(51, 153, 51);">.</span>                <span class="sy0" style="color: rgb(51, 153, 51);">@@</span>PROCESS <span class="sy0" style="color: rgb(51, 153, 51);">.</span>                <span class="st0" style="color: rgb(0, 0, 255);">"' AND TAS_START='TRUE'"</span>)</span>
                </span>
            </dd>
        </dl>
    </dd>
</dl>
<ul><li><code><strong>$userUID</strong>:</code> (Required) The unique ID of the user who will add the case note. Note that it is NOT possible to include the UID of more than one user.</li>

    <li><code><strong>$note</strong>:</code> (Required) Note of the case.</li>

    <li><code><strong>$sendMail</strong>:</code> (Optional) If set to 1, will send an email to all participants in the case.</li>

</ul>
<p><strong>Return Value:</strong><br>Returns <strong>1</strong> if the note has been successfully added to the case, otherwise returns 0 if an error has occurred.</p>
<p><strong>Example:</strong></p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span><span style="color: #b1b100;">return</span> <span style="color: #339933;">=</span> PMFAddCaseNote<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>PROCESS<span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>TASK<span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #339933;">,</span> <span style="color: #0000ff;">'Completed with resolution #234'</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p><span style="color: green;"><strong>Note:</strong></span> <font color=dimgrey>It is possible to use case or system variables in the text of the case note. The following example inserts the resolution number, which is a value from a Dynaform field, into the text of the case note:</font></p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span><span style="color: #b1b100;">return</span> <span style="color: #339933;">=</span> PMFAddCaseNote<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>PROCESS<span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>TASK<span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #339933;">,</span> <span style="color: #0000ff;">'Completed with resolution #'</span> <span style="color: #339933;">.</span> <span style="color: #339933;">@@</span>NumberResolution<span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<h3><span id="PMFGetCaseNotes.28.29">PMFGetCaseNotes()</span></h3>
<p><code>PMFGetCaseNotes()</code> returns a list of the case notes posted to a specified case.</p>

<codeblock><i>array</i> <strong>PMFGetCaseNotes</strong>(<i>string</i> applicationID, <i>string</i> type = 'array', <i>string</i> userUID = '')
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>application</strong>:</code> The unique ID of a case, which can be obtained in the following ways:
<ul><li>For the current case, use the system variable <code>@@APPLICATION</code>.</li>
    <li>Use <a href="#PMFCaseList.28.29">PMFCaseList()</a>, <a href="../index.php/Simple_Trigger_Web_Services.html#WSCaseList" title="Simple Trigger Web Services">WSCaseList()</a> or the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#caseList.28.29" title="ProcessMaker WSDL Web Services">caseList()</a> web service.</li>
    <li>Use <a href="#executeQuery.28.29">executeQuery()</a> to query the <strong><tt>wf_&lt;WORKSPACE&gt;.APPLICATION.APP_UID</tt></strong> or <strong><tt>wf_&lt;WORKSPACE&gt;.APP_DELEGATION.APP_UID</tt></strong> fields in the database</li></ul>
</li>
<li><i>string</i> <strong>type</strong>:</code> <i>Optional parameter.</i> Set to <strong><code>'array'</code></strong> if the result will be displayed in a grid. Set to <strong><code>'string'</code></strong> to return a string, which can be displayed in a textarea field. The default value is <strong><code>'array'</code></strong>.</li>
<li><i>string</i> <strong>userUID</strong>:</code> <i>Optional parameter.</i> To return the case notes posted by a single user, set to the unique ID of that user. If no user ID is specified, then it will return the case notes from all users. For the currently logged-in user, use the <code>@@USER_LOGGED</code> system variable.
<p><span style="color: green;"><strong>Note:</strong></span> <span style="color: dimgrey;">It's not possible to define more than one user ID in the last parameter.</span></p>
</li></ul>
<p><strong>Return Value:</strong><br>If the <code>type</code> is set to <code>'array'</code>, then this function returns an array of associative arrays with the following structure:</p>

<codeblock>[1] <i>array</i> (
    <i>string</i> <strong>['FULL_NAME']</strong>: First name and last name of the user who created the case note.
    <i>string</i> <strong>['APP_UID']</strong>: Case UID.
    <i>string</i> <strong>['USR_UID']</strong>: User UID.
    <i>string</i> <strong>['NOTE_DATE']</strong>: The datetime when the case note was created in <code>YYYY-MM-DD HH:MM:SS</code> format.
    <i>string</i> <strong>['NOTE_CONTENT']</strong>: The content of the case note.
    <i>string</i> <strong>['NOTE_TYPE']</strong>: The type of the case note.
    <i>string</i> <strong>['NOTE_AVAILABILITY']</strong>: The type of availability of the case note.
    <i>string</i> <strong>['NOTE_RECIPIENTS']</strong>: The users who got the note by notification.
    <i>string</i> <strong>['USR_USERNAME']</strong>: The username of the user who created the case note.
)
...
</codeblock>

<p>Note that the counting of the array starts from <strong>1</strong>, not <strong>0</strong>.</p>
<p>If the <code>$type</code> is set to <code>'string'</code>, then this function returns a string that includes the name and username of the user who posted the case note, the content of the case note, and the date-time when posted:</p>

<codeblock>FIRST-NAME LAST-NAME (USERNAME) NOTE-1-CONTENT (DATE-TIME-POSTED)
FIRST-NAME LAST-NAME (USERNAME) NOTE-2-CONTENT (DATE-TIME-POSTED)
...
</codeblock>



<div style="margin-left:25px;"><font color=green><b>Note:</b></font> <font color=dimgrey>The text in <code>NOTE_CONTENT</code> is in HTML format so a string like <code>"Â¡gÃ¼Ã©ro!"</code> becomes <code>"&amp;iexcl;g&amp;uuml;&amp;eacute;ro!"</code>. This text can be displayed without problem inside a panel, but to display this text correctly inside an input field, use the <a href="http://php.net/manual/en/function.html-entity-decode.php">html_entities_decode()</a> function to convert it to the UTF-8 character set. See the examples below.</font></div>

<h4><span id="Showing_Case_Notes_in_a_Grid">Showing Case Notes in a Grid</span></h4>
<p>Create a Dynaform and inside it add a grid. When dropping the Grid element, create a new variable named gridPMFunction that is associated to the grid.</p>

<p><img src="../sites/default/files/3.0NotesGridsVariable.png"></p>

<p>Add the following controls inside the grid:
<ul>
  <li>A <a href="../3.0/Text_and_Textarea_Controls.html#Textbox_Control">Textbox</a> with id: <code>FULL_NAME</code>.</li>
  <li>A <a href="../3.0/Text_and_Textarea_Controls.html#Textbox_Control">Textbox</a> with id: <code>USR_USERNAME</code>.</li>
  <li>A <a href="../3.0/Text_and_Textarea_Controls.html#Textarea_Control">Textarea</a> with id: <code>NOTE_CONTENT</code></li>
  <li>A <a href="../3.0/Datetime_Control.html">Datetime control</a> with id: <code>NOTE_DATE</code></li>
</ul>

<p><img src="../sites/default/files/3.0NotesGridsDynaform.png"></p>

<p>Save the changes and close the Dynaform. Then, create the following custom trigger:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@=</span>gridPMFunction <span style="color: #339933;">=</span> PMFGetCaseNotes<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'array'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #b1b100;">for</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$i</span> <span style="color: #339933;">=</span> <span style="color: #cc66cc;">1</span><span style="color: #339933;">;</span> <span style="color: #000088;">$i</span> <span style="color: #339933;">&lt;=</span> <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #339933;">@=</span>gridPMFunction<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #000088;">$i</span><span style="color: #339933;">++</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #339933;">@=</span>gridPMFunction<span style="color: #009900;">&#91;</span><span style="color: #000088;">$i</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'NOTE_CONTENT'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> <a href="http://php.net/html_entity_decode"><span style="color: #990000;">html_entity_decode</span></a><span style="color: #009900;">&#40;</span><span style="color: #339933;">@=</span>gridPMFunction<span style="color: #009900;">&#91;</span><span style="color: #000088;">$i</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'NOTE_CONTENT'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #009900; font-weight: bold;">ENT_QUOTES</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'UTF-8'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<p>In this example, the case notes from all users in the current case are returned in an array which is assigned to the <code>@=gridPMFunction</code> variable which is associated with a grid in the subsequent Dynaform. Note that the last parameter of the <code>PMFGetCaseNotes()</code> function is an empty string, so it will return the case notes created by all users.</p>

<p>Then, the code loops through each element  in the <code>@=gridPMFunction</code> array and calls <code>html_entity_decode()</code> to converts the text in the <code>['NOTE_CONTENT']</code> elements from HTML to UTF-8 text. </p>

<p>Assign the above trigger to be executed <i>before</i> the Dynaform and the results will be shown in the grid:</p>

<p><img alt="" src="../sites/default/files/3.0NotesGridsCaseNotes.png"></p>

<p>In this example, the trigger was executed in the process's second task, so all case notes added in both the first and second tasks will be displayed in the grid.</p>

<h4><span id="Showing_Case_Notes_in_a_Textbox">Showing Case Notes in a Textbox</span></h4>
<p>Create a Dynaform that has <a href="../3.0/Text_and_Textarea_Controls.html#Textarea_Control">a Textarea</a> control with a variable called <code>textAreaPMFunction</code>.</p>

<p><img alt="" src="../sites/default/files/3.0NotesGridsTextAreaDynaForm.png"></p>

<p>Then create a trigger as follows:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>textAreaPMFunction <span style="color: #339933;">=</span> <a href="http://php.net/html_entity_decode"><span style="color: #990000;">html_entity_decode</span></a><span style="color: #009900;">&#40;</span> PMFGetCaseNotes<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'string'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> &nbsp;<span style="color: #009900; font-weight: bold;">ENT_QUOTES</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'UTF-8'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p>Where:</p>P
<ul>
    <li><code><strong>@@textAreaPMFunction </strong></code>: name of the textarea added to the Dynaform and where the results will be shown.</li>
    <li><code><strong>@@APPLICATION</strong></code>: UID of the current process.</li>
    <li><code><strong>string</strong></code>: the results. In the example, the results will be shown in a textarea. </li>
</ul>

<p>The last parameter is empty, so it will display all the case notes created by the users.</p>

<p>Assign the trigger before the Dynaform. The result will be:</p>

<p><img alt="" src="../sites/default/files/3.0NotesGridsTextAreaCaseNotes.png"></p>
<!-- END CASE NOTES Functions -->

<!-- CASE ROUTING Functions -->
<h2><span id="Case_Routing_Functions">Case Routing Functions</span></h2>

<h3><span id="jumping.28.29">jumping()</span></h3>
<p><code>jumping()</code> routes a case to the next task in the process (or terminates the case if at the last task in the process) and then displays the case list.</p>

<codeblock><i>void</i> <strong>jumping</strong>(<i>string</i> caseUID, <i>int</i> delegation)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>caseUID</strong>: The unique ID of the case to be routed. For the current case, use the system variable <code>@@APPLICATION</code>. For other cases, use <a href="#PMFCaseList">PMFCaseList()</a> to obtain the case UID, or do a database query to look up the case's unique ID in the field <strong><tt>wf_&lt;WORKSPACE&gt;.APPLICATION.APP_UID</tt></strong>. Note that the case's UID changes with each new task.</li>
    <li><i>int</i> <strong>delegation</strong>: The delegation index of the task to be routed. Counting starts from 1. For the current case, use the system variable <code>@%INDEX</code>. For other cases, use <a href="#PMFCaseList.28.29">PMFCase()</a> to obtain the delegation index, or do a database search in the field <strong><tt>wf_&lt;WORKSPACE&gt;.APP_DELEGATION.DEL_INDEX</tt></strong>.</li></ul>

<p><strong>Return Value:</strong></p>
<p>None.</p>

<p><strong>Example:</strong></p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">jumping<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #339933;">@%</span>INDEX<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>


<h3><span id="PMFDerivateCase.28.29">PMFDerivateCase()</span></h3>
<p>
<table border="1" cellpadding="1" cellspacing="1" style="width: 100%;">
<tbody>
<tr>
<td>
<font color="red"><b>Warning:</b></font> <font color=dimgrey> Please, take into consideration that this function is NOT supported in ProcessMaker Mobile. It will be available in future versions.</font>
</td>
</tr>
</tbody>
</table>
</p>

<p><code>PMFDerivateCase()</code> routes a case to the next task in the process.</p>

<codeblock><i>int</i> <strong>PMFDerivateCase</strong>(<i>string</i> caseUID, <i>int</i> delegation, <i>boolean</i> executeTriggersBeforeAssigment=false, <i>string</i> userUID = null)
</codeblock>

<p><strong>Parameters:</strong><br>
<ul><li><i>string</i> <strong>caseUID</strong>: The unique ID of the case to be routed, which can be found with <a href="#PMFCaseList.28.29">PMFCaseList()</a> or by querying the field <strong><tt>wf_&lt;WORKSPACE&gt;.APPLICATION.APP_UID</tt></strong>. The case UID of the current case is stored in the system variable <code>@@APPLICATION</code>.</li>
    <li><i>int</i> <strong>delegation</strong>: The delegation index of the task to be routed. The delegation index of the current case is stored in the system variable <code>@%INDEX</code>. Note that the delegation index changes with each new task in the case, so look up the index before calling this function.</li>
    <li><i>boolean</i> <strong>executeTriggersBeforeAssigment</strong>: <i>Optional parameter</i>. By default, it is set as <code>false</code>. If set to <strong><code>true</code></strong>, any triggers that are set to be fired before the case is assigned to the next user will be fired before routing the case. It is not recommended to set the value to true, because then the function will generate an infinite loop. If this value is set to <strong><code>false</code></strong> the trigger will be executed before assignment.</li>
<li><i>string</i> <b>userUID</b>: <i>Optional parameter.</i> The unique ID of the user who is assigned to the task indicated by the <code>delIndex number</code>, which should be an open task. If not included or set to <code>null</code>, then it will be set to the unique ID of the current logged-in user.</li>
</ul>
</p>
<p><strong>Return Value:</strong><br>Returns <code>1</code> if the new case was routed successfully; otherwise, returns <code>0</code> if an error occurred.</p>

<p><span style="color: green;"><strong>Note 1:</strong></span> <font color=dimgrey>If this function is called for the current task when running a case, then the case will be routed twice--once by <code>PMFDerivateCase()</code> and the second time by the interface running the case. To work around this problem, call the <a  href="http://php.net/manual/en/function.die.php">die()</a> function after <code>PMFDerivateCase()</code> to stop the processing and prevent the second routing. However, if <code>die()</code> is called after a Dynaform step, then it will stop the Dynaform data from getting saved to the database. In this case, use <a href="#PMFSendVariables.28.29">PMFSendVariables()</a> to save the data to the database before calling <code>PMFDerivateCase</code> and <code>die()</code>. See the example below.</font></p>
<p><span style="color: green;"><strong>Note 2:</strong></span> <font color=dimgrey>This function only works if the currently logged in user is assigned to the task indicated by the <code>delegation</code> parameter. If it is necessary to route a task that is assigned to another user, login as that user with web services and use <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#routeCase.28.29" title="ProcessMaker WSDL Web Services">routeCase()</a> instead of <code>PMFDerivateCase()</code>. See this <a href="../3.0/Trigger_Examples.html#Skipping_the_Next_Task_in_a_Case" title="Trigger Examples">code example</a> for routing past the next task in the current case.</font></p>
<p><span style="color: green;"><strong>Note 3:</strong></span> <font color=dimgrey>The <code>PMFDerivateCase()</code> function can only route tasks that exist in the <strong><tt>wf_&lt;WORKSPACE&gt;.APP_DELEGATION</tt></strong> table and whose status is <code>'OPEN'</code>. In other words, this function can't be called on past tasks that are already closed and future tasks that don't yet exist. To route the <i>next</i> task in the case, which doesn't yet exist, see <a href="../3.0/Trigger_Examples.html#Skipping_the_Next_Task_in_a_Case" title="Trigger Examples">Skipping the Next Task in a Case</a>.</font></p>

<p><strong>Example 1:</strong><br>
Route the current case to the next task in the process and redirect the web browser back to <b>Home > Inbox</b> to see the case list:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">PMFDerivateCase<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #339933;">@%</span>INDEX<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<a href="http://php.net/header"><span style="color: #990000;">header</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Location: casesListExtJsRedirector&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<a href="http://php.net/die"><span style="color: #990000;">die</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p><strong>Example 2:</strong><br>
To route to a case immediately <i>after</i> a Dynaform step, the data from the Dynaform variables needs to be stored in the database with <code>PMFSendVariables()</code> before calling <code>die()</code>. For example, the Dynaform contains the variables "firstName", "lastName", "address" and "telephone", which need to be saved.</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$aVars</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;firstName&quot;</span> <span style="color: #339933;">=&gt;</span> <span style="color: #339933;">@@</span>firstName<span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;lastName&quot;</span> &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #339933;">@@</span>lastName<span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;address&quot;</span> &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #339933;">@@</span>address<span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;telephone&quot;</span> <span style="color: #339933;">=&gt;</span> <span style="color: #339933;">@@</span>telephone<br />
<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
PMFSendVariables<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #000088;">$aVars</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
PMFDerivateCase<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #339933;">@%</span>INDEX<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<a href="http://php.net/header"><span style="color: #990000;">header</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Location: casesListExtJsRedirector&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<a href="http://php.net/die"><span style="color: #990000;">die</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p><font color=green><b>Note:</b></font> <font color=dimgrey>If the trigger is set <i>before</i> the next step (or before assignment if the last step in the task), then it is not necessary to call PMFSendVariables() because the variables from the Dynaform will have already been saved to the database.</font></p>

<p><strong>Example 3:</strong><br>
To avoid having to click on the <b>Continue</b> button at the end of a task, create the following trigger, which is set <i>before assignment</i>:
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">PMFDerivateCase<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #339933;">@%</span>INDEX<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
<p>If the next task is assigned to the same user as the current task, then it can be opened directly without going to the Inbox. Create the following trigger and set it to execute <i>after routing</i>:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$caseUID</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span><br />
<span style="color: #000088;">$nextIndex</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@%</span>INDEX <span style="color: #339933;">+</span> <span style="color: #cc66cc;">1</span><span style="color: #339933;">;</span><br />
<a href="http://php.net/header"><span style="color: #990000;">header</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Location:cases_Open?APP_UID=<span style="color: #006699; font-weight: bold;">$caseUID</span>&amp;DEL_INDEX=<span style="color: #006699; font-weight: bold;">$nextIndex</span>&amp;action=draft&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<a href="http://php.net/die"><span style="color: #990000;">die</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<h3><span id="PMFGetNextAssignedUser.28.29">PMFGetNextAssignedUser()</span></h3>
<p><code>PMFGetNextAssignedUser()</code> returns an array of information about the user designated (i.e., chosen out of the assignment pool) to work on the <i>next</i> task in a specified case.</p>

<codeblock><i>array</i> <strong>PMFGetNextAssignedUser</strong>(<i>string</i> application, <i>string</i> task, <i>int</i> delIndex,  <i>string</i> userUID)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>application</strong>:</code> The unique ID of a case. For the current case, use the system variable <code>@@APPLICATION</code>. For other cases, use the <a href="#PMFCaseList.28.29">PMFCaseList()</a> function or <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#caseList.28.29" title="ProcessMaker WSDL Web Services">caseList()</a> web service. Alternatively, query the <strong><tt>wf_&lt;WORKSPACE&gt;.APPLICATION.APP_UID</tt></strong> or <strong><tt>wf_&lt;WORKSPACE&gt;.APP_DELEGATION.APP_UID</tt></strong> fields in the database</li>
    <li><i>string</i> <strong>task</strong>:</code> The unique ID of the task, which can be found by right clicking on the task in the process map and selecting <b>Properties</b> in the context menu. It can also be found with the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#Task_List" title="ProcessMaker WSDL Web Services">taskList()</a> web service or by querying the <strong><tt>wf_&lt;WORKSPACE&gt;.TASK.TAS_UID</tt></strong> field in the database.</li>
    <li><i>int</i> <strong>delIndex</strong>:</code> <i>Optional.</i> The delegation index of the current task in the case. It is only necessary to set this parameter if calling this function in a script task or if not calling this function for the current case.
<li><i>string</i> <strong>userUID</strong>:</code> <i>Optional.</i> The unique ID of the user assigned to the case. It is only necessary to set this parameter if calling this function in a script task or if not calling this function for the current case.
</ul>
<p><strong>Return Value:</strong><br>An associative array of information about the user to be designated to work on the next task in the specified case, with the following elements:</p>
<ul><li><i>string</i> 'USR_UID':</code> The unique ID of the next assigned user.</li>
    <li><i>string</i> 'USR_USERNAME':</code> The username of the next assigned user.</li>
    <li><i>string</i> 'USR_FIRSTNAME':</code> The first name of the next assigned user.</li>
    <li><i>string</i> 'USR_LASTNAME':</code> The last name of the next assigned user.</li>
    <li><i>string</i> 'USR_EMAIL':</code> The email address of the next assigned user.</li>
</ul>

<p style="margin-left:25px"><strong><font color="red">Warning:</font></strong> <font color="dimgray"> This function only works reliably if called in certain circumstances; otherwise, it is recommended to get the next designated user by querying the <strong><tt>wf_&lt;WORKSPACE&gt;.APP_DELEGATION.USR_UID</tt></strong> field in the database in a trigger fired <i>after routing</i>. See this <a href="Notifications.html#For_Next_Tasks_with_Any_Type_of_Designation_Rule" title="Notifications">email example</a> and this <a href="../3.0/Trigger_Examples.html#Skipping_the_Next_Task_in_a_Case" title="Trigger Examples">routing example</a>.</font></p>

<p>This function should <i>only</i> be used when the next task in the process has <a href="Processes.html#Cyclical_Assignment" title="Processes">cyclical assignment</a>, since this function checks who was the last user designated to work on the next task (which is stored in the <strong><tt>wf_&lt;WORKSPACE&gt;.TASK.TAS_LAST_ASSIGNED</tt></strong> field in the database) and then returns the next user in the list. That next user will be assigned to the next case that routes to the task; however, the next case may not be the case specified by the <code>$application</code> parameter. Therefore, it is recommended to use this function in processes that do NOT have multiple cases being executed at the same time. If the process might execute multiple simultaneous cases, then only call this function in a trigger that fires <i>before assignment</i>.</p>

<p style="margin-left:25px"><font color=green><b>Note:</b></font> <font color=dimgrey>If this function is not called for the next task in the specified case, meaning that the $task is not the next task in the case, then the following error message will be displayed:<br>
<code>Fatal error: Call to a member function getTaskUid() on null in <i>/opt/processmaker</i>/workflow/engine/classes/class.case.php on line 2351</code></font></p>

<p><strong>Example 1:</strong><br>
Send an email to the user designated to the next task in the current case, warning him/her about an upcoming case to work on. Send the first and last names of the next user as the variables <code>@#firstname</code> and <code>@#lastname</code> to insert into the email template:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$taskUID</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'1220028735824ce9181a724086456364'</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//set to task ID</span><br />
<span style="color: #000088;">$aUser</span> <span style="color: #339933;">=</span> PMFGetNextAssignedUser<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #000088;">$taskUID</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$aVars</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'firstname'</span><span style="color: #339933;">=&gt;</span><span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_FIRSTNAME'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'lastname'</span><span style="color: #339933;">=&gt;</span><span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_LASTNAME'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'boss@example.com'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_EMAIL'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp;<span style="color: #0000ff;">'Upcoming case to work on'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'upcomingCase.html'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$aVars</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p><strong>Example 2:</strong><br>
In a script task, send out an email to the user designated to the next task in the current case, warning him/her about an upcoming case to work on. Because it is a script task, it is necessary to set the delegation index of the current task and the UID of the user. Since the @%INDEX in script tasks is stuck in the number from the last normal task, 1 needs to be added to get the index for the current task.</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$taskUID</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'1220028735824ce9181a724086456364'</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//set to task ID</span><br />
<span style="color: #000088;">$aUser</span> <span style="color: #339933;">=</span> PMFGetNextAssignedUser<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #000088;">$taskUID</span><span style="color: #339933;">,</span> <span style="color: #339933;">@%</span>INDEX <span style="color: #339933;">+</span> <span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'boss@example.com'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_EMAIL'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp;<span style="color: #0000ff;">'Upcoming case to work on'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'upcomingCase.html'</span><span style="color: #339933;">,</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<h3><span id="PMFGetNextDerivationInfo.28.29">PMFGetNextDerivationInfo()</span></h3>

<p><code>PMFGetNextDerivationInfo()</code> retrieves the UID value, type of assignment of each task involved in the next routing and the UID values of the <a href="../3.0/Managing_Users.html#Users">users</a> and <a href="../3.0/Managing_Users.html#Groups">groups</a> assigned to each one of these tasks. The function evaluates what the subsequent tasks will be based on the current case status.
<ul><li>In case of a <a href="Gateways.html">gateway</a>, the function evaluates the gateway conditions and the next task or tasks are returned. If these conditions are changed, then the function must be executed again to get the updated list of the next tasks.</li>
<li>In the case of Valued Based Assignment, the variable is evaluated to define the next users.</li>
<li>And in the case of parallel tasks, an array of all subsequent tasks is returned.</li></ul></p>

<codeblock><i>array</i> <strong>PMFGetNextDerivationInfo</strong>(<i>string</i> caseUID, <i>string</i> delIndex)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>caseUID</strong>: The unique ID of the case, which can be found in the following ways:
<ul><li>Use the <code>@@APPLICATION</code> system variable to get the unique ID of the current case.</li>
    <li>Use <a href="#PMFCaseList.28.29">PMFCaseList()</a>, <a href="../index.php/Simple_Trigger_Web_Services.html#WSCaseList" title="Simple Trigger Web Services">WSCaseList()</a>, or the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#caseList.28.29" title="3.0/ProcessMaker WSDL Web Services">caseList()</a> web service.</li></ul>
</li>
<li><i>string</i> <strong>delIndex</strong>: The delegation index of the current task in the case. For the current case, use the system variable <code>@%INDEX</code>.</li></ul>

<p><strong>Return Value:</strong></p>
<p>An array of associative arrays. Each one of these arrays contains the task ID, type of assignment, users and groups assigned to each one of the subsequent tasks. The array has the following structure:</p>
<codeblock>[0] <i>array</i>
(
    <i>associative array</i>
    (
        [<i>TaskUID1</i>] => value
        [<i>assignmentType</i>] => string
        [<i>Users</i>] => <i>array</i>
            [userUID1] => value
            [userUID2] => value
            [userUID3] => value
            ...
        [<i>Groups</i>] => <i>array</i>
            [groupUID1] => value
            [groupUID2] => value
            [groupUID3] => value
            ...
    )
)
[1] <i>array</i>
(
    <i>associative array</i>
    (
        [<i>TaskUID1</i>] => value
        [<i>assignmentType</i>] => string
        [<i>Users</i>] => <i>array</i>
            [userUID1] => value
            [userUID2] => value
            [userUID3] => value
            ...
        [<i>Groups</i>] => <i>array</i>
            [groupUID1] => value
            [groupUID2] => value
            [groupUID3] => value
            ...
    )
...
</codeblock>

<p><strong>Example:</strong></p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>nextderivationinfo <span style="color: #339933;">=</span> &nbsp;PMFGetNextDerivationInfo<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #339933;">@%</span>INDEX<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p>The variable @@nextderivationinfo obtains the UID values of the users and groups, and the type of assignment of each task belonging to the next route in the current case. The return value will show: </p>
<codeblock>Array (
    [0] => Array (
        [taskUid] => 1513061525703ed80a852e4097938551
        [assignmentType] => REPORT_TO
        [users] => Array (
            [0] => 5764160155703df3d460413079972555
        )
        [groups] => Array (
        )
    )
    [1] => Array (
        [taskUid] => 7843933105703ed59af8bf7030860154
        [assignmentType] => BALANCED
        [users] => Array (
            [0] => 5764160155703df3d460413079972555
            [1] => 3594665525703ee153f20c8004440048
        )
        [groups] => Array (
            [0] => 4433898925703eddbbac7d5066664808
            [1] => 7599792485703edeced1af8096618293
        )
    )
    [2] => Array (
        [taskUid] => 4588928225703ed5a56af22075961026
        [assignmentType] => MANUAL
        [users] => Array (
            [0] => 00000000000000000000000000000001
            [1] => 1475524905703ee63396449071456336
        )
        [groups] => Array (
            [0] => 4411010745703ede31505a5086018309
        )
    )
)
</codeblock>

<h3><span id="PMFRedirectToStep.28.29">PMFRedirectToStep()</span></h3>
<p><b><font color=red>Warning:</font></b> <span style="color: dimgrey">The PMFRedirectToStep function is not supported in the mobile version of Processmaker.</span></p>

<p><code>PMFRedirectToStep()</code> redirects a case to any step in the current task. For the step to be executed, the specified step must exist and if it contains a condition, it must evaluate to <strong><code>true</code></strong>. Any pending variables in the case will be saved before redirecting and any triggers set to execute before the step will by executed before showing the step. Note that any trigger code after PMFRedirectToStep() is called will not be executed, so it should be used as the last command in the trigger code. </p>

<codeblock><i>void</i> <strong>PMFRedirectToStep</strong>(<i>string</i> caseUID, <i>int</i> indexDelegation, <i>string</i> stepType, <i>string</i> stepUIDObject)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>caseUID</strong>: The unique ID of a case. For the current case, use the system variable <code>@@APPLICATION</code>. For other cases, look up it up using the <a href="#PMFCaseList.28.29">PMFCaseList()</a> function or by doing a database query for the field <strong><tt>wf_&lt;WORKSPACE&gt;.APPLICATION.APP_UID</tt></strong>.</li>

    <li><i>int</i> <strong>delegation</strong>: The delegation index of a case. For the current case, use the system variable <code>@%INDEX</code>.</li>

    <li><i>string</i> <strong>stepType</strong>: The type of step, which can be <code>'DYNAFORM'</code>, <code>'INPUT_DOCUMENT'</code>, <code>'OUTPUT_DOCUMENT'</code>, or <code>'EXTERNAL'</code>.</li>

    <li><i>string</i> <strong>stepUIDObject</strong>: The unique ID of the object (e.g. Dynaform, Input Document, Output Document, etc.) in the step. This unique ID can be found by looking up the <strong><tt>wf_&lt;WORKSPACE&gt;.STEP.STEP_UID_OBJ</tt></strong> field in the database.</li>
</ul>

<p><strong>Return Value:</strong></p>
<p>None.</p>

<p><b><font color=red>Warning:</font></b> <span style="color: dimgrey">The PMFRedirectToStep function is not supported in the Mobile Version of Processmaker. Instead, use the <code>G::header()</code> function for the same purpose, but make sure to save any case variables with <a href="#PMFSendVariables.28.29">PMFSendVariables()</a> if redirecting in a trigger after a Dynaform.</span></p>

<p><strong>Example:</strong></p>
<p>In the following code, the unique ID of the third step object is obtained with the <a href="#executeQuery.28.29">executeQuery</a> function after redirecting the task directly to the 3rd step with the <code>PMFRedirectToStep()</code> function:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$taskId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>TASK<span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//get ID for current task</span><br />
<span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT STEP_UID_OBJ FROM STEP WHERE TAS_UID='<span style="color: #006699; font-weight: bold;">$taskId</span>' and STEP_POSITION = 3&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #339933;">@@</span>stepUIDObj<span style="color: #339933;">=</span> <span style="color: #000088;">$result</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'STEP_UID_OBJ'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
PMFRedirectToStep<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #339933;">@%</span>INDEX<span style="color: #339933;">,</span> <span style="color: #0000ff;">'DYNAFORM'</span><span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>stepUIDObj<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<!-- END CASE ROUTING Functions -->

<h2><span id="Database_Functions">Database Functions</span></h2>

<h3><span id="executeQuery.28.29">executeQuery()</span></h3>
<p><code>executeQuery()</code> executes an <a  href="http://en.wikipedia.org/wiki/SQL">SQL</a> statement in a <a href="../3.0/Database_Connections.html" title="Database Connections">database connection</a> or in one of ProcessMaker's <a href="../3.0/ProcessMaker_Database_Model.html" title="ProcessMaker Database Model">internal databases</a>.</p>

<p style="margin-left:25px"><strong><font color="green">Note:</font></strong> <font color="dimgray">To avoid database integrity issues when SQL queries are executed directly in ProcessMaker Core tables, the <code>executeQuery()</code> function has been improved to protect Processmaker Core tables and PM_Tables defined by the user. For more information, see <a href="../3.0/Consulting_the_ProcessMaker_databases.html#Protecting_PM_Core_Tables">Protecting Processmaker Core Tables and PM_Tables</a>.</font></p>

<codeblock><i>variant</i> <strong>executeQuery</strong>(<i>string</i> SQLStatement, <i>string</i> DBConnectionUID='workflow')
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><code><i>string</i> <strong>SQLStatement</strong></i></code>: The SQL statement to be executed, which must begin with SELECT, INSERT, UPDATE, DELETE, EXECUTE, EXEC, SHOW, DESCRIBE, EXPLAIN or BEGIN. To learn basic SQL syntax, see <a  href="http://www.w3schools.com/SQl/default.asp">this tutorial</a>.<br>Do NOT include the database name in the SQL statement and do NOT use <code>`...`</code> (back ticks) to identify fields and tables.  For example, use <code>"SELECT * FROM USERS"</code>, instead of <code>"SELECT * FROM wf_workflow.USERS"</code>. SQL key words such as "SELECT" and "WHERE" are <i>case insensitive</i> and can be written as "select" and "Where". If ProcessMaker is installed in Windows, the table and field names in its MySQL databases are also <i>case insensitive</i> by default, but in UNIX/Linux they are <i>case sensitive</i> by default (although this can be changed with the <a  href="http://dev.mysql.com/doc/refman/5.0/en/server-system-variables.html#sysvar_lower_case_table_names%7C"><tt>lower_case_table_names</tt></a> setting). If consulting ProcessMaker databases, it is recommended that all table and field names be in UPPERCASE in the SQL statement, so the processes will be exportable between Windows and UNIX/Linux.</li>
    <li><code><i>string</i> <strong>DBConnectionUID</strong></code>: <i>Optional.</i> The unique ID of the database connection where the SQL statement will be executed. The unique ID is a string of 32 hexadecimal numbers that uniquely identifies database connections, and can be found by opening a process, going to <strong>DATABASE CONNECTIONS</strong>, and clicking on its <strong>Show ID</strong> button in the list.<br><br>
If this parameter is not included, the SQL statement will automatically be executed in the <strong><tt>wf_&lt;WORKSPACE&gt;</tt></strong> database of the current workspace, which is named <b><tt>wf_workflow</tt></b> by default. In ProcessMaker 3, each workspace has only 1 database by default, but each workspace upgraded from version 2 will have three databases by default, which can be accessed using the following prefixes:
<ul>
<li><code>'workflow'</code> for the <strong><tt>wf_&lt;WORKSPACE&gt;</tt></strong> database.
<li><code>'rbac'</code> for the <strong><tt>rb_&lt;WORKSPACE&gt;</tt></strong> database.
<li><code>'rp'</code> for the <strong><tt>rp_&lt;WORKSPACE&gt;</tt></strong> database.
</ul>
To access a ProcessMaker database in a workspace that is not the current workspace, create a Database Connection to the database and use its UID.</li>
</ul>

<p><strong>Return value:</strong></p>
<p>If executing a SELECT, EXECUTE, EXEC, SHOW, DESCRIBE, EXPLAIN or BEGIN statement, the function returns an associative array of associative arrays in the format:</p>

<codeblock>array(
  '1' => array(
     '<i>FIELD1</i>' => '<i>VALUE1</i>',
     '<i>FIELD2</i>' => '<i>VALUE2</i>',
     ...
   ),
   '2' => array(
     '<i>FIELD1</i>' => '<i>VALUE1</i>',
     '<i>FIELD2</i>' => '<i>VALUE2</i>',
     ...
   ),
   ...
)
</codeblock>

<p>The counting of the outer array starts from <strong>1</strong> (not <strong>0</strong> like a normal PHP array). All field values returned by <code>SELECT</code> statements will be strings, regardless of their original type in the database. In most cases, it is not necessary to explicitly convert the values with type casting, because PHP will gracefully convert integers and floating point numbers automatically if a field value is used in a mathematical operation. <a href="Datetime_Control.html">Datetime</a> controls in Dynaforms treat dates as strings, so date values generally do not need to be converted either.</p>
<p>For <code>INSERT</code> statements, the function returns <code>1</code> if the operation was successful; otherwise it returns <code>0</code>.</p>
<p>For <code>UPDATE</code> and <code>DELETE</code> statements, the function will return the number of affected rows.</p>
<p>If an error occurs in the database query, it returns a string containing the error message, and subsequent <code>executeQuery()</code> functions that call to the same database in the same trigger will not execute correctly.</p>
<p>If the SQL statement starts with an unrecognized SQL command, then <code>executeQuery()</code> will return <code>FALSE</code>.</p>

<div style="margin-left:25px;"><p><font color=green><b>Note:</b></font> <font color=dimgrey>If an error occurred in the SQL query, ProcessMaker will add an  <code>@@__ERROR__</code> variable to the case with the contents <code>"It is not possible to execute the query. Please contact your system administrator"</code>, which can be viewed when <a href="../3.0/Triggers.html#Enabling_Debug_Mode">Debug Mode</a> is enabled.</p>
<p>MySQL's error message will be placed in the <code>@@__ERROR__</code> variable. Do <b>NOT</b> enable <code>debug_sql</code> in the <b><tt>env.ini</tt></b> file, since it will suppress MySQL error messages.</font></p></div>

<p><strong>Example 1:</strong></p>
<p>Look up information about the logged-in ProcessMaker user:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$UID</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #339933;">;</span> &nbsp; <span style="color: #666666; font-style: italic;">#assign to normal PHP variable to insert in string<br />
</span><span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT * FROM USERS WHERE USR_UID='<span style="color: #006699; font-weight: bold;">$UID</span>'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #339933;">@@</span>UserFirstName <span style="color: #339933;">=</span> <span style="color: #000088;">$result</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_FIRSTNAME'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #339933;">@@</span>UserLastName <span style="color: #339933;">=</span> <span style="color: #000088;">$result</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_LASTNAME'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<p><span style="color: green;"><strong>Note 1:</strong></span></p>
<div style="margin-left: 25px;"><p><font color=dimgrey>ProcessMaker system and case variables can NOT be inserted in double quoted strings, like this:</p>

    <div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT * FROM USERS WHERE USR_UID='@@USER_LOGGED'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

    <p>Instead, ProcessMaker system and case variables first need to be assigned to normal PHP variables to be inserted inside a double quoted string, like this:</p>

    <div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$UID</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #339933;">;</span> &nbsp; <span style="color: #666666; font-style: italic;">#assign to normal PHP variable to insert in string<br />
</span><span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT * FROM USERS WHERE USR_UID='<span style="color: #006699; font-weight: bold;">$UID</span>'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

    <p>Also note that single quoted strings are treated like literal strings, so PHP variables can <b>NOT</b> be inserted in a single quoted string like this:</font></p>

    <div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'SELECT * USERS WHERE USR_UID=\'$UID\''</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
</div>

<p><span style="color: green;"><strong>Note 2:</strong></span></p>
<div style="margin-left: 25px;"><font color=dimgrey><p>String, date and datetime values in SQL queries should be enclosed within single quotes, while integer and floating-point values should NOT be enclosed within single quotes. If it is necessary to use an apostrophe in a string, escape it with a backslash. For example:</p>
    <div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT FIRSTNAME, LASTNAME FROM CLIENTS WHERE ID=8734 AND STATUS='Don\'t wait'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

    <p>Some databases like MySQL will accept double quotation marks in place of single quotation marks around strings and dates, but it is not recommended to do this because it is not SQL standard.</p></font>

   <!-- <p>When using text input by a user in a database query, it is strongly recommended to pass that text through <a href="http://php.net/manual/en/function.mysql-real-escape-string.php">mysql_real_escape_string()</a> if using a MySQL database, <a href="http://php.net/manual/en/function.pg-escape-string.php">pg_escape_string()</a> if using a PostgreSQL database, or <a href="http://php.net/manual/en/function.addslashes">addslashes()</a> for other types of databases to avoid <a href="https://en.wikipedia.org/wiki/Code_injection">code injection</a> attacks.</p>

    <p>For example, the following code uses text entered in a Dynaform field named "clientName" in the SQL query, so problematic characters are escaped with backslashes by using <code>mysql_real_escape_string()</code>:</font></p>
    <div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$db</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'89445967454f5d18dd694f4084525230'</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//unique ID of database connection</span><br />
<span style="color: #000088;">$client</span> <span style="color: #339933;">=</span> <a href="http://php.net/mysql_real_escape_string"><span style="color: #990000;">mysql_real_escape_string</span></a><span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>clientName<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT * FROM CLIENTS WHERE CLIENT_NAME='<span style="color: #006699; font-weight: bold;">$client</span>'&quot;</span><span style="color: #339933;">,</span> <span style="color: #000088;">$db</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #339933;">@@</span>contractAmount <span style="color: #339933;">=</span> <span style="color: #000088;">$result</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'CONTRACT_AMOUNT'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div> -->
</div>

<p><strong>Example 2:</strong></p>
<p>Look up all the users in a ProcessMaker group named "accounting":</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$query</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;SELECT U.USR_FIRSTNAME AS FNAME, U.USR_LASTNAME AS LNAME &quot;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">&quot;FROM GROUPWF &nbsp;&quot;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">&quot;LEFT JOIN GROUP_USER GU &nbsp;ON (GROUPWF.GRP_UID = GU.GRP_UID) &quot;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">&quot;LEFT JOIN USERS U ON (U.USR_UID = GU.USR_UID) &quot;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">&quot;WHERE U.USR_STATUS='ACTIVE' AND GROUPWF.GRP_TITLE = 'accounting'&quot;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$query</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'workflow'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #666666; font-style: italic;">#loop to extract the returned rows<br />
</span> &nbsp; <span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$row</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #339933;">@@</span>GroupMembers<span style="color: #009900;">&#91;</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$row</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'FNAME'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">' '</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$row</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'LNAME'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<p><strong>Example 3:</strong></p>
<p>The unique ID for the database connection is different in each process. If planning to reuse the same same code in multiple processes, this code looks up the unique ID of a database connection to an external database named "company_data" with the table "clients" at 192.168.2.100. This example also shows how to insert, update and delete records in the database:

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #666666; font-style: italic;">#first look up the UID of the database connection<br />
</span><span style="color: #000088;">$proc</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>PROCESS<span style="color: #339933;">;</span><br />
<span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT DBS_UID FROM DB_SOURCE WHERE PRO_UID='<span style="color: #006699; font-weight: bold;">$proc</span>' &quot;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp;<span style="color: #0000ff;">&quot;AND DBS_DATABASE_NAME='company_data' AND DBS_SERVER='192.168.2.100'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> or <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">==</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp;<a href="http://php.net/die"><span style="color: #990000;">die</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Error: Unable to look up UID for database 'company_data'!&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #000088;">$db</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$result</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'DBS_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$query</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;INSERT INTO CLIENTS (FNAME, LNAME, COMPANY) VALUES ('Jane', 'Doe', NULL)&quot;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span>executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$query</span><span style="color: #339933;">,</span> <span style="color: #000088;">$db</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">==</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp;<a href="http://php.net/die"><span style="color: #990000;">die</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Unable to insert record into company_data.CLIENTS table&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #000088;">$query</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;UPDATE CLIENTS SET COMPANY='Acme Inc.' WHERE FNAME='Jane' AND LNAME='Doe'&quot;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span>executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$query</span><span style="color: #339933;">,</span> <span style="color: #000088;">$db</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">==</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp;<a href="http://php.net/die"><span style="color: #990000;">die</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Unable to update the company_data.CLIENTS table&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #000088;">$query</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;DELETE FROM CLIENTS WHERE FNAME='Jane' AND LNAME='Doe'&quot;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span>executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$query</span><span style="color: #339933;">,</span> <span style="color: #000088;">$db</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">==</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp; <a href="http://php.net/die"><span style="color: #990000;">die</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Unable to delete record in company_data.CLIENTS table&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p><strong>Example 4:</strong></p>
<p>In this example, <code>executeQuery()</code> is used to look up the next available case to which the logged in user is assigned. If a case is found, then the web browser will automatically be redirected to that case with the <a href="http://php.net/manual/en/function.header.php">header()</a> function, otherwise the browser will be redirected to the Case List page. Before redirecting the browser, the current task is automatically routed to the next task in the process with <a href="#PMFDerivateCase.28.29">PMFDerivateCase()</a>. This trigger code can be added after the last step in the task to avoid displaying the screen that shows the next assigned user and the "Continue" button.</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$userUID</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #339933;">;</span><br />
<span style="color: #000088;">$query</span> &nbsp;<span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;SELECT APP_UID, DEL_INDEX FROM APP_DELEGATION &quot;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp;<span style="color: #0000ff;">&quot;WHERE USR_UID = '<span style="color: #006699; font-weight: bold;">$userUID</span>' AND DEL_THREAD_STATUS = 'OPEN' &quot;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp;<span style="color: #0000ff;">&quot;ORDER BY DEL_DELEGATE_DATE DESC&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$queryResult</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$query</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$queryResult</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&amp;&amp;</span> <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$queryResult</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$caseURL</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'cases_Open?APP_UID='</span> <span style="color: #339933;">.</span> &nbsp;<span style="color: #000088;">$queryResult</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_UID'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'&amp;DEL_INDEX='</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$queryResult</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'DEL_INDEX'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">else</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$caseURL</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'casesListExtJs'</span><span style="color: #339933;">;</span><br />
<br />
<br />
<span style="color: #666666; font-style: italic;">//Route the current case to the next task in process:</span><br />
PMFDerivateCase<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #339933;">@%</span>INDEX<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #666666; font-style: italic;">//Redirect the web browser to a new location:</span><br />
<a href="http://php.net/header"><span style="color: #990000;">header</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;location: <span style="color: #006699; font-weight: bold;">$caseURL</span>&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<a href="http://php.net/die"><span style="color: #990000;">die</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p><strong>Other examples:</strong></p>
<p>To see an example using <code>executeQuery()</code> to access information about Dynaform file objects and write files to a database, read <a href="../index.php/2.5.X/DynaForms%23The_DynaForm_Editor_Toolbar.html#Accessing_Files_with_PHP" title="Dynaform Fields">Accessing Files with PHP</a>. For an example using <code>executeQuery()</code> to populate a grid, see <a href="../index.php/2.5.X/DynaForms%23The_DynaForm_Editor_Toolbar.html#Accessing_Grids_with_PHP" title="Dynaform Fields">Accessing Grids with PHP</a>.</p>

<h2><span id="Date_Functions">Date Functions</span></h2>

<h3><span id="formatDate.28.29">formatDate()</span></h3><p><code>formatDate()</code> formats a date string according to a given date format and given language. Note that ProcessMaker stores the input in <a href="Datetime_Control.html" title="3.1/Datetime control">date</a> fields in Dynaforms as strings.</p>
<codeblock><i>string</i> <strong>formatDate</strong>(<i>string</i> date, <i>string</i> format, <i>string</i> language='en')
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>date</strong>: The input date to be reformatted. The input date must be a string in the format <code>'yyyy-mm-dd'</code> or <code>'yyyy-mm-dd h:i:s'</code>, such as <code>'2015-12-31'</code> or <code>'1998-02-07 22:50:08'</code>. This is the same format used to store dates and datetimes by the MySQL database and <a href="Datetime_Control.html">datetime</a> fields in Dynaforms.</li>
    <li><i>string</i> <strong>format</strong>: The format of the date that will be returned. It can contain the following codes:
<ul>
<li><code>yyyy</code> - shows the year with four numbers (e.g. it shows the year 2008 as <code>2008</code>)
<li><code>yy</code> - shows the year with two numbers (e.g. it shows the year 2008 as <code>08</code>)
<li><code>mm</code> - shows the month with two numbers (e.g. it shows June as <code>06</code>)
<li><code>m</code> - shows the month with a simple number (e.g. it shows June as <code>6</code>)
<li><code>M</code> - shows the word for the month in the selected language (e.g. if the month is June, it shows <code>June</code> in English and <code>junio</code> in Spanish)
<li><code>dd</code> - shows the day of the month with two numbers (e.g. the first day of the month is <code>01</code>)
<li><code>d</code> - shows the day of the month with a simple number (e.g. the first day of the month is <code>1</code>)
<li><code>h</code> - shows the hour with two numbers in a 24 hour clock (e.g. 2pm is <code>14</code>)
<li><code>i</code> - shows the minutes with two numbers (e.g. first minute is <code>01</code>)
<li><code>s</code> - shows the seconds with two numbers (e.g. first second is <code>01</code>)
</ul>
</li>
    <li><i>string</i> <strong>language</strong>: The language used to reformat the date. It can be <code>'en'</code> (English), <code>'es'</code> (Spanish) or <code>'fa'</code> (Persian). If not included, English is set as the default language.</li></ul>
<p><strong>Return value:</strong></p>

<ul><li><i>string</i></code>: Returns the date passed in the given date format.</li></ul>
<p><strong><font color=green>Note:</font></strong> <font color=dimgrey>For other languages, use PHP's <a  href="http://www.php.net/manual/en/function.strftime.php">strftime()</a> function. See <a href="Datetime_Control.html#Format" title="3.1/Datetime">Formatting Dates in Other Locales</a>.</font></p>
<p><strong>Examples:</strong></p>
<p>The value of @@textBox will be <code>'June 11, 2008'</code>:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>textBox <span style="color: #339933;">=</span> formatDate<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'2008-06-11'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'M dd,yyyy'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'en'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p>The value of @@textBox will be <code>'7 de Junio del 2008'</code>:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>textBox <span style="color: #339933;">=</span> formatDate<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'2008-06-07'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'d de M del 2008'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'es'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p>The value of @@textBox will be <code>'07/06/08 06:45:04'</code>:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>textBox <span style="color: #339933;">=</span> formatDate<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'2008-06-07 06:45:04'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'dd/mm/yy h:i:s'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
<p>(In this example, the language parameter is omitted and English is used by default)</p>


<h3><span id="getCurrentDate.28.29">getCurrentDate()</span></h3>
<p><code>getCurrentDate()</code> retrieves the current date in the format "yyyy-mm-dd", with leading zeros in the month and day if less than 10. This function is equivalent to PHP's <code>date("Y-m-d")</code>.</p>

<codeblock><i>string</i> <strong>getCurrentDate</strong>()
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li>This function does not need any parameter.</li></ul>
<p><strong>Return value:</strong></p>
<ul><li><i>string</i></code>: Returns the current date as a string value.</li></ul>
<p><strong>Example:</strong></p>
<p>If the current date is December 16, 2009:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>myTextBox <span style="color: #339933;">=</span> getCurrentDate<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
<p>The value of <code>@@mytextBox</code> will be <code>'2009-12-16'</code>.</p>

<h3><span id="getCurrentTime.28.29">getCurrentTime()</span></h3>
<p><code>getCurrentTime()</code> returns a string with the current time in the format "hh:mm:ss" with leading zeros when the hours, minutes or seconds are less than 10. The hour is expressed in the 24 hour format (military time) and is a number between 00 and 23. This function is equivalent to PHP's <span class="geshifilter"><code class="php geshifilter-php"><a href="http://php.net/date"><span style="color: #990000;">date</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'H:i:s'</span><span style="color: #009900;">&#41;</span></code></span>.</p>

<codeblock><i>string</i> <strong>getCurrentTime</strong>(<i>void</i>)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li>This function does not need any parameters.</li></ul>
<p><strong>Return value:</strong></p>
<ul><li><strong>string</strong>: The function returns the current time as a string.</li></ul>
<p><strong>Example:</strong></p>
<p>If the current time is 9:13 am, then:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>curTime <span style="color: #339933;">=</span> getCurrentTime<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
<p>The value of the <code>@@curTime</code> will be <code>'09:13:23'</code>.</p>

<h3><span id="literalDate.28.29">literalDate()</span></h3>
<p><code>literalDate()</code> returns a specified date written out in a given language, (e.g, English: <code>"2008-06-11"</code> returns <code>"June 11, 2008"</code>, Spanish: <code>"2008-06-11"</code> returns <code>"11 de Junio de 2008"</code>).</p>

<codeblock><i>string</i> <strong>literalDate</strong>(<i>string</i> date, <i>string</i> language='en')
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>date</strong>: The input date as a string in standard <code>YYYY-MM-DD</code> format.</li>
    <li><i>string</i> <strong>language</strong>: The displayed language, which can be 'en' (English) or 'es' (Spanish). If not included, then it will be English by default.</li></ul>
<p><strong>Return value:</strong></p>
<p>The literal date is returned as a string.</p>
<p><span style="color: green;"><strong>Note:</strong></span> <span style="color: dimgrey;">For other languages, use PHP's <a  href="http://www.php.net/manual/en/function.strftime.php">strftime()</a> function. See <a href="Datetime_Control.html#Format" title="3.1/Datetime">Formatting Dates in Other Locales</a>.</span></p>

<p><strong>Example:</strong></p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>textBox <span style="color: #339933;">=</span> literalDate<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;2009-12-17&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;en&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
<p>The returned value stored in <code>@@textBox</code> will be <code>'December 17, 2009'</code>.</p>

<!-- DOCUMENT Functions -->
<h2><span id="Document_Functions">Document Functions</span></h2>

<h3><span id="PMFAddInputDocument.28.29">PMFAddInputDocument()</span></h3>

<p><code>PMFAddInputDocument()</code> adds an Input Document file to a specified case.</p>

<codeblock><i>string</i> <strong>PMFAddInputDocument</strong>(<i>string</i> inputDocumentUID, <i>string</i> appDocUID, <i>int</i> docVersion, <i>string</i> appDocType = 'INPUT', <i>string</i> appDocComment, <i>string</i> inputDocumentAction, <i>string</i> caseUID, <i>int</i> delIndex, <i>string</i> taskUID, <i>string</i> userUID, <i>string</i> option = 'file', <i>string</i> file = 'path_to_file/myfile.txt')
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>inputDocumentUID</strong>: The unique ID of the Input Document. This can be found by clicking on the <strong>UID</strong> button in the list of Input Documents or by using the following database query:<br />
<span class="geshifilter"><code class="sql geshifilter-sql"><span style="color: #993333; font-weight: bold;">SELECT</span> INP_DOC_UID <span style="color: #993333; font-weight: bold;">FROM</span> INPUT_DOCUMENT <span style="color: #993333; font-weight: bold;">WHERE</span> INP_DOC_TITLE <span style="color: #66cc66;">=</span> <span style="color: #ff0000;">'INPUT-DOC-TITLE'</span></code></span>
</li>
</ul>
<ul><li><i>string</i> <strong>appDocUID</strong>: The unique ID of the file to be replaced or have a new version added. Set to <code>null</code> or <code>""</code> (empty string) if adding a new file.</li>
    <li><i>int</i> <strong>docVersion</strong>: The document version, which starts numbering from 1. If adding a new version, increment the existing version by 1.</li>
    <li><i>string</i> <strong>appDocType</strong>: The document type, which is 'INPUT' for an Input Document file or 'ATTACHED' for an attached file (which is uploaded to a file field).</li>
    <li><i>string</i> <strong>appDocComment</strong>: The comment of the uploaded file.</li>
    <li><i>string</i> <strong>inputDocumentAction</strong>: The action, which can be: <code>null</code> or <code>""</code> for <i>add</i>, <code>"R"</code> for <i>replace</i> or <code>"NV"</code> for <i>new version</i>.</li>
    <li><i>string</i> <strong>caseUID</strong>: The unique ID of the case to which the file will added. It can be found in the following ways:
<ul><li>Use the <code>@@APPLICATION</code> system variable to get the unique ID of the current case.</li>
    <li>Use the <a href="#PMFCaseList.28.29">PMFCaseList()</a>, <a href="../index.php/Simple_Trigger_Web_Services.html#WSCaseList" title="Simple Trigger Web Services">WSCaseList()</a> or the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#caseList.28.29" title="3.0/ProcessMaker WSDL Web Services">caseList()</a> web service.</li>
    <li>Use <a href="#executeQuery.28.29">executeQuery()</a> to look up the case UID in the <strong><tt>wf_&lt;WORKSPACE&gt;.APPLICATION.APP_UID</tt></strong> field in the database.</li></ul>
</li>
<li><i>int</i> <strong>delIndex</strong>: The delegation index of the case to which the file will be added. It can be found in the following ways:
<ul><li>Use the system variable <code>@%INDEX</code> for the current case.</li>
<li>Use the <a href="#PMFCaseList.28.29">PMFCaseList()</a>, <a href="../index.php/Simple_Trigger_Web_Services.html#WSCaseList" title="Simple Trigger Web Services">WSCaseList()</a> or the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#caseList.28.29" title="3.0/ProcessMaker WSDL Web Services">caseList()</a> web service.</li>
<li>Use <a href="#executeQuery.28.29">executeQuery()</a> to look up the delegation index in the <strong><tt>wf_&lt;WORKSPACE&gt;.APP_CACHE_VIEW.DEL_INDEX</tt></strong> field <code>WHERE DEL_THREAD_STATUS='OPEN'</code>.</li></ul>
</li>

<li><i>string</i> <strong>taskUID</strong>: The unique ID of the task, which can be found in the following ways:
  <ul>
  <li>Use the <code>@@TASK</code> system variable to get the unique ID of the current task.</li>
<li>Use the <a href="#PMFTaskList.28.29">PMFTaskList()</a> function or <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#taskList.28.29" title="3.0/ProcessMaker WSDL Web Services">taskList()</a> web service.</li>
<li>Query the <strong><tt>wf_&lt;WORKSPACE&gt;.TASK.TAS_UID</tt></strong> field in the database or get the starting task of the current process with the following query:<br>
  <dl><dd><dl><dd><code>executeQuery("SELECT TAS_UID FROM TASK WHERE PRO_UID='"</span> <span class="sy0" style="color: rgb(51, 153, 51);">.</span> <span class="sy0" style="color: rgb(51, 153, 51);">@@</span>PROCESS <span class="sy0" style="color: rgb(51, 153, 51);">.</span> <span class="st0" style="color: rgb(0, 0, 255);">"' AND TAS_START='TRUE'"</span>)</code></dd></dl></dd></dl>
  </li>
</ul>
</li>


<li><i>string</i> <strong>userUID</strong>: The unique ID of the user who is set as the uploader of the file.</li>
<li><i>string</i> <strong>option</strong>: The option, which should be set to: <code>"file"</code> by default.</li>
<li><i>string</i> <strong>file</strong>: The path of the file to be added, which is stored on the ProcessMaker server.</li></ul>
<p><strong>Return value:</strong></p>
<ul><li>Returns the unique ID of the added AppDocument (which is a case file) if it was added successfully; otherwise, returns <code>null</code> if an error occurred.</li></ul>
<p><strong>Example:</strong></p>
<p>Create an Input Document in ProcessMaker. Look up its current ID and assign it to the variable named <code>inputDocumentUID</code>. Set the value of the application document ID to null and the value of the Document Action to 'add' if it is the first time the process is run.</p>

<codeblock>inputDocumentUID  = 757584323513f501410f3f3061256214
appDocUID = null
inputDocumentAction = Add
</codeblock>

<p>Set the following trigger to be executed before the Input Document files are displayed:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>fileId <span style="color: #339933;">=</span> PMFAddInputDocument<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'757584323513f501410f3f3061256214'</span><span style="color: #339933;">,</span> <span style="color: #009900; font-weight: bold;">null</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'INPUT'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'Testing'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'Add'</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp;<span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #339933;">@%</span>INDEX<span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>TASK<span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #339933;">,</span> <span style="color: #0000ff;">'file'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'c:\file.txt'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p>If the same document needs to be uploaded as a new version, copy the ID of the document previously added with the following parameters:</p>

<codeblock>inputDocumentUID  = 757584323513f501410f3f3061256214
appDocUID = 456268310513fa1b624c751021820069 //obtain this from the return variable while case is running or from the database wf_&lt;WORKSPACE&gt;.INPUT_DOCUMENT
inputDocumentAction = 'NV'
</codeblock>

<p><span style="color: green;"><strong>Note:</strong></span> <font color=dimgrey>Don't forget to enable versioning when defining the Input Document. Otherwise, it won't be possible to upload another version of the same Input Document file.</font></p>

<h3><span id="PMFAssociateUploadedFilesWithInputFile.28.29">PMFAssociateUploadedFilesWithInputFile()</span></h3>

<p><code>PMFAssociateUploadedFilesWithInputFile()</code> associates the files uploaded inside a grid with an Input Document. If the Dynaform contains more than one grid, the function should be used more than one time changing the parameters.</p>

<codeblock><i>variant</i> <strong>PMFAssociateUploadedFilesWithInputFile</strong>(<i>string</i> inputDocumentUID, <i>string</i> gridVariableName, <i>string</i> fileVariableName, <i>string</i> caseUID, <i>string</i> userUID, <i>int</i> delIndex)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul>
    <li><i>string</i> <strong>inputDocumentUID</strong>: The unique ID of the Input Document the user wants to associate with the uploaded files. This can be found by clicking on the <strong>UID</strong> button in the list of Input Documents or by using the following database query:
<div class="geshifilter"><div class="sql geshifilter-sql" style="font-family:monospace;"><span style="color: #993333; font-weight: bold;">SELECT</span> INP_DOC_UID <span style="color: #993333; font-weight: bold;">FROM</span> INPUT_DOCUMENT <span style="color: #993333; font-weight: bold;">WHERE</span> INP_DOC_TITLE <span style="color: #66cc66;">=</span> <span style="color: #ff0000;">'&lt;INPUT-DOC-TITLE&gt;'</span></div></div>
    </li>
    <li><i>string</i> <strong>gridVariableName</strong>: The variable name of the grid that contains the uploaded files.</li>

    <li><i>string</i> <strong>fileVariableName</strong>: The variable name of the file.</li>

    <li><i>string</i> <strong>caseUID</strong>: The unique ID of the case to which the file will added. It can be found in the following ways:
  <ul><li>Use the <code>@@APPLICATION</code> system variable to get the unique ID of the current case.</li>
    <li>Use the <a href="#PMFCaseList.28.29">PMFCaseList()</a>, <a href="../index.php/Simple_Trigger_Web_Services.html#WSCaseList" title="Simple Trigger Web Services">WSCaseList()</a> or the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#caseList.28.29" title="3.0/ProcessMaker WSDL Web Services">caseList()</a> web service.</li>
    <li>Use <a href="#executeQuery.28.29">executeQuery()</a> to look up the case UID in the <strong><tt>wf_&lt;WORKSPACE&gt;.APPLICATION.APP_UID</tt></strong> field in the database.</li></ul>
</li>

<li><i>string</i> <strong>userUID</strong>: The unique ID of the user who is set as the uploader of the file.</li>

<li><i>int</i> <strong>delIndex</strong>: The delegation index of the current case to which the file will be added. It can be found in the following ways:

  <ul><li>Use the system variable <code>@%INDEX</code> for the current case.</li>
<li>Use the <a href="#PMFCaseList.28.29">PMFCaseList()</a>, <a href="../index.php/Simple_Trigger_Web_Services.html#WSCaseList" title="Simple Trigger Web Services">WSCaseList()</a> or the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#caseList.28.29" title="3.0/ProcessMaker WSDL Web Services">caseList()</a> web service.</li>
<li>Use <a href="#executeQuery.28.29">executeQuery()</a> to look up the delegation index in the <strong><tt>wf_&lt;WORKSPACE&gt;.APP_CACHE_VIEW.DEL_INDEX</tt></strong> field <code>WHERE DEL_THREAD_STATUS='OPEN'</code>.</li></ul>
</li>
</ul>
<p><strong>Return value:</strong></p>

<ul>
    <li>Returns null or empty by default; if there is an error it will go through an exception.</li>
</ul>

<p><strong>Example:</strong></p>
<p>The following trigger code associates the uploaded files in the grid with the @@gridVar variable to a file named file0000000001 in the current case:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span><span style="color: #b1b100;">return</span> <span style="color: #339933;">=</span> PMFAssociateUploadedFilesWithInputFile<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;61499023457b392c30b6ec9010939119&quot;</span><span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>gridVar<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;file0000000001&quot;</span><span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>INDEX<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<h3><span id="PMFCopyDocumentCase.28.29">PMFCopyDocumentCase()</span></h3>

<p><code>PMFCopyDocumentCase()</code> copies a document file from one case with another case, such as sharing a document file between a parent case and a subprocess case.</p>

<codeblock><i>string</i> <strong>PMFCopyDocumentCase</strong>(<i>string</i> AppDocUID, <i>int</i> docVersion, <i>string</i> targetCaseUID, <i>string</i> InputDocumentUID)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>appDocUID</strong>: The unique ID of the file in the source case. This ID can be found by querying the <b><tt>APP_DOCUMENT.APP_DOC_UID</tt></b> field in the database or by using <code>json_decode(@@<font color=indianred><i>fileVariable</i></font>)[0]</code> for a File field or <code>@=<font color=indianred><i>multipleFileVariable</i></font>[<font color=indianred><i>N</i></font>]['appDocUid']</code> for a MultipleFile field.</li>
    <li><i>int</i> <strong>docVersion</strong>: The document version number, which starts numbering from <code>1</code>. If adding a new version, increment the existing version by <code>1</code>.</li>
    <li><i>string</i> <strong>caseUID</strong>: The unique ID of the target case to which the document will be copied. It can be found in the following ways:
<ul><li>Use the <code>@@APPLICATION</code> system variable to get the unique ID of the current case.</li>
    <li>Use the <a href="#PMFCaseList.28.29">PMFCaseList()</a>, <a href="../index.php/Simple_Trigger_Web_Services.html#WSCaseList" title="Simple Trigger Web Services">WSCaseList()</a> or the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#caseList.28.29" title="3.0/ProcessMaker WSDL Web Services">caseList()</a> web service.</li>
    <li>Use <a href="#executeQuery.28.29">executeQuery()</a> to look up the case UID in the <strong><tt>wf_&lt;WORKSPACE&gt;.APPLICATION.APP_UID</tt></strong> field in the database.</li></ul>
</li>
<li><i>string</i> <strong>InputDocumentUID</strong>: <i>Optional.</i> The unique ID of the Input Document in the target Case. If not specified, then the file is uploaded as an attachment in the target case (not associated to any input document). This parameter can be found by clicking on the <strong>UID</strong> button in the list of Input Documents.</li>
</ul>

<p><strong>Return value:</strong></p>
<ul><li>Returns the copied document UID if the document was copied successfully; otherwise, returns an exception if an error occurred.</li></ul>

<p><strong>Example:</strong></p>
<p>The following code copies the first version of a document with ID "43103027358111e9547f7a0093499626" to the current case:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>result <span style="color: #339933;">=</span> PMFCopyDocumentCase<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;43103027358111e9547f7a0093499626&quot;</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<h3><span id="PMFGenerateOutputDocument.28.29">PMFGenerateOutputDocument()</span></h3>
<p><code>PMFGenerateOutputDocument()</code> generates a specified Output Document, merging the variables from the current case into the Output Document's template. This function creates the Output Document files in the server file system and adds a new record to the <strong><tt>wf_&lt;WORKSPACE&gt;.APP_DOCUMENT</tt></strong> table. For more information, see <a href="../3.0/Output_Documents.html#Output_Document_Storage" title="3.0/Output Documents">Output Document Storage</a>. If an Output Document has already been generated in the current case, this function will overwrite the existing Output Document file (or add a new version of the file, if the <a href="../3.0/Output_Documents.html#versioning" title="3.0/Output Documents">versioning</a> option is enabled.)</p>

<codeblock><i>void</i> <strong>PMFGenerateOutputDocument</strong>(<i>string</i> outputUID, <i>string</i> application = null, <i>integer</i> delIndex = null, <i>string</i> userUID = null)
</codeblock>

    <p><strong>Parameters:</strong></p>
    <p>
    <ul>
        <li><i>string</i> <strong>outputUID</strong>: The unique ID of the Output Document, which can be found in 3 ways:
            <ul>
        <li>Look it up in the <strong><tt>wf_&lt;WORKSPACE&gt;.OUTPUT_DOCUMENT.OUT_DOC_UID</tt></strong> field in
            the database.</li>
        <li>In the <strong><tt>wf_&lt;WORKSPACE&gt;</tt></strong> database, issue the query:
<div class="geshifilter"><div class="sql geshifilter-sql" style="font-family:monospace;"><span style="color: #993333; font-weight: bold;">SELECT</span> OUT_DOC_UID <span style="color: #993333; font-weight: bold;">FROM</span> OUTPUT_DOCUMENT <span style="color: #993333; font-weight: bold;">WHERE</span> OUT_DOC_TITLE <span style="color: #66cc66;">=</span> <span style="color: #ff0000;">'&lt;OUTPUT-DOC-TITLE&gt;'</span></div></div></li>
        <li>Run a case with the Output Document as a step and examine the <code>UID</code> variable in the debugger.</li>
        </ul>
        </li>
         <li><i>string</i> <strong>caseUID</strong>: The unique ID of the case to which the file will added. It can be found in the following ways:
 <ul><li>Use the <code>@@APPLICATION</code> system variable to get the unique ID of the current case.</li>
         <li>Use the <a href="#PMFCaseList.28.29">PMFCaseList()</a>, <a href="../index.php/Simple_Trigger_Web_Services.html#WSCaseList" title="Simple Trigger Web Services">WSCaseList()</a> or the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#caseList.28.29" title="3.0/ProcessMaker WSDL Web Services">caseList()</a> web service.</li>
         <li>Use <a href="#executeQuery.28.29">executeQuery()</a> to look up the case UID in the <strong><tt>wf_&lt;WORKSPACE&gt;.APPLICATION.APP_UID</tt></strong> field in the database.</li></ul>
     </li>
        <li><i>int</i> <strong>delIndex</strong>: The delegation index of the case from which the file will be generated.</li>
<li><i>string</i> <strong>userUID</strong>: The unique ID of the user who is set as the uploader of the file.
<p style="margin-left:25px"><strong><font color="green">Note:</font></strong> <font color="dimgray">If you are using the <code>PMFGenerateOutputDocument()</code> function in a <a href="../3.2/Tasks.html#ScriptTask">Script</a> task, the <code>userUID</code> parameter is required. Otherwise, if there is no user UID, it must be defined as null.</font></p></li>
    </ul>
</p>
<p><strong>Return Value:</strong><br>None.</p>
<dl>
    <dd><font color="green"><strong>Note:</strong></font> <font color="dimgrey"><code>PMFGenerateOutputDocument()</code> can be called at any point in a case, but if a variable used in the Output Document template does not yet exist, then the variable name will be inserted into the generated file, not the value for that variable.</font></dd>
</dl>
<p><strong>Examples:</strong><br><strong>1.</strong> If the template file of the Output Document contains a case variable set in the same trigger that calls <a href="#PMFGenerateOutputDocument.28.29">PMFGenerateOutputDocument()</a>, then the case variable will have to first be saved to the database using the <a href="#PMFSendVaraibles.28.29">PMFSendVariables()</a> function.</p>
<p>For example, the template contains the variables <code>@#ClientName</code> and <code>@#AccountNumber</code>. Those variables will be saved to the database with <code>PMFSendVariables()</code> before calling <code>PMFGenerateOutputDocument()</code>.</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$vars</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;ClientName&quot;</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;Sally Simpson&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;AccountNumber&quot;</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;G2938-238&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> PMFSendVariables<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #000088;">$vars</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #666666; font-style: italic;">//Returns 1 if the variables were sent successfully to the case</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$docId</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'954109698491477e1986b43042252891'</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//output document unique ID</span><br />
&nbsp; &nbsp;PMFGenerateOutputDocument<span style="color: #009900;">&#40;</span><span style="color: #000088;">$docId</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<p><strong>2.</strong> Generate an Output Document in the current case, then open the HTML file that was generated for it and insert it into an email template named "outDocMail.html", which has the inserted variable <code>@#mailBody</code>:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$docUID</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'954109698491477e1986b43042252891'</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//set to the Output Document's unique ID</span><br />
PMFGenerateOutputDocument<span style="color: #009900;">&#40;</span><span style="color: #000088;">$docUID</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #666666; font-style: italic;">//find the generated Output Document in the wf_&amp;&lt;WORKSPACE&gt;.APP_DOCUMENT table</span><br />
<span style="color: #000088;">$query</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;SELECT MAX(DOC_VERSION) AS MAX_VERSION, APP_DOC_UID FROM APP_DOCUMENT<br />
&nbsp; &nbsp;WHERE APP_UID = '<span style="color: #006699; font-weight: bold;">$caseId</span>' AND DOC_UID='<span style="color: #006699; font-weight: bold;">$docUID</span>'&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$query</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$g</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> G<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$pathFilename</span> <span style="color: #339933;">=</span> PATH_DOCUMENT <span style="color: #339933;">.</span> <span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getPathFromUID</span><span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #009900;">&#41;</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">'outdocs'</span><span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$result</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_DOC_UID'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">'_'</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$result</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'MAX_VERSION'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">'.html'</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$body</span> <span style="color: #339933;">=</span> <a href="http://php.net/file_get_contents"><span style="color: #990000;">file_get_contents</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$pathFilename</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'theboss@example.com'</span><span style="color: #339933;">,</span> userInfo<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'Generated Output Document'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'outDocMail.html'</span><span style="color: #339933;">,</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'mailBody'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$body</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<p>To send a generated Output Document file as an attachment in an email, see this <a href="#PMFSendMessage.28.29">example</a>.</p>
<p><strong>3.</strong> Generate an Output Document in the current case and then look up the generated Output Document file in the <strong><tt>APP_DOCUMENT</tt></strong> table. Copy the generated DOC and PDF files to another directory in the same server using the <a  href="http://www.php.net/manual/en/function.copy.php">copy()</a> function and to a remote server using the <a  href="http://www.php.net/manual/en/function.ssh2-scp-send.php">ssh2_scp_send()</a> function.</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$caseUID</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span><br />
<span style="color: #000088;">$docUID</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'954109698491477e1986b43042252891'</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//set to the Output Document's unique ID</span><br />
PMFGenerateOutputDocument<span style="color: #009900;">&#40;</span><span style="color: #000088;">$docUID</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #666666; font-style: italic;">//find the generated Output Document in the wf_&lt;WORKSPACE&gt;.APP_DOCUMENT table</span><br />
<span style="color: #000088;">$query</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;SELECT MAX(DOC_VERSION) AS MAX_VERSION, APP_DOC_UID FROM APP_DOCUMENT<br />
&nbsp; &nbsp;WHERE APP_UID = '<span style="color: #006699; font-weight: bold;">$caseUID</span>' AND DOC_UID='<span style="color: #006699; font-weight: bold;">$docUID</span>'&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$query</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$g</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> G<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$docPath</span> <span style="color: #339933;">=</span> PATH_DOCUMENT <span style="color: #339933;">.</span> <span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getPathFromUID</span><span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #009900;">&#41;</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">'outdocs'</span><span style="color: #339933;">.</span> PATH_SEP<span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$filename</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$result</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_DOC_UID'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">'_'</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$result</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'MAX_VERSION'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//copy to another directory on the same server:</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$otherDir</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'C:\path\to\file\\'</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//set to path for another directory</span><br />
&nbsp; &nbsp; <a href="http://php.net/copy"><span style="color: #990000;">copy</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;<span style="color: #006699; font-weight: bold;">$docPath</span><span style="color: #006699; font-weight: bold;">$filename</span>.doc&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;<span style="color: #006699; font-weight: bold;">$otherDir</span><span style="color: #006699; font-weight: bold;">$filename</span>.doc&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//if generating DOC files</span><br />
&nbsp; &nbsp; <a href="http://php.net/copy"><span style="color: #990000;">copy</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;<span style="color: #006699; font-weight: bold;">$docPath</span><span style="color: #006699; font-weight: bold;">$filename</span>.pdf&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;<span style="color: #006699; font-weight: bold;">$otherDir</span><span style="color: #006699; font-weight: bold;">$filename</span>.pdf&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//if generating PDF files</span><br />
<br />
&nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//copy to a remote server:</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$remoteDir</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'/path/to/file/'</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//set to directory path on remote server</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$conn</span> <span style="color: #339933;">=</span> <a href="http://php.net/ssh2_connect"><span style="color: #990000;">ssh2_connect</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'www.example.com'</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">22</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//set to URL for remote server</span><br />
&nbsp; &nbsp; <a href="http://php.net/ssh2_auth_password"><span style="color: #990000;">ssh2_auth_password</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$conn</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'username'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'password'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//set the username and password</span><br />
&nbsp; &nbsp; <a href="http://php.net/ssh2_scp_send"><span style="color: #990000;">ssh2_scp_send</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$conn</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;<span style="color: #006699; font-weight: bold;">$docPath</span><span style="color: #006699; font-weight: bold;">$filename</span>.doc&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;<span style="color: #006699; font-weight: bold;">$remoteDir</span><span style="color: #006699; font-weight: bold;">$filename</span>.doc&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <a href="http://php.net/ssh2_scp_send"><span style="color: #990000;">ssh2_scp_send</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$conn</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;<span style="color: #006699; font-weight: bold;">$docPath</span><span style="color: #006699; font-weight: bold;">$filename</span>.pdf&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;<span style="color: #006699; font-weight: bold;">$remoteDir</span><span style="color: #006699; font-weight: bold;">$filename</span>.pdf&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
    <p><strong>4.</strong> To generate an Output Document file using a script task, create the script task after a user task and in the script call the pmFunction using only the attribute <span class="geshifilter"><code class="text geshifilter-text">outputUID</code></span>. There is no inconvenience as the script task completes the other attributes with the information of the previous task.</p>
    <p><img src="../sites/default/files/scripttask.html"></p>
    <p>But in the particular scenario where a timer event precedes the script task, it is imperative that you send all the attributes to the script task because there is no previous information from which the script task can complete the information.</p>
    <p><img alt="" src="../sites/default/files/scripttask2.html"></p>
<p>As an example you can use the following code as a guide:</p>
<codeblock>PMFGenerateOutputDocument('954109698491477e1986b43042252891', @@APPLICATION, @@INDEX, '00000000000000000000000000000001');</codeblock>
<!-- END DOCUMENT Functions -->

<!-- Dynaform and Field Functions Functions -->
<h2><span id="Dynaform_and_Field_Functions">Dynaform and Field Functions</span></h2>

<h3><span id="PMFDynaFormFields.28.29">PMFDynaFormFields()</span></h3>


<p><code>PMFDynaFormFields()</code> retrieves all the properties of each field in a <a href="../3.0/Dynaforms.html">Dynaform</a>.  If the unique ID and delegation index of a case is specified, it will also retrieve the entered <code>value</code> of each field and its <code>label</code>. Note that the <code>label</code> is the same as the <code>value</code> for textboxes and textareas, but it is the displayed text of a selected option in a dropdown box, suggest box, radio button, checkbox and checkgroup.</p>

<codeblock><i>array</i> <strong>PMFDynaFormFields</strong>(<i>string</i> dynaformUID,<i>string</i> caseUID, <i>string</i> delIndex)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>dynaformUID</strong>: The unique ID of the Dynaform where the fields are located.</li>
    <li><i>string</i> <strong>caseUID</strong>: <i>Optional.</i> The unique ID of a case. If specified, then the values and labels of that case will be inserted into the properties of the Dynaform fields. Make sure that the specified case and the specified Dynaform belong to the same process. The unique ID of a case can be found in the following ways:
<ul><li>Use the <code>@@APPLICATION</code> system variable to get the unique ID of the current case.</li>
    <li>Use the <a href="#PMFCaseList.28.29">PMFCaseList()</a>, <a href="../index.php/Simple_Trigger_Web_Services.html#WSCaseList" title="Simple Trigger Web Services">WSCaseList()</a> or the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#caseList.28.29" title="ProcessMaker WSDL Web Services">caseList()</a> web service.</li>
    <li>Use <a href="#executeQuery.28.29">executeQuery()</a> to look up the case UID in the <strong><tt>wf_&lt;WORKSPACE&gt;.APPLICATION.APP_UID</tt></strong> field in the database.</li></ul>
</li>
<li><i>int</i> <strong>delIndex</strong>: <i>Optional.</i> The delegation index of the case. If specified, then values and labels of that case will be inserted into the properties of the Dynaform fields.  The delegation index starts counting at <code>1</code> for the first task in the case, <code>2</code> for the second task, <code>3</code> for the third task, etc. It  can be found in the following ways:
<ul><li>Use the system variable <code>@%INDEX</code> to get the delegation index of the current case.</li>
<li>Use the <a href="#PMFCaseList.28.29">PMFCaseList()</a>, <a href="../index.php/Simple_Trigger_Web_Services.html#WSCaseList" title="Simple Trigger Web Services">WSCaseList()</a> or the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#caseList.28.29" title="ProcessMaker WSDL Web Services">caseList()</a> web service.</li>
<li>Use <a href="#executeQuery.28.29">executeQuery()</a> to look up the delegation index in the <strong><tt>wf_&lt;WORKSPACE&gt;.APP_CACHE_VIEW.DEL_INDEX</tt></strong> field <code>WHERE DEL_THREAD_STATUS='OPEN'</code>.</li></ul>
</li>
</ul>

<p><strong>Return Value:</strong></p>
<p>An associative array of information about each field contained in the Dynaform specified. The return value will depend on how many and what kind of fields are inside the Dynaform.</p>

<codeblock>[0] <i>array</i>
(
    <i>associative array</i>
    (
        [<i>property1</i>] => value
        [<i>property2</i>] => value
        ...
    )
)
[1] <i>array</i>
(
    <i>associative array</i>
    (
        [<i>property1</i>] => value
        [<i>property2</i>] => value
        ...
    )
...
</codeblock>

<p><strong>Example:</strong></p>
<p>First, create a simple Dynaform with the same fields as the Dynaform in the image below:</p>
<p><img alt="" src="../sites/default/files/PM3_PMFDynaformFieldsDyna.png"></p>
<p>Second, copy the number of the Dynaform:</p>
<p><img alt="" src="../sites/default/files/PM3_PMFDynaformFieldsDynUID.png"></p>
<p>Third, create the following trigger with the number of the Dynaform:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$dynaformUID</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'27103912256c249de083cb5092906174'</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//Replace the number with the number of the Dynaform</span><br />
<span style="color: #339933;">@@</span>AFields <span style="color: #339933;">=</span> PMFDynaFormFields<span style="color: #009900;">&#40;</span><span style="color: #000088;">$dynaformUID</span><span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #339933;">@%</span>INDEX<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
<p>The variable <code>@@Afields</code> will obtain all the information about each field contained in the Dynaform. The return value can be seen using the Processmaker Debugger: </p>
<codeblock>Array (
    [0] => stdClass Object (
        [type] => 'title',
        [id] => 'title0000000001',
        [label] => 'Title Example',
        [colSpan] => 12
    )
    [1] => stdClass Object (
        [type] => 'text',
        [variable] => 'textBox1',
        [var_uid] => '16685188056c249e6219f68020186957',
        [dataType] => 'string',
        [id] => 'textBox1',
        [name] => 'textBox1'
        [label] => 'Textbox'
        [defaultValue] =>
        [placeholder] =>
        [hint] =>
        [required] =>
        [textTransform] => 'none'
        [validate] =>
        [validateMessage] =>
        [maxLength] => 1000
        [formula] =>
        [mode] => 'parent'
        [operation] =>
        [dbConnection] => 'workflow'
        [dbConnectionLabel] => 'PM Database'
        [sql] =>
        [var_name] => 'textBox1'
        [colSpan] => 12
        [optionsSql] => Array ( )
        [data] => stdClass Object (
            [value] =>
            [label] =>
        )
        [value] =>
        [value_label] =>
    )
    [2] => stdClass Object (
        [type] => 'link'
        [id] => 'link0000000001'
        [name] => 'link0000000001'
        [label] => 'Link'
        [value] => 'ProcessMaker'
        [href] => 'http://www.processmaker.com/'
        [hint] =>
        [colSpan] => 6
    )
    [3] => stdClass Object (
        [type] => checkgroup
        [variable] => checkGroup1
        [var_uid] => 15903039956c24a20a69b38089977525
        [dataType] => array
        [id] => checkGroup1
        [name] => checkGroup1
        [label] => checkgroup
        [defaultValue] =>
        [hint] =>
        [required] =>
        [mode] => parent
        [dbConnection] => workflow
        [dbConnectionLabel] => PM Database
        [sql] =>
        [options] => Array (
            [0] => stdClass Object (
                [value] => a
                [label] => aaa
            )
            [1] => stdClass Object (
                [value] => b
                [label] => bbb
            )
        )
        [var_name] => checkGroup1
        [colSpan] => 6
        [optionsSql] => Array ( )
        [data] => stdClass Object (
            [value] =>
            [label] => []
        )
        [value] =>
        [value_label] => []
    )
    [4] => stdClass Object (
        [type] => 'submit'
        [id] => 'submit0000000001'
        [name] => 'submit0000000001'
        [label] => 'submit'
        [colSpan] => 12
    )
)
</codeblock>

<h3><span id="PMFGetDynaformUID.28.29">PMFGetDynaformUID()</span></h3>

<p><code>PMFGetDynaformUID()</code> retrieves the unique ID of a <a href="../3.0/Dynaforms.html">Dynaform</a> using the Dynaform name and, if required, the unique ID of the process.</p>

<codeblock><i>string</i> <strong>PMFGetDynaformUID</strong>(<i>string </i>dynaformName, <i>string</i> processUID)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul>
<li><i>string</i> <strong>dynaformName</strong>: The name of the Dynaform.
</li>
<ul><li><i>string</i> <strong>processUID</strong>: Optional parameter. The unique ID of the process, which can be found in the following ways:
<ul><li>Use the <code>@@PROCESS</code> system variable to get the unique ID of the current process.</li>
<li>Use the <a href="#PMFProcessList.28.29">PMFProcessList()</a> function or <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#processList.28.29" title="3.0/ProcessMaker WSDL Web Services">processList()</a> web service.</li>
<li>Query the <strong><tt>wf_&lt;WORKSPACE&gt;.PROCESS.PRO_UID</tt></strong> field in the database or use a query like:
<div class="geshifilter"><div class="sql geshifilter-sql" style="font-family:monospace;"><span style="color: #993333; font-weight: bold;">SELECT</span> PRO_UID <span style="color: #993333; font-weight: bold;">FROM</span> PROCESS <span style="color: #993333; font-weight: bold;">WHERE</span> PRO_TITLE <span style="color: #66cc66;">=</span> <span style="color: #ff0000;">'Purchase Request Form'</span></div></div>
</li></ul>
</li>
</ul>

<p><strong>Return value:</strong></p>
<ul><li><strong>string</strong>: The function returns the unique ID of the Dynaform.</li></ul>
<p><strong>Example:</strong></p>


<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>dynUID <span style="color: #339933;">=</span> PMFGetDynaformUID<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Purchase Request Form&quot;</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'75150592456d5efe4848088021942802'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
<p>The returned value stored in <code>@@dynUID</code> will be <code>'81917311556d5f0d0622012054540345'</code>.</p>


<h3><span id="PMFgetLabelOption.28.29">PMFgetLabelOption()</span></h3>
<p><code>PMFgetLabelOption()</code> returns the label of a specified option from a dropdown box, listbox, checkgroup or radiogroup.</p>

<p style="margin-left:25px"><strong><font color="red">Warning:</font></strong> <font color="dimgray"> Note that this function cannot be used with fields that have a dependent SQL query set.</font></p>

<codeblock><i>string</i> <strong>PMFgetLabelOption</strong>(<i>string</i> processUID, <i>string</i> dynaformUID, <i>string</i> fieldName, <i>string</i> optionUID)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>processUID</strong>: The unique ID of the process that contains the field. To use the current process, use the system variable <code>@@PROCESS</code>.</li>
    <li><i>string</i> <strong>dynaformUID</strong>: The unique ID of the Dynaform where the field is located.</li>
    <li><i>string</i> <strong>fieldName</strong>: The field name of the dropdown box, checkbox group or radiogroup from the specified Dynaform.</li>
    <li><i>string</i> <strong>optionUID</strong>: The value (i.e., ID) of the option from the <code>fieldName</code>.</li></ul>
<p><strong>Return Value:</strong></p>
<p>A string holding the label of the specified option or NULL if the specified option does not exist.</p>

<p><strong>Example:</strong></p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>countries_lab <span style="color: #339933;">=</span> PMFgetLabelOption<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>PROCESS<span style="color: #339933;">,</span> <span style="color: #0000ff;">'6962405664a55ed3b36b168077366134'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'countries'</span><span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>countries<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p>Where:<br>
  <ul><li>"6962405664a55ed3b36b168077366134": is the UID of the Dynaform that holds the dropdown box.</li>
  <li>"countries": is the name of the field whose values are displayed as options in the dropdown box.</li>
  <li>"@@countries": is a variable that holds the ID of the option that has been selected in the dropdown box.</li>
  </ul>
</p>

<p>To find the label from the selected option in a dropdown box, it is not necessary to use PMFgetLabelOption().</p>

<p>Dropdown boxes have a new attribute called "saveLabel". When set to "1", it permits the value of a label for a selected option to be saved automatically in a variable with the same name as the original variable, but with "_label" added to the end of the variable name. For instance, if trying to find the label of the selected option in the "countries" dropdown box, it can be found in the "@@countries_label" variable.</p>


<h3><span id="PMFRemoveMask.28.29">PMFRemoveMask()</span></h3>
<p>The <code>PMFRemoveMask()</code> function removes the mask of a <i>currency field</i> by deleting the thousands separator (which is a "." (period) or "," (comma) and the currency symbol, such as "$", "â‚¬", "Â£" or "Â¥". Call this function before using a currency field in a mathematical calculation that requires a number rather than a string.</p>

<codeblock><i>string</i> <strong>PMFRemoveMask</strong>(<i>string</i> fields, <i>string</i> separator = '.', <i>string</i> currency='')
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>field</strong>: Value to be stripped of thousands separators and currency symbols.</li></ul>
<ul><li><i>string</i> <strong>separator</strong>: Optional. The thousands separator, which by default is <code>","</code> (comma). In most European and Latin American countries, the thousands separator is <code>"."</code> (a period).</li></ul>
<ul><li><i>string</i> <strong>currency</strong>: Optional. The currency symbol. This parameter is set to an empty string by default, so if the parameter is not set no currency symbol will be removed.</li></ul>
<p><strong>Return Value</strong></p>
<p>A string with the the currency and thousands separator removed.</p>
<p><span style="color: green;"><strong>Note:</strong></span> <font color="dimgrey">PMFRemoveMask() returns a <i>string</i>. In most cases this is not a problem, because PHP will automatically <a  href="http://php.net/manual/en/language.types.string.php#language.types.string.conversion">convert the string into a number</a> if it is used with a mathematical operator (+, -, *, /, %, etc.) or compared (==, !=, &gt;, &gt;=, &lt; or &lt;=) with a number. Nonetheless, it may be a good idea to convert the string into a real number using <a  href="http://php.net/manual/en/function.floatval.php">floatval()</a>, or into an integer using the <a  href="http://php.net/manual/en/function.intval.php">intval()</a> function to avoid potential problems.</font></p>
<p><strong>Example in a trigger:</strong></p>
<p>Use the <code>PMFRemoveMask()</code> function to delete the mask of a value introduced in a currency field named "Amount". Then use the <a  href="http://php.net/manual/en/function.is-numeric.php">is_numeric()</a> function to check whether it can be converted into a number. If so, then convert it to a real number and then subtract 10% from the amount for a discount. If not a valid number, then use the <code>G:SendMessageText()</code> function to display a warning message to the user on the next screen:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$amount</span> <span style="color: #339933;">=</span> PMFRemoveMask<span style="color: #009900;">&#40;</span><span style="color: #339933;">@=</span>Amount<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;,&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;$&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_numeric"><span style="color: #990000;">is_numeric</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$amount</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$amount</span> <span style="color: #339933;">=</span> <a href="http://php.net/floatval"><span style="color: #990000;">floatval</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$amount</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #339933;">@=</span>Discount <span style="color: #339933;">=</span> <span style="color: #000088;">$amount</span> <span style="color: #339933;">-</span> <span style="color: #000088;">$amount</span> <span style="color: #339933;">*</span> <span style="color:#800080;">0.10</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
<span style="color: #b1b100;">else</span> <span style="color: #009900;">&#123;</span> <span style="color: #666666; font-style: italic;">//if not a valid number, then display warning message</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$g</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> G<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">SendMessageText</span><span style="color: #009900;">&#40;</span><span style="color: #339933;">@=</span>Amount <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot; is not a valid amount.&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;WARNING&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<p>For instance, if the value of <code>@=Amount</code> is <code>"$5,000.00"</code>, then it will be converted into <code>"5000.00"</code> and <code>floatval()</code> will convert it into <code>5000.00</code> (a real number). Notice that the comma (<strong>,</strong>) and the dollar sign (<strong>$</strong>) were removed from the string.</p>
<p><font color="green"><strong>Note:</strong></font> <font color="dimgrey">Case variables that are passed as the first parameter of <code>PMFRemoveMask()</code> should be referenced as <code>@@<i>field-name</i></code> or <code>@=<i>field-name</i></code>, so that they are maintained as text. Do NOT use <code>@#<i>field-name</i></code> or <code>@%<i>field-name</i></code>, since PHP will try to convert the value to a number, which probably will not work correctly, depending on the mask.</font></p>
<p><strong>Example in a condition:</strong></p>
<p>Depending on the value introduced in a field, the following condition is used to decide whether the workflow moves to subsequent task(s):</p>

<codeblock>(PMFRemoveMask(@=Amount, ",", "$") >= 100 and PMFRemoveMask(@=Amount, ".", "$") <= 10000)
</codeblock>

<p>This condition can be used inside an evaluation routing rule:</p>
<p><img alt="" src="../sites/default/files/3.0PMFRemoveMaskRoutingRule.png"></p>

<!-- END Dynaform and Field Functions Functions -->


<!-- EMAIL Functions -->
<h2><span id="Email_Functions">Email Functions</span></h2>


<h3><span id="getEmailConfiguration.28.29">getEmailConfiguration()</span></h3>
<p><code>getEmailConfiguration()</code> returns information about the current email configuration.</p>

<codeblock><i>array</i> <strong>getEmailConfiguration</strong>()
</codeblock>

<p><strong>Return Value:</strong></p>
<p>Returns an associative array with the following information about the email configuration:</p>

<table class="codecolumn">
    <tr>
        <td>array( </td>
        <td></td>
    </tr>
    <tr>
        <td> "MESS_PASSWORD", </td>
        <td>Encrypted password used to log in to the email server, such as: <code>"vKbAqYO+urusxc6+xbp+eIF9"</code></td>
    </tr>
    <tr>
        <td> "MESS_PASSWORD_HIDDEN", </td>
        <td>Always set to <code>""</code> (empty string).</td>
    </tr>
    <tr>
        <td> "MESS_ENABLED", </td>
        <td>Set to "1" if email notifications are enabled. If not enabled, set to <code>"0"</code>.</td>
    </tr>
    <tr>
        <td> "MESS_ENGINE", </td>
        <td>The email engine, which can be <code>"PHPMAILER"</code> to use the PHPMailer program that supports SMTP,
            or <code>"MAIL"</code> to use PHP's mail() function to send the email via the mail transfer agent configured
            for the ProcessMaker server.</td>
    </tr>
    <tr>
        <td> "MESS_SERVER", </td>
        <td>The IP number or domain name of the email server, such as: <code>"smtp.mail.yahoo.com"</code></td>
    </tr>
    <tr>
        <td> "MESS_RAUTH", </td>
        <td>Set to
            <span class="geshifilter"><code class="php geshifilter-php"><span style="color: #009900; font-weight: bold;">true</span></code></span> if login needed to send out messages; otherwise set to
            <span class="geshifilter"><code class="php geshifilter-php"><span style="color: #009900; font-weight: bold;">false</span></code></span>.</td>
    </tr>
    <tr>
        <td> "MESS_PORT", </td>
        <td>Port number of the email server, such as <code>"25"</code>, <code>"465"</code> or <code>"587"</code>.</td>
    </tr>
    <tr>
        <td> "MESS_ACCOUNT", </td>
        <td>The username of the email account. For some email servers, such as Gmail, the account name includes the
            full email address, such as:"joedoe@gmail.com"</td>
    </tr>
    <tr>
        <td> "MESS_BACKGROUND", </td>
        <td>HTML code of the background to the email message. Generally set to <code>""</code> (no background).</td>
    </tr>
    <tr>
        <td> "MESS_EXECUTE_EVERY", </td>
        <td>Time between attempts to send message. If set to <code>""</code>, then uses the default.</td>
    </tr>
    <tr>
        <td> "MESS_SEND_MAX", </td>
        <td>Maximum number of attempts to send the message. If set to "", then uses the default.</td>
    </tr>
    <tr>
        <td> "SMTPSecure", </td>
        <td>The type of secure connection to the email server: <code>"ssl"</code>, <code>"tls"</code> or <code>""</code>            (empty string for no secure connection)</td>
    </tr>
    <tr>
        <td> "MAIL_TO", </td>
        <td>Email address to whom the test email will be sent.</td>
    </tr>
    <tr>
        <td> "MESS_FROM_NAME", </td>
        <td>Name of the sender, such as: "ProcessMaker Admin"</td>
    </tr>
    <tr>
        <td> "MESS_TRY_SEND_INMEDIATLY",</td>
        <td>Set to <code>"1"</code> to send out a test email after configuring the email server or <code>"false"</code>            to not send it.</td>
    </tr>
    <tr>
        <td> "MESS_FROM_MAIL", </td>
        <td>Email address of the sender of emails. In most cases this will be the same as the email account.</td>
    </tr>
    <tr>
        <td>) </td>
        <td></td>
    </tr>
</table>

<p><strong>Example:</strong><br>Check whether email notifications are enabled before sending out an email with PMFSendMessage():</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$aEmailConfig</span> <span style="color: #339933;">=</span> getEmailConfiguration<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$aEmailConfig</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'MESS_ENABLED'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">===</span> <span style="color: #0000ff;">&quot;1&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'accountant@acme.com'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'manager@acme.com'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'Accounting report'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'accountingTemplate.html'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>



<h3><span id="PMFAddAttachmentToArray.28.29">PMFAddAttachmentToArray()</span></h3>

<p>The <strong><code>PMFAddAttachmentToArray()</code></strong> function is used to add an additional file to an array of files, which can be passed to the <a href="#PMFSendMessage.28.29">PMFSendMessage()</a> function to send out emails with attached files. If a file with the same filename already exists in the array, it will add the file to the array, but rename its index key from "<i><strong><tt>filename.ext</tt></strong></i>" to "<strong><tt><i>filename</i> Copy(<i>X</i>).<i>ext</i></tt></strong>" where <i><strong><tt>X</tt></strong></i> is incremented so the original file doesn't get replaced.</p>

<codeblock><i>array</i> <strong>PMFAddAttachmentToArray</strong>(<i>array</i> arrayData, <i>string</i> index, <i>string</i> value, <i>string</i> suffix)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>array</i> <strong>arrayData</strong>: An existing associative array of files, where the index key is the filename and the value is the file. To understand the format of this array, see the <code>aAttachments</code> parameter of the <a href="#PMFSendMessage.28.29">PMFSendMessage()</a> function.</li>
    <li><i>string</i> <strong>index</strong>: The new filename of the file to be added, which will also be the new index in the associative array of files. Note that the added file will be renamed with this value, so it is recommended to include the file extension, such as <strong><code>.doc</code></strong>, <strong><code>.pdf</code></strong>, etc.</li>
    <li><i>string</i> <strong>value</strong>: The web address or the path on the ProcessMaker server of the file to be added to the array.</li>
    <li><i>string</i> <strong>suffix</strong>: Optional parameter. A string that will concatenated to the <code>index</code> if the filename already exists in the array. Its default value is <strong><code>" Copy({i})"</code></strong>, where <strong><code>{i}</code></strong> will be replaced by an auto-incremented number.</li></ul>
<p><strong>Return Value:</strong></p>
<p>The modified associative array of files, with the new file added to it. This return value can be used as the <code>aAttachments</code> parameter in the <a href="#PMFSendMessage.28.29">PMFSendMessage()</a> function.</p>
<p><strong>Example:</strong><br>In this example, the paths to 4 different files named "expenseReport.doc", "accountingGuide.pdf", "expenseReport.doc" and "expenseReport.doc" are in an array. Each file from the array is added as an attachment file to an email. The PMFAddAttachmentToArray() function is used avoid overwriting the existing files in the array of file attachments. Then PMFSendMessage() is used to send out the email with the file attachments.</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$aFiles</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;http://www.acme.com/reports/expenseReport.doc&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; PATH_DATA_PUBLIC <span style="color: #339933;">.</span> <span style="color: #339933;">@@</span>PROCESS <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;accountingGuide.pdf&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;/home/accounting/2014-Nov/expenseReport.doc&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;/home/accounting/2014-Dec/expenseReport.doc&quot;</span><br />
<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$aAttachments</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$aFiles</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$file</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$aAttachments</span> <span style="color: #339933;">=</span> PMFAddAttachmentToArray<span style="color: #009900;">&#40;</span><span style="color: #000088;">$aAttachments</span><span style="color: #339933;">,</span> <a href="http://php.net/basename"><span style="color: #990000;">basename</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$file</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #000088;">$file</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'accountant@acme.com'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'manager@acme.com'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp;<span style="color: #0000ff;">'3 months of expense reports'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'monthlyExpenses.html'</span><span style="color: #339933;">,</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #000088;">$aAttachments</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p>The above trigger code will send an email to manager@acme.com with the attached files named "expenseReport.doc", "accountingGuide.pdf", "expenseReport Copy(2).doc" and "expenseReport Copy(3).doc".</p>


<h3><span id="PMFGetUserEmailAddress.28.29">PMFGetUserEmailAddress()</span></h3>
<p><code>PMFGetUserEmailAddress()</code> returns the email addresses of the specified user(s).</p>

<codeblock><i>variant</i> <strong>PMFGetUserEmailAddress</strong>(<i>variant</i> ID, <i>string</i> APP_UID=null, <i>string</i> prefix='usr')
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>variant</i> <strong>ID</strong>:</code> A list of recipients, which can be a mixture of user IDs, group IDs, variable names or email addresses. To find the IDs of the users and groups, go to <strong>ADMIN &gt; Settings &gt; Web Services Test</strong> and use the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#User_List" title="ProcessMaker WSDL Web Services">userList()</a> and <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#Group_List" title="ProcessMaker WSDL Web Services">groupList()</a> web services, or look them up in the <strong><tt>wf_&lt;WORKSPACE&gt;.USERS.USR_UID</tt></strong> field or in <strong><tt>wf_&lt;WORKSPACE&gt;.GROUPWF.GRP_UID</tt></strong> field in the database. This list can either be an array with each recipient in a separate element, or a string with each recipient separated by commas ",". If the recipients are all the same type, then set that type in the <code>$prefix</code> parameter. If the list contains a mix of different types, then prepend <code>"usr|"</code>, <code>"grp|"</code>, <code>"dyn|"</code> or <code>"ext|"</code> before each recipient. For the user currently assigned to a case, use <code>"-1"</code> or <code>"usr|-1"</code>.</li>

    <li><i>string</i> <strong>$APP_UID</strong>:</code> The unique of the ID of the case from which the emails will be retrieved.  Notice that the result value will be obtained from the last open delegation of the case specified. If using a variable to get the currently assigned user, specify the unique ID of the case that contains this variable. If using "<b>-1</b>" as the first value to obtain the user currently assigned to the case's email, then the second parameter has to be  <code>@@APPLICATION</code>.</li>

    <li><i>string</i> <strong>$prefix</strong>:</code> An optional parameter. Specify the type for <i>all</i> the recipients in the list:
<ul><li><code>"usr":</code> All the recipients are users, so the <code>ID</code> is a list of the user's unique IDs. This is the default value if the parameter is not included.</li>
    <li><code>"grp":</code> All the recipients are groups, so the <code>ID</code> is a list of the group's unique IDs.</li>
    <li><code>"dyn":</code> All the recipients are variables, so the <code>ID</code> is a list of case variable names from the case specified in the $APP_UID parameter.</li>
    <li><code>"ext":</code> All the recipients have external email addresses, so the <code>ID</code> is a list of email addresses.</li></ul>
</li>
</ul>
<div style="line-height: 19.0499992370605px; margin-left: 20px;"><p>If the <code>ID</code> has mixed types of recipients, then do not include this parameter and specify the type in the <code>$id</code>, separated by vertical bars "|".</p></div>
<p><strong>Return Value:</strong><br>A list of email addresses. If the <code>$id</code> is a string, then a string will be returned with each email address separated by commas. If the <code>$id</code> was an array, then an array of email addresses will be returned. If there were no valid recipients in the <code>$id</code>, then the function returns <code>false</code>.</p>

<p><strong>Examples:</strong><br>Send an email to the user assigned to the current case:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$to</span> <span style="color: #339933;">=</span> PMFGetUserEmailAddress<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'-1'</span><span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;boss@example.com&quot;</span><span style="color: #339933;">,</span> <span style="color: #000088;">$to</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'Reminder Notice'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'reminderNote.html'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p>To send an email to the currently assigned user and two users with the IDs "79498307748c8645cbed0d2037379255" and "6187429034914a77c452de6051925565" in the current case:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$to</span> <span style="color: #339933;">=</span> PMFGetUserEmailAddress<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'-1, 79498307748c8645cbed0d2037379255, 6187429034914a77c452de6051925565'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;boss@example.com&quot;</span><span style="color: #339933;">,</span> <span style="color: #000088;">$to</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'Reminder Notice'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'reminderNote.html'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p>To do the same thing with an array of recipients:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$aTo</span> <span style="color: #339933;">=</span> PMFGetUserEmailAddress<span style="color: #009900;">&#40;</span><a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'-1'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'79498307748c8645cbed0d2037379255'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'6187429034914a77c452de6051925565'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$sTo</span> <span style="color: #339933;">=</span> <a href="http://php.net/implode"><span style="color: #990000;">implode</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">','</span> <span style="color: #000088;">$aTo</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//convert to a string with emails separated by commas</span><br />
PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;boss@example.com&quot;</span><span style="color: #339933;">,</span> <span style="color: #000088;">$sTo</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'Reminder Notice'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'reminderNote.html'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p>Send out an email to the user IDs found in the case variables <code>@@StoreManager</code>, <code>@@RegionalManager</code>, and <code>@@CEO</code> in the current case:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$to</span> <span style="color: #339933;">=</span> PMFGetUserEmailAddress<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'StoreManager, RegionalManager, CEO'</span><span style="color: #339933;">,</span> <span style="color: #009900; font-weight: bold;">null</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'dyn'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'boss@example.com'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$to</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'Reminder Notice'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'reminderNote.html'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p>Send out the same email as above, but use the case variables of a case with the ID "1014502514e4556596e2e29033579043":</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$to</span> <span style="color: #339933;">=</span> PMFGetUserEmailAddress<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'StoreManager, RegionalManager, CEO'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'1014502514e4556596e2e29033579043'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'dyn'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'1014502514e4556596e2e29033579043'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'boss@example.com'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$to</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'Reminder Notice'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'reminderNote.html'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p>Send an email to users, groups, variables and email addresses. In this example, the email is sent to the user currently assigned to the current case, all the members of a group with the UID of "6538387794e45573cdaa563079341214", a user whose UID is specified in the field "selectedManager" in a Dynaform, and to the email address "john_doe@example.com":</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$ids</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'usr|-1, grp|6538387794e45573cdaa563079341214, dyn|selectedManager, ext|john_doe@example.com'</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$to</span> <span style="color: #339933;">=</span> PMFGetUserEmailAddress<span style="color: #009900;">&#40;</span><span style="color: #000088;">$ids</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'boss@example.com'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$to</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'Reminder Notice'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'reminderNote.html'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p>To do the same thing, using an array:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$aIds</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'usr|-1'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'grp|6538387794e45573cdaa563079341214'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'dyn|selectedManager'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'ext|john_doe@example.com'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$aTo</span> <span style="color: #339933;">=</span> PMFGetUserEmailAddress<span style="color: #009900;">&#40;</span><span style="color: #000088;">$aIds</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$sTo</span> <span style="color: #339933;">=</span> <a href="http://php.net/implode"><span style="color: #990000;">implode</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">','</span><span style="color: #339933;">,</span> <span style="color: #000088;">$aTo</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'boss@example.com'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$sTo</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'Reminder Notice'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'reminderNote.html'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>


<h3><span id="PMFSendMessage.28.29">PMFSendMessage()</span></h3>
<p>The <strong><code>PMFSendMessage()</code></strong> function sends out customized email notifications using a template. For more information, see <a href="Notifications.html#Trigger_Messages" title="Notifications">Trigger Messages</a>.</p>

<codeblock><i>int</i> <strong>PMFSendMessage</strong>(<i>string</i> caseUID, <i>string</i> from, <i>string</i> to, <i>string</i> cc, <i>string</i> bcc, <i>string</i> subject, <i>string</i> template, <i>array</i> aFields=array(), <i>array</i> aAttachments=array(), <i>boolean</i> showMessage=true, <i>int</i> delIndex=0, <i>array</i> config=array())
</codeblock>

<p><strong>Parameters:</strong></p>
<p>
<ul>
    <li><i>string</i> <strong>caseUID</strong>: The UID (unique identification) of a case, which is a string of 32 hexadecimal characters that uniquely identifies each individual case. For the current case use the system variable <code>@@APPLICATION</code>. Other case UIDs can be found with the <a href="#PMFCaseList.28.29">PMFCaseList()</a> function, the <a href="../index.php/Simple_Trigger_Web_Services.html#WSCaseList" title="Simple Trigger Web Services">WSCaseList()</a> function, the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#caseList.28.29" title="ProcessMaker WSDL Web Services">caseList()</a> web service, or by using the <a href="../3.0/ProcessMaker_Functions.html#executeQuery.28.29" title="ProcessMaker Functions">executeQuery()</a> function to query the <strong><tt>wf_&lt;WORKSPACE&gt;.APPLICATION.APP_UID</tt></strong> field in the database.</li>
    <li><p><i>string</i> <strong>from</strong>: The email address of the person who sends out the email. Use the <a href="#userInfo.28.29" title="ProcessMaker Functions">userInfo()</a> function to get a user's email address. If it is necessary to include the person's name along with the email address, list the name first followed by the email address enclosed inside angle brackets <strong><code>&lt; &gt;</code></strong>. The name may be enclosed inside double quotations, but it isn't necessary:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #0000ff;">'Liliana Iriarte &lt;liliana@example.com&gt;'</span></div></div>
<p><i><font color="green">or</font></i></p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #0000ff;">'&quot;Liliana Iriarte&quot; &lt;liliana@example.com&gt;'</span></div></div>

<p><strong><font color="green">Note:</font></strong> <font color="dimgrey">Due to security restrictions, Yahoo!, Gmail and many other email providers will no longer deliver email that doesn't come from the same email address as the account in the <a href="../3.0/Email_Settings.html#Email_Configuration" title="3.0/Email Settings">Email Configuration</a> at <strong>Admin &gt; Settings &gt; Email</strong>. To avoid this problem, set the email address for the <strong><code>from</code></strong> parameter to the same email address found in the email configuration.</font></p>
</li>
<li><i>string</i> <strong>to</strong>: The email address(es) to whom the email is sent. If there are multiple recipients, separate each email address with a comma ",". If it is necessary to include the person's name along with the email address, list the name first followed by the email address enclosed inside angle brackets <strong><code>&lt; &gt;</code></strong> as shown above. Use the <a href="#userInfo.28.29" title="ProcessMaker Functions">userInfo()</a> function to get a user's email address.</li>
<li><i>string</i> <strong>cc</strong>: The email address(es) of the people who will receive carbon copies of the email. If there are multiple recipients, separate each email address with a comma. Use the <a href="#userInfo.28.29" title="ProcessMaker Functions">userInfo()</a> function to get a user's email address.</li>
<li><i>string</i> <strong>bcc</strong>: The email address(es) of the people who will receive blind carbon copies of the email. Unlike a normal carbon copy, the other recipients won't see who has received blind carbon copies. If there are multiple recipients, separate each email address with a comma. Use the <a href="#userInfo.28.29" title="ProcessMaker Functions">userInfo()</a> function to get a user's email address.</li>
<li><i>string</i> <strong>subject</strong>: The subject (title) of the email.</li>
<li><p><i>string</i> <strong>template</strong>: The name of the template file in plain text or HTML format that will produce the body of the email. Include the file extension in the file name (i.e. <code>"negativeResponse.html"</code> or <code>"caseStatus.txt"</code>).</p>

    <p>The template file must be located in the <strong>mailTemplates</strong> directory of the <a href="../3.0/Process_Files_Manager.html" title="Process Files Manager">Process Files Manager</a> of the current process (which is stored in the <strong><tt>shared/sites/&lt;WORKSPACE&gt;/mailTemplates/&lt;PROCESS-UID&gt;/</tt></strong> directory in the server's file system). The template file can contain system variables, case variables (which weren't defined in the same trigger), or any variables that are passed in the <strong><code>fields</code></strong> parameter. See <a href="Notifications.html" title="Notifications">Notifications</a> to learn how to insert variables into an email template.</p>
    </li>
<li><i>array</i> <strong>fields</strong>: Optional parameter to define custom variables that can be inserted into the template file. The fields parameter is an associative array where the keys are the variable's name and the values are the variable's value. If no array is included, an empty array is included by default. Case variables defined in the same trigger that calls <code>PMFSendMessage()</code> should be passed to the email template using the <code>fields</code> array. See the example below for how to set the values in the <code>fields</code> array.</li>
<li><p><i>array</i> <strong>aAttachments</strong>: <i>Optional.</i> An array of complete paths of files to attach to the email. The paths can be web addresses or paths in the file system of the server where ProcessMaker is installed. For example:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'/home/foobar/clients/client_03452342.xls'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'/var/www/public/profile.pdf'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'http://www.example.com/finances.doc'</span><span style="color: #009900;">&#41;</span></div></div>

<p>By default, files are attached using their original file names, which means that Input Documents, Output Documents and attached files are sent with filenames containing their unique ID and version number. It is possible to rename file attachments by setting the new filename as the array key. For example:</p>

    <div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$g</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> G<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;InvoiceForJohnDoe.xls&quot;</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;/home/foobar/clients/client_03452342.xls&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;scannedInvoice.png&quot;</span> <span style="color: #339933;">=&gt;</span> PATH_DOCUMENT <span style="color: #339933;">.</span> <span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getPathFromUID</span><span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #009900;">&#41;</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;9743702654e6925b52e1e34098864192_1.png&quot;</span><br />
<span style="color: #009900;">&#41;</span></div></div>

    <p>If sending files stored by ProcessMaker, it is recommended to use ProcessMaker's predefined system constants, such as <code>PATH_DATA_PUBLIC</code>, <code>PATH_DATA_MAILTEMPLATES</code>, <code>PATH_DOCUMENT</code> and <code>PATH_SEP</code>, to construct the paths:</p>

    <ul>
<li>Files in the "public" directory of the <a href="../3.0/Process_Files_Manager.html" title="Process Files Manager">Process Files Manager</a>:

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">PATH_DATA_PUBLIC <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;&lt;PROCESS-UID&gt;&quot;</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;&lt;FILENAME&gt;&quot;</span></div></div>
        <p>Example:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">PATH_DATA_PUBLIC <span style="color: #339933;">.</span> <span style="color: #339933;">@@</span>PROCESS <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;letterheadLogo.png&quot;</span></div></div>
       </li>
<li>Template files (without inserted data) in the "mailTemplates" directory of the <a href="../3.0/Process_Files_Manager.html" title="Process Files Manager">Process Files Manager</a>:
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">PATH_DATA_MAILTEMPLATES <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;&lt;PROCESS-UID&gt;&quot;</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;&lt;FILENAME&gt;&quot;</span></div></div>
            <p>Example:</p>
      <div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">PATH_DATA_MAILTEMPLATES <span style="color: #339933;">.</span> <span style="color: #339933;">@@</span>PROCESS <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;companyProfile.html&quot;</span></div></div>
</li>
<li>Uploaded <a href="../3.0/Input_Documents.html" title="3.0/Input Documents">Input Document</a> files and attached <a href="../3.0/File_control.html" title="3.0/Files">files</a>:
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">PATH_DOCUMENT <span style="color: #339933;">.</span> <span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getPathFromUID</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;&lt;CASE-UID&gt;&quot;</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;&lt;CASE-DOC-UID&gt;_&lt;VERSION&gt;.&lt;EXTENSION&gt;&quot;</span></div></div>
          <p>Example:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">PATH_DOCUMENT <span style="color: #339933;">.</span> <span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getPathFromUID</span><span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #009900;">&#41;</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;9743702654e6925b52e1e34098864192_1.png&quot;</span></div></div>
</li>
<li>Generated <a href="../3.0/Output_Documents.html" title="3.0/Output Documents">Output Document</a> files:
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">PATH_DOCUMENT <span style="color: #339933;">.</span> <span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getPathFromUID</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;&lt;CASE-UID&gt;&quot;</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;outdocs&quot;</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;&lt;CASE-DOC-UID&gt;_&lt;VERSION&gt;.&lt;EXTENSION&gt;&quot;</span></div></div>

    <p>Example:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">PATH_DOCUMENT <span style="color: #339933;">.</span> <span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getPathFromUID</span><span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #009900;">&#41;</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;outdocs&quot;</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;6960198894e6927e0a40b14004833875_2.pdf&quot;</span></div></div>
</li>
<li>Files uploaded in the <b>Home > Documents</b> interface, which aren't attached to a case:
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">PATH_DOCUMENT <span style="color: #339933;">.</span> <span style="color: #0000ff;">'00000000000000000000000000000000'</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getPathFromUID</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;&lt;CASE-DOC-UID&gt;&quot;</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">.</span><span style="color: #0000ff;">'_&lt;VERSION&gt;.&lt;EXTENSION&gt;&quot;</span></div></div>
    <p>Example:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">PATH_DOCUMENT <span style="color: #339933;">.</span> <span style="color: #0000ff;">'00000000000000000000000000000000'</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span><span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getPathFromUID</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'965821362588279cb660237001025225'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">.</span> <span style="color: #0000ff;">'_1.png'</span></div></div>
</li>
</ul>
</li>
<li><i>boolean</i> <strong>showMessage</strong>: Optional. If set to <strong><code>true</code></strong>, which is the default, the the email message will be displayed in the <a href="Cases.html#Message_History" title="3.0/Cases">message history</a>. If set to <strong><code>false</code></strong>, then the email message will not be displayed in the message history, although a record of the email will still be stored in the <strong><tt>APP_MESSAGE</tt></strong> table.</li>
<li><i>int</i> <strong>delIndex</strong>: Optional. If not set to 0, the message will be associated with a particular task in the case, which is indicated by its delegation index. The delegation index for the current case is stored in the system variable <code>@%INDEX</code>. Note that the delegation index changes with each new task in the case, so look up the index in the <strong><tt>APPLICATION.DEL_INDEX</tt></strong> field before calling this function.</li>
<li><i>array</i> <strong>config</strong>: Optional parameter available in Enterprise Edition to configure an alternative email server to send the message. See <a href="../3.0/Email_Settings.html#Sending_Emails_from_Different_Accounts" title="3.0/Sending Emails from Different Accounts">Use an alternative email server</a>.</li>
</ul>
</p>
<p><strong>Return Value:</strong></p>
<p>Returns 1 if email was sent to the configured <a href="../3.0/Email_Settings.html" title="Email Settings">email server</a>; otherwise, returns 0 if an error occurred.</p>
<p><strong>When the Trigger Should be Set to Fire:</strong></p>
<p>The PMFSendMessage() function can be used in triggers set to fire AFTER a Dynaform step.</p>
<p><strong>Example Sending Variables to a Template:</strong></p>
<p>The following trigger code is used to send an email template named "LeaveRequestTemplate.html" to the user working on the current case. An array of variables is passed to <code>PMFSendMessage()</code>, so the <code>@#reqUserName</code>, <code>@#reqSup</code>, <code>@#fromReq</code>, <code>@#toReq</code> and <code>@#daysReq</code> fields will be filled in the template:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$aFields</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'reqUserName'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #339933;">@=</span>reqUserName<span style="color: #339933;">,</span> <span style="color: #0000ff;">'reqSup'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #339933;">@=</span>reqSup<span style="color: #339933;">,</span><br />
&nbsp; &nbsp;<span style="color: #0000ff;">'fromReq'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #339933;">@=</span>fromReq<span style="color: #339933;">,</span> <span style="color: #0000ff;">'toReq'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #339933;">@=</span>toReq<span style="color: #339933;">,</span> <span style="color: #0000ff;">'daysReq'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #339933;">@=</span>daysReq<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$usr</span> <span style="color: #339933;">=</span> userInfo<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$to</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$usr</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'manager@acme.com'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$to</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'ceo@acme.com, cfo@acme.com'</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp;<span style="color: #0000ff;">'Leave Request Notification'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'LeaveRequestTemplate.html'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$aFields</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p><strong>Example Emailing Attachments from the Process Files Manager:</strong></p>
<p>The following trigger sends two files named "companyLogo.png" and "companyProfile.pdf", which are stored in the "public" directory of the <a href="../3.0/Process_Files_Manager.html" title="Process Files Manager">Process Files Manager</a>:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$aAttachFiles</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><br />
&nbsp; &nbsp; PATH_DATA_PUBLIC <span style="color: #339933;">.</span> <span style="color: #339933;">@@</span>PROCESS <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">'companyLogo.png'</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; PATH_DATA_PUBLIC <span style="color: #339933;">.</span> <span style="color: #339933;">@@</span>PROCESS <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">'companyProfile.pdf'</span><br />
<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$usr</span> <span style="color: #339933;">=</span> userInfo<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'manager@acme.com'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$usr</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp;<span style="color: #0000ff;">'Company Information'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'companyInfoTemplate.html'</span><span style="color: #339933;">,</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #000088;">$aAttachFiles</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p><strong>Example Emailing Input Document Files:</strong></p>
<p>This trigger emails all the uploaded files in an Input Document whose definition has the ID "8935316924e692b256860c4075654232".</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$inDocDef</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;8935316924e692b256860c4075654232&quot;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//set to the Input Document definition's unique ID</span><br />
<span style="color: #000088;">$caseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//Unique ID for the current case</span><br />
<span style="color: #000088;">$aAttachFiles</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #000088;">$inDocQuery</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;SELECT APP_DOC_UID, DOC_VERSION, APP_DOC_FILENAME AS FILENAME<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FROM APP_DOCUMENT<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;WHERE APP_UID = '<span style="color: #006699; font-weight: bold;">$caseId</span>' AND DOC_UID = '<span style="color: #006699; font-weight: bold;">$inDocDef</span>'<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;AND APP_DOC_TYPE = 'INPUT' AND APP_DOC_STATUS = 'ACTIVE'&quot;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #000088;">$inDocs</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$inDocQuery</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$inDocs</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$inDocs</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$inDoc</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$g</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> G<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$aAttachFiles</span><span style="color: #009900;">&#91;</span><span style="color: #000088;">$inDoc</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'FILENAME'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> PATH_DOCUMENT <span style="color: #339933;">.</span> <span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getPathFromUID</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$caseId</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000088;">$inDoc</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_DOC_UID'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">'_'</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$inDoc</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'DOC_VERSION'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">'.'</span> <span style="color: #339933;">.</span> <a href="http://php.net/pathinfo"><span style="color: #990000;">pathinfo</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$inDoc</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'FILENAME'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> PATHINFO_EXTENSION<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span><br />
<span style="color: #000088;">$usr</span> <span style="color: #339933;">=</span> userInfo<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'manager@acme.com'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$usr</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp;<span style="color: #0000ff;">'Client documents'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'clientTemplate.html'</span><span style="color: #339933;">,</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #000088;">$aAttachFiles</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<dl>
    <dd><strong><font color="green">Note:</font></strong> <font color="dimgrey">This example only emails the latest version of input document files. To email all versions, remove from the query: <code>AND AD.APP_DOC_STATUS='ACTIVE'</code></font></dd>
</dl>
<dl>
    <dd><font color="dimgrey">To email all uploaded files from a case, remove from the query: <code>AND AD.DOC_UID='$inDocDef'</code></font></dd>
</dl>
<p><strong>Example Emailing a File Uploaded to a Dynaform's File Field:</strong></p>
<p>This trigger emails all the files uploaded to <a href="../3.0/File_control.html" title="3.0/Files">file</a> fields in the current case:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$aAttachFiles</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$caseUID</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//Unique ID for the current case</span><br />
<span style="color: #000088;">$docQuery</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;SELECT APP_DOC_UID, DOC_VERSION, APP_DOC_FILENAME AS FILENAME<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FROM APP_DOCUMENT<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;WHERE APP_UID = '<span style="color: #006699; font-weight: bold;">$caseUID</span>'<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;AND APP_DOC_TYPE = 'ATTACHED' AND APP_DOC_STATUS = 'ACTIVE'&quot;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #000088;">$docs</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$docQuery</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$docs</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$docs</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$doc</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000088;">$g</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> G<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000088;">$aAttachFiles</span><span style="color: #009900;">&#91;</span><span style="color: #000088;">$doc</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'FILENAME'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> PATH_DOCUMENT <span style="color: #339933;">.</span> <span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getPathFromUID</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$caseUID</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000088;">$doc</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_DOC_UID'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">'_'</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$doc</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'DOC_VERSION'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">'.'</span> <span style="color: #339933;">.</span> <a href="http://php.net/pathinfo"><span style="color: #990000;">pathinfo</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$doc</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'FILENAME'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> PATHINFO_EXTENSION<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span><br />
<span style="color: #000088;">$usr</span> <span style="color: #339933;">=</span> userInfo<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'manager@acme.com'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$usr</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp;<span style="color: #0000ff;">'Invoices for case'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'invoiceInfo.html'</span><span style="color: #339933;">,</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #000088;">$aAttachFiles</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p><strong>Example Emailing Generated Output Document Files:</strong></p>
<p>This trigger emails the PDF and DOC files of the latest version of an Output Document whose definition has the ID "691319281570bc9938b4460028767596".</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #666666; font-style: italic;">//set to the Output Document definition's unique ID:</span><br />
<span style="color: #000088;">$outDocDef</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;691319281570bc9938b4460028767596&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$caseUID</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//Unique ID for the current case</span><br />
<span style="color: #000088;">$aAttachFiles</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #000088;">$outDocQuery</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;SELECT APP_DOC_UID, DOC_VERSION, APP_DOC_FILENAME AS FILENAME<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FROM APP_DOCUMENT<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WHERE APP_UID='<span style="color: #006699; font-weight: bold;">$caseUID</span>' AND DOC_UID='<span style="color: #006699; font-weight: bold;">$outDocDef</span>'<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AND APP_DOC_TYPE = 'OUTPUT' AND APP_DOC_STATUS = 'ACTIVE'<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ORDER BY DOC_VERSION DESC;<br />
<br />
<span style="color: #006699; font-weight: bold;">$outDoc</span> = executeQuery(<span style="color: #006699; font-weight: bold;">$outDocQuery</span>);<br />
<br />
if (!empty(<span style="color: #006699; font-weight: bold;">$outDoc</span>)) {<br />
&nbsp; &nbsp;<span style="color: #006699; font-weight: bold;">$g</span> = new G();<br />
&nbsp; &nbsp;<span style="color: #006699; font-weight: bold;">$path</span> = PATH_DOCUMENT . <span style="color: #006699; font-weight: bold;">$g-&gt;getPathFromUID</span>(<span style="color: #006699; font-weight: bold;">$caseUID</span>) . PATH_SEP . 'outdocs'. PATH_SEP .<br />
&nbsp; &nbsp; &nbsp; <span style="color: #006699; font-weight: bold;">$outDoc[0]</span>['APP_DOC_UID'] . '_' . <span style="color: #006699; font-weight: bold;">$outDoc[0]</span>['DOC_VERSION'];<br />
&nbsp; &nbsp;<span style="color: #006699; font-weight: bold;">$filename</span> = <span style="color: #006699; font-weight: bold;">$outDoc[0]</span>['FILENAME'];<br />
&nbsp; &nbsp;<span style="color: #006699; font-weight: bold;">$aAttachFiles</span>[<span style="color: #006699; font-weight: bold;">$filename</span> . '.pdf'] = <span style="color: #006699; font-weight: bold;">$path</span> . '.pdf'; &nbsp;//remove if not generating a PDF file<br />
&nbsp; &nbsp;<span style="color: #006699; font-weight: bold;">$aAttachFiles</span>[<span style="color: #006699; font-weight: bold;">$filename</span> . '.doc'] = <span style="color: #006699; font-weight: bold;">$path</span> . '.doc'; //remove if not generating a DOC file<br />
}<br />
<br />
<span style="color: #006699; font-weight: bold;">$usr</span> = userInfo(@@USER_LOGGED);<br />
<span style="color: #006699; font-weight: bold;">$from</span> = &quot;</span>admin<span style="color: #339933;">@</span>processmaker<span style="color: #339933;">.</span>com<span style="color: #0000ff;">&quot;; //set to the email account set in Admin &gt; Email Servers<br />
@@resp = PMFSendMessage(@@APPLICATION, <span style="color: #006699; font-weight: bold;">$from</span>, <span style="color: #006699; font-weight: bold;">$usr</span>['mail'], &quot;</span><span style="color: #0000ff;">&quot;, &quot;</span><span style="color: #0000ff;">&quot;,<br />
&nbsp; &nbsp;&quot;</span><span style="color: #b1b100;">Case</span> Report<span style="color: #0000ff;">&quot;, &quot;</span>caseReportTemplate<span style="color: #339933;">.</span>html<span style="color: #0000ff;">&quot;, array(), <span style="color: #006699; font-weight: bold;">$aAttachFiles</span>);</span></div></div>

<p><strong>Example Emailing File Uploaded in Home > Documents:</strong></p>

<p>Files which are uploaded directly in the <b>Home > Documents</b> interface are not associated with any case, so their paths are different from normal files in the ProcessMaker. To attach one of these files to an email, first go to the <b>Home > Documents</b> interface and download the file. Then, in your web browser, go to the Download Manager and copy the URL to the file, which should be similar to:
<p><code>http://example.com/sysworkflow/en/neoclassic/cases/cases_ShowDocument?a=965821362588279cb660237001025225&v=1</code></p>
<p>This file will be found on the ProcessMaker server at a location such as:<p>
<div style="margin-left: 25px">
<p><code>/opt/processmaker/shared/sites/workflow/files/00000000000000000000000000000000/965/821/362/588279cb660237001025225_1.png</code></p>or:
<p><code>C:\Bitnami\processmaker-3.1.3\apps\processmaker\shared\sites\workflow\files\00000000000000000000000000000000\965\821\362/588279cb660237001025225_1.png</code></p>or:
<p><code>C:\Users\Bob\AppData\Roaming\ProcessMaker-3_0_1_17\processmaker\shared\sites\workflow\files\00000000000000000000000000000000\965\821\362/588279cb660237001025225_1.png</code></p>
</div>
<p>Copy the CASE-DOC-UID and version number of the file and use it in the following trigger that sends the file as an attachment:
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$appDocUID</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'965821362588279cb660237001025225'</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$docVersion</span> <span style="color: #339933;">=</span> <span style="color: #cc66cc;">1</span><span style="color: #339933;">;</span><br />
<span style="color: #666666; font-style: italic;">//get file extension from the filename:</span><br />
<span style="color: #000088;">$d</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> AppDocument<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$aFile</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$d</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">Load</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$appDocUID</span><span style="color: #339933;">,</span> <span style="color: #000088;">$docVersion</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$ext</span> <span style="color: #339933;">=</span> <a href="http://php.net/pathinfo"><span style="color: #990000;">pathinfo</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aFile</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_DOC_FILENAME'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> PATHINFO_EXTENSION<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$g</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> G<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$filePath</span> <span style="color: #339933;">=</span> PATH_DOCUMENT <span style="color: #339933;">.</span> <span style="color: #0000ff;">'00000000000000000000000000000000'</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getPathFromUID</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$appDocUID</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">.</span><span style="color: #0000ff;">'_'</span><span style="color: #339933;">.</span> <span style="color: #000088;">$docVersion</span> <span style="color: #339933;">.</span><span style="color: #0000ff;">'.'</span><span style="color: #339933;">.</span> <span style="color: #000088;">$ext</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$aAttachFiles</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$aFile</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_DOC_FILENAME'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$filePath</span><br />
<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$usr</span> <span style="color: #339933;">=</span> userInfo<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'manager@acme.com'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$usr</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp;<span style="color: #0000ff;">'Company Information'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'companyInfoTemplate.html'</span><span style="color: #339933;">,</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #000088;">$aAttachFiles</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<h3><span id="PMFSendMessageToGroup.28.29">PMFSendMessageToGroup()</span></h3>

<p style="margin-left:25px"><strong><font color="green">Available Version:</font></strong> <font color="dimgray"> As of ProcessMaker 3.1.0.</font></p>

<p><code>PMFSendMessageToGroup()</code> sends a notification to a group of users.</p>

<codeblock><i>int</i> <strong>PMFSendMessageToGroup</strong>(<i>string</i> groupUID, <i>string</i> caseUID, <i>string</i> from, <i>string</i> subject, <i>string</i> template, <i>array</i> aFields, <i>array</i> aAttachments, <i>string</i> showMessage, <i>int</i> delIndex, <i>string</i> emailServerUID, <i>int</i> limit)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul>

    <li><i>string</i> <strong>groupUID: </strong>The group identifier. The email will be sent to all users that are currently part of the group. Note that inactive and on vacation users will NOT receive the email. </li>

    <li><i>string</i> <strong>caseUID</strong>: The UID of a case, which is a string of 32 hexadecimal characters that uniquely identifies each individual case. For the current case use the system variable <code>@@APPLICATION</code>. Another case UID can be found with the <a href="#PMFCaseList.28.29">PMFCaseList()</a> function, the <a href="../index.php/Simple_Trigger_Web_Services.html#WSCaseList" title="Simple Trigger Web Services">WSCaseList()</a> function, the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#caseList.28.29" title="ProcessMaker WSDL Web Services">caseList()</a> web service, or by using the <a href="../3.0/ProcessMaker_Functions.html#executeQuery.28.29" title="ProcessMaker Functions">executeQuery()</a> function to query the <strong><tt>wf_&lt;WORKSPACE&gt;.APPLICATION.APP_UID</tt></strong> field in the database.</li>

    <li><i>string</i> <strong>from</strong>: The email address of the person who sends out the email. Use the <a href="../3.0/ProcessMaker_Functions.html#userInfo.28.29" title="ProcessMaker Functions">userInfo()</a> function to get a user's email address. If it is necessary to include the person's name along with the email address, list the name first followed by the email address enclosed inside angle brackets <strong><code>&lt; &gt;</code></strong>. The name may be enclosed inside double quotation marks, but it isn't necessary:
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #0000ff;">'Travis Grady &lt;travis.grady@example.com&gt;'</span></div></div>
<p><i><font color="green">or</font></i></p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #0000ff;">'&quot;Travis Grady&quot; &lt;travis.grady@example.com&gt;'</span></div></div>

<p><b><font color="green">Note:</font></b> <font color="dimgrey">Due to security restrictions, Yahoo!, Gmail and many other email providers will no longer deliver email that doesn't come from the same email address as the account in the <a href="../3.0/Email_Settings.html#Email_Configuration" title="3.0/Email Settings">Email Configuration</a> at <strong>ADMIN &gt; Settings &gt; Email</strong>. To avoid this problem, set the email address for the <strong><code>from</code></strong> parameter to the same email address found in the Email Configuration.</font></p>
    </li>
    <li><i>string</i> <strong>subject</strong>: The subject (title) of the email.</li>

    <li><i>string</i> <strong>template</strong>: The name of the <a href="../3.0/Templates.html">template</a> file in plain text or HTML format that will produce the body of the email. Include the file extension in the file name. For example: <code>"negativeResponse.html"</code> or <code>"caseStatus.txt"</code>
</li>

    <li><i>array</i> <strong>aFields</strong>: (Optional) Parameter to define custom variables that can be inserted into the template file. An associative array where the keys are the variable name and the values are the variable's value. If no array is included, an empty array is included by default. Case variables defined in the same trigger that calls <code>PMFSendMessage()</code> should be passed to the email template using the <code>fields</code> array. See the example below for how to set the values in the <code>fields</code> array.</li>

    <li><i>array</i> <strong>aAttachments</strong>: (Optional) An array of files (full paths) to be attached to the email. Paths can be web addresses or paths in the file system of the ProcessMaker server. For example:<br>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'/home/foobar/clients/client_03452342.xls'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'/var/www/public/profile.pdf'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'http://www.example.com/finances.doc'</span><span style="color: #009900;">&#41;</span></div></div>

<p>By default, files are attached using their original file names, which means that Input Documents, Output Documents and attached files are sent with filenames containing their unique ID and version number.</p>

<p>If sending files stored by ProcessMaker, it is recommended to use ProcessMaker's predefined system constants, such as <code>PATH_DATA_PUBLIC</code>, <code>PATH_DATA_MAILTEMPLATES</code>, <code>PATH_DOCUMENT</code> and <code>PATH_SEP</code>, to construct the paths:</p>

<ul>
<li>Files in the "public" directory of the <a href="../3.0/Process_Files_Manager.html" title="Process Files Manager">Process Files Manager</a>:
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">PATH_DATA_PUBLIC <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;&lt;PROCESS-UID&gt;&quot;</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;&lt;FILENAME&gt;&quot;</span></div></div>
<p>Example:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">PATH_DATA_PUBLIC <span style="color: #339933;">.</span> <span style="color: #339933;">@@</span>PROCESS <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;letterheadLogo.png&quot;</span></div></div>
</li>

    <li>Template files (without inserted data) in the "mailTemplates" directory of the <a href="../3.0/Process_Files_Manager.html" title="Process Files Manager">Process Files Manager</a>:
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">PATH_DATA_MAILTEMPLATES <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;&lt;PROCESS-UID&gt;&quot;</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;&lt;FILENAME&gt;&quot;</span></div></div>
<p>Example:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">PATH_DATA_MAILTEMPLATES <span style="color: #339933;">.</span> <span style="color: #339933;">@@</span>PROCESS <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;companyProfile.html&quot;</span></div></div>
</li>

    <li>Uploaded <a href="../3.0/Input_Documents.html" title="3.0/Input Documents">Input Document</a> files and attached <a href="../3.0/File_control.html" title="3.0/Files">files</a>:
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">PATH_DOCUMENT <span style="color: #339933;">.</span> <span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getPathFromUID</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;&lt;CASE-UID&gt;&quot;</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;&lt;CASE-DOC-UID&gt;_&lt;VERSION&gt;.&lt;EXTENSION&gt;&quot;</span></div></div>
<p>Example:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">PATH_DOCUMENT <span style="color: #339933;">.</span> <span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getPathFromUID</span><span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #009900;">&#41;</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;9743702654e6925b52e1e34098864192_1.png&quot;</span></div></div>
</li>

    <li>Generated <a href="../3.0/Output_Documents.html" title="3.0/Output Documents">Output Document</a> files:
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">PATH_DOCUMENT <span style="color: #339933;">.</span> <span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getPathFromUID</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;&lt;CASE-UID&gt;&quot;</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;outdocs&quot;</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;&lt;CASE-DOC-UID&gt;_&lt;VERSION&gt;.&lt;EXTENSION&gt;&quot;</span></div></div>
<p>Example:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">PATH_DOCUMENT <span style="color: #339933;">.</span> <span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getPathFromUID</span><span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #009900;">&#41;</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;outdocs&quot;</span> <span style="color: #339933;">.</span> PATH_SEP <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;6960198894e6927e0a40b14004833875_2.pdf&quot;</span></div></div>

</li>
</ul>
</li>

<li><i>boolean</i> <strong>showMessage</strong>: (Optional) If set to <strong><code>TRUE</code></strong>, which is the default state, then the email message will be displayed in the <a href="Cases.html#Message_History" title="3.1/Cases">message history</a>. If set to <strong><code>FALSE</code></strong>, then the email message will not be displayed in the message history, although a email record will be stored in the <strong><tt>APP_MESSAGE</tt></strong> table.</li>

<li><i>int</i> <strong>delIndex</strong>: (Optional) If not set to 0, the message will be associated with a particular task in the case, which is indicated by its delegation index. The delegation index for the current case is stored in the system variable <code>@%INDEX</code>. Note that the delegation index changes with each new task in the case, so look up the index in the <strong><tt>APPLICATION.DEL_INDEX</tt></strong> field before calling this function.</li>

<li><i>string</i> <strong>emailServerUID</strong>: (Optional) Configure an alternative email server to send the messages. The <a href="../3.0/Email_Settings.html">email server</a> configuration UID can be found using the <a href="#executeQuery.28.29" title="ProcessMaker Functions">executeQuery()</a> function to query the <strong><tt>wf_&lt;WORKSPACE&gt;.EMAIL_SERVER.MESS_UID</tt></strong> field in the database.</li>

<li><i>int</i> <strong>limit</strong>: The limit of emails that can be sent in each batch. </li>
</ul>

<p><strong>Return Value:</strong><br>
Returns 1 if the emails were sent to the users in the specified group; otherwise, returns 0 if an error occurred.</p>

<p><strong>Example:</strong></p>
<p>The following trigger code uses the userInfo function to retrieve the email of the user currently logged in. Then, it sends the emails using the email.html template to the group with the ID: "967043513571685b19ad9a3030022260".</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$usr</span> <span style="color: #339933;">=</span> userInfo<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #339933;">@@</span>result <span style="color: #339933;">=</span> PMFSendMessageToGroup<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;967043513571685b19ad9a3030022260&quot;</span><span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #000088;">$usr</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;Testing Email&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;email.html&quot;</span><span style="color: #339933;">,</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">''</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">''</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #009900; font-weight: bold;">TRUE</span><span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>INDEX<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;&quot;</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">5</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<!-- END EMAIL Functions -->

<h2><span id="Grid_Functions">Grid Functions</span></h2>
<h3><span id="evaluateFunction.28.29">evaluateFunction()</span></h3>
<p><code>evaluateFunction()</code> executes a function in each row in a grid, using the grid fields in operations such as <code>+</code> (addition), <code>-</code> (subtraction), <code>*</code> (multiplication), <code>/</code> (division), and <code>%</code> (remainder). The formula can also use <code>( )</code> to group together operations.</p>

<codeblock> <i>array</i> <strong>evaluateFunction</strong>(<i>array</i> gridName, <i>string</i> Expression)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul>
    <li><code><i>grid</i> <strong>gridName</strong></code>: The input grid.</li>
    <li><code><i>string</i> <strong>Expression</strong></code>: The input expression for the operation to be done in the grid fields. The expression must always be enclosed within double quotes, otherwise a fatal error will occur.</li>
</ul>
<p><strong>Return Value:</strong><br>This function returns an associative array of associative arrays, which is how grids are internally stored in ProcessMaker.</p>
<p><strong>Example:</strong></p>
<The following grid contains 4 rows with 'name', 'salary', 'discount' and 'total' fields:</p>
    <codeblock>MyGrid =
(          [name]   [salary] [discount] [total]
     [1] ( 'ana',   1000,    100,       0     )
     [2] ( 'erik',  2000,    0,         0     )
     [3] ( 'jessi', 1200,    400,       0     )
     [4] ( 'naira', 2000,    0,         0     )
)
</codeblock>

    <p>The following function is executed, which subtracts the 'salary' field from the 'discount' field in each row and assigns the result to the 'total' field:</p>

    <div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@=</span>MyGrid <span style="color: #339933;">=</span> evaluateFunction<span style="color: #009900;">&#40;</span><span style="color: #339933;">@=</span>MyGrid<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;@#total = @#salary - @#discount&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

    <p>The result will be the following grid:</p>

    <codeblock>MyGrid =
(          [name]   [salary] [discount] [total]
     [1] ( 'ana',   2000,    100,       1900  )
     [2] ( 'erik',  2000,    0,         2000  )
     [3] ( 'jessi', 1200,    400,       800   )
     [4] ( 'naira', 2000,    0,         2000  )
)
</codeblock>
<h3><span id="orderGrid.28.29">orderGrid()</span></h3>
<p><code>orderGrid()</code> sorts a grid based on a specified field in ascending or descending order.</p>

<codeblock><i>array</i> <strong>orderGrid</strong>(<i>array</i> gridName, <i>string</i> field, <i>string</i> criteria='ASC')
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>array</i> <strong>gridName</strong>: A grid, which is a numbered array containing associative arrays with field names and their values, and has to be set like this "@=".</li>
    <li><i>string</i> <strong>field:</strong> The name of the field by which the grid will be sorted.</li>
    <li><i>string</i> <strong>criteria:</strong> Optional parameter. The order can either be 'ASC' (ascending) or 'DESC' (descending). If not included, 'ASC' will be used by default.</li></ul>
<p><strong>Note:</strong> The result of this function has to be saved in a grid to see the sorted information; it can be saved in the same grid or in another grid.</p>
<p><strong>Example:</strong></p>
<p>If your grid is like this:</p>

<codeblock>MyGrid =
(         [firstname][lastname]
    [1] ( 'erik',    'ortiz'   )
    [2] ( 'ana',     'castro'  )
    [3] ( 'naira',   'jimenez' )
    [4] ( 'jessica', 'martinez')
)
</codeblock>

<p>Then sort the grid by the 'firstname' field:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@=</span>MyGrid <span style="color: #339933;">=</span> orderGrid<span style="color: #009900;">&#40;</span><span style="color: #339933;">@=</span>MyGrid<span style="color: #339933;">,</span> <span style="color: #0000ff;">'firstname'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'ASC'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p>The result will be the following grid:</p>

<codeblock>MyGrid =
(         [firstname][lastname]
    [1] ( 'ana',     'castro'  )
    [2] ( 'erik',    'ortiz'   )
    [3] ( 'jessica', 'martinez')
    [4] ( 'naira',   'Jimenez' )
)
</codeblock>

<!-- GROUP Functions -->
<h2><span id="Group_Functions">Group Functions</span></h2>

<h3><span id="PMFAssignUserToGroup.28.29">PMFAssignUserToGroup()</span></h3>
<p><code>PMFAssignUserToGroup()</code> assigns a user to a group. Note that the logged-in user must have the PM_USERS permission in his/her role to be able to assign a user to a group.</p>

<codeblock><i>int</i> <strong>PMFAssignUserToGroup</strong>(<i>string</i> userUID, <i>string</i> groupUID)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>userUID</strong>: The unique ID of the user.</li>
    <li><i>string</i> <strong>groupUID</strong>: The unique ID of the group.</li></ul>
<p><strong>Return Value:</strong></p>
<p>Returns 1 if the user was successfully assigned to the group; otherwise, returns 0 if an error occurred.</p>
<p><strong>Example:</strong></p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$GroupUID</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'8511196744b6380deb57b69039061394'</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$var</span> <span style="color: #339933;">=</span> PMFAssignUserToGroup<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #339933;">,</span> <span style="color: #000088;">$GroupUID</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$var</span> <span style="color: #339933;">==</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #339933;">@@</span>text <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;It was not assigned&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">else</span><br />
&nbsp; &nbsp; <span style="color: #339933;">@@</span>text <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;It was assigned&quot;</span><span style="color: #339933;">;</span></div></div>

<p><strong>Where:</strong></p>
<ul><li><code><strong>$GroupUID</strong></code>: The ID of the employee group.</li>
    <li><code><strong>@@USER_LOGGED</strong></code>: This is the ID of the user logged in. </li>
    <li><code><strong>$var</strong></code>: This function returns 1 if the user was successfully assigned and 0 if not, and will store the return value to confirm the assignment.</li></ul>


<h3><span id="PMFGetGroupName.28.29">PMFGetGroupName()</span></h3>

<p><code>PMFGetGroupName()</code> retrieves the name of a <a href="../3.0/Managing_Users.html#Groups">group</a> using the unique ID of the group and given language.</p>

<codeblock><i>string</i> <strong>PMFGetGroupName</strong>(<i>string</i> groupUID, <i>string</i> Language)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul>
    <li><i>string</i> <strong>groupUID</strong>: The unique ID of the group, which can be found in the following ways:
<ul>
<li>Use the <a href="#PMFGroupList.28.29">PMFGroupList()</a> function or <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#groupList.28.29" title="ProcessMaker_WSDL_Web_Services">groupList()</a> web service.</li>
    <li>Query the <strong><tt>wf_&lt;WORKSPACE&gt;.GROUPWF.GRP_UID</tt></strong> field in the database with <a href="#executeQuery.28.29">executeQuery()</a>.</li></ul>
</li>
<li><i>string</i> <strong>Language</strong>: Optional parameter. The language in which the group name will be retrieved. If not specified then the default system language is used.</li></ul>
<p><span style="color: green; "><strong>Note:</strong></span> <span style="color: dimgrey;">Please take into account that returned values directly depend on the current data stored in the <strong><tt>wf_&lt;WORKSPACE&gt;.GROUPWF</tt></strong> table, and more specifically records related to group titles <code>(GRP_UID)</code>.</span></p>
<p><strong>Return value:</strong></p>
<ul><li><strong>string</strong>: The function returns the name of the group.</li></ul>
<p><strong>Example:</strong></p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>groupName <span style="color: #339933;">=</span> PMFGetGroupName<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>GROUP<span style="color: #339933;">,</span><span style="color: #0000ff;">'es'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
<p>The returned value stored in <code>@@groupName</code> will be <code>"Empleados"</code>.</p>


<h3><span id="PMFGetGroupUID.28.29">PMFGetGroupUID()</span></h3>

<p><code>PMFGetGroupUID()</code> retrieves the unique ID of a <a href="../3.0/Managing_Users.html#Groups">group</a> using the group name.</p>

<codeblock><i>string</i> <strong>PMFGetGroupUID</strong>(<i>string</i> groupName)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul>
  <li><i>string</i> <strong>groupName</strong>: The name of the group. Note that the name is case sensitive.
  </li>
</ul>
<p><strong>Return value:</strong></p>
<ul><li><strong>string</strong>: The function returns the unique ID of the group or <code>false</code> if the group name is not found.</li></ul>
<p><strong>Example:</strong></p>
<p>This trigger code looks up the ID of a group with the <code>PMFGetGroupUID()</code> function and then uses that ID to retrieve a list of users in that group with the <a href="ProcessMaker_Functions.html#PMFGetGroupUsers.28.29">PMFGetGroupUsers()</a> function. Then, it places the IDs and names of the users in an array which can be used as the <a href="../3.0/DynaForm_Field_Properties.html#Array_Variable">array variable</a> for the list of options in a dropdown box.</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$groupName</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;Approval Group&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$groupId</span> <span style="color: #339933;">=</span> PMFGetGroupUID<span style="color: #009900;">&#40;</span><span style="color: #000088;">$groupName</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$groupId</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; <span style="color: #b1b100;">throw</span> <span style="color: #000000; font-weight: bold;">new</span> Exception<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Group '<span style="color: #006699; font-weight: bold;">$groupName</span>' doesn't exist.&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
<span style="color: #000088;">$aUsers</span> <span style="color: #339933;">=</span> PMFGetGroupUsers<span style="color: #009900;">&#40;</span><span style="color: #000088;">$groupId</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #339933;">@=</span>availableUsers <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$aUsers</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$fullName</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_FIRSTNAME'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">.</span><span style="color: #0000ff;">' '</span><span style="color: #339933;">.</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_LASTNAME'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #339933;">@=</span>availableUsers<span style="color: #009900;">&#91;</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="color: #000088;">$fullName</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<h3><span id="PMFGetGroupUsers.28.29">PMFGetGroupUsers()</span></h3>

<p><code>PMFGetGroupUsers()</code> retrieves the users who are members of a<a href="../3.0/Managing_Users.html#Groups"> group</a>.</p>

<codeblock><i>array</i> <strong>PMFGetGroupUsers</strong>(<i>string</i> groupUID)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><tt><i>string</i> <strong>groupUID</strong></tt>: The unique ID of a group, which can be found in the following ways:
<ul>
<li>Use the <a href="#PMFGroupList.28.29">PMFGroupList()</a> or <a href="../index.php/Simple_Trigger_Web_Services.html#WSGroupList" title="Simple Trigger Web Services">WSGroupList()</a> functions or the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#groupList.28.29" title="3.0/ProcessMaker WSDL Web Services">groupList()</a> web service.
</li>
<li>Query the <strong><tt>wf_&lt;WORKSPACE&gt;.GROUPWF.GRP_UID</tt></strong> field in the database or use a query like:
<div class="geshifilter"><div class="sql geshifilter-sql" style="font-family:monospace;"><span style="color: #993333; font-weight: bold;">SELECT</span> GRP_TITLE<span style="color: #66cc66;">,</span> GRP_UID <span style="color: #993333; font-weight: bold;">FROM</span> GROUPWF</div></div>
</li>
</ul>
</li>
</ul>

<p><strong>Return Value:</strong></p>
<p>An array of associative arrays; each one of these arrays contains information about each user included in the group. The array has the following structure:</p>
<codeblock>[0] <i>array</i>
(
    <i>associative array</i>
    (
        [<i>property1</i>] => value
        [<i>property2</i>] => value
        [<i>property3</i>] => value
        ...
    )
)
[1] <i>array</i>
(
    <i>associative array</i>
    (
        [<i>property1</i>] => value
        [<i>property2</i>] => value
        [<i>property3</i>] => value
        ...
    )
...
</codeblock>
<p><strong>Example:</strong></p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>UsersList <span style="color: #339933;">=</span> PMFGetGroupUsers<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;8511196744b6380deb57b69039061394&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p>The variable <code>@@UsersList</code> will obtain all the information about the users of the group. The return value will show: </p>
<codeblock>Array ( [0] => Array (
    [USR_UID] => 41648276456d8a8acd76857021709199
    [USR_USERNAME] => daniela
    [USR_PASSWORD] => aa41ab4c932bdcc5246171e3a0aed710
    [USR_FIRSTNAME] => Daniela
    [USR_LASTNAME] => Martinez
    [USR_EMAIL] => email@engineer.com
    [USR_DUE_DATE] => 2017-03-03
    [USR_CREATE_DATE] => 2016-03-03 21:12:12
    [USR_UPDATE_DATE] => 2016-03-03 21:12:12
    [USR_STATUS] => ACTIVE
    [USR_COUNTRY] => BO
    [USR_CITY] => L
    [USR_LOCATION] => LPB
    [USR_ADDRESS] =>
    [USR_PHONE] => [
    [USR_FAX] =>
    [USR_CELLULAR] =>
    [USR_ZIP_CODE] => 2254
    [DEP_UID] => 77449242256d8a8dbe3fa03081252723
    [USR_POSITION] =>
    [USR_RESUME] =>
    [USR_BIRTHDAY] => 2016-03-03
    [USR_ROLE] => PROCESSMAKER_ADMIN
    [USR_REPORTS_TO] => 41648276456d8a8acd76857021709199
    [USR_REPLACED_BY] => 00000000000000000000000000000001
    [USR_UX] => NORMAL
    [USR_TOTAL_INBOX] => 5
    [USR_TOTAL_DRAFT] => 1
    [USR_TOTAL_CANCELLED] => 0
    [USR_TOTAL_PARTICIPATED] => 6
    [USR_TOTAL_PAUSED] => 0
    [USR_TOTAL_COMPLETED] => 0
    [USR_TOTAL_UNASSIGNED] => 0
    [USR_COST_BY_HOUR] => 10.00
    [USR_UNIT_COST] => $
    [USR_PMDRIVE_FOLDER_UID] =>
    [USR_BOOKMARK_START_CASES] =>
    [USR_TIME_ZONE] => America/New_York
    [USR_DEFAULT_LANG] => en
)
[1] => Array (
    [USR_UID] => 64057912456ddf2b679e620007773823
    [USR_USERNAME] => monica
    [USR_PASSWORD] => 3250fc092f6026b2cf0333f63644cb6e
    [USR_FIRSTNAME] => Monica
    [USR_LASTNAME] => Roddeford
    [USR_EMAIL] => d.callisaya@hotmail.com
    [USR_DUE_DATE] => 2017-03-07
    [USR_CREATE_DATE] => 2016-01-17 21:29:26
    [USR_UPDATE_DATE] => 2016-03-05 11:25:03
    [USR_STATUS] => ACTIVE
    [USR_COUNTRY] =>
    [USR_CITY] =>
    [USR_LOCATION] =>
    [USR_ADDRESS] =>
    [USR_PHONE] =>
    [USR_FAX] =>
    [USR_CELLULAR] =>
    [USR_ZIP_CODE] =>
    [DEP_UID] =>
    [USR_POSITION] =>
    [USR_RESUME] =>
    [USR_BIRTHDAY] => 2016-03-07
    [USR_ROLE] => PROCESSMAKER_OPERATOR
    [USR_REPORTS_TO] =>
    [USR_REPLACED_BY] =>
    [USR_UX] => NORMAL
    [USR_TOTAL_INBOX] => 35
    [USR_TOTAL_DRAFT] => 4
    [USR_TOTAL_CANCELLED] => 0
    [USR_TOTAL_PARTICIPATED] => 87
    [USR_TOTAL_PAUSED] => 5
    [USR_TOTAL_COMPLETED] => 10
    [USR_TOTAL_UNASSIGNED] => 0
    [USR_COST_BY_HOUR] => 580.00
    [USR_UNIT_COST] =>  Euro
    [USR_PMDRIVE_FOLDER_UID] =>
    [USR_BOOKMARK_START_CASES] =>
    [USR_TIME_ZONE] => America/Anguilla
    [USR_DEFAULT_LANG] => en )
)
</codeblock>


<h3><span id="PMFGroupList.28.29">PMFGroupList()</span></h3>
<p><code>PMFGroupList()</code> returns a list of <a href="../3.0/Managing_Users.html#Groups" title="Managing Users">groups</a> in the current workspace sorted in alphabetical order. In order to use this function, the logged-in user must have the <a href="Roles.html#PM_USERS">PM_USERS</a> permission in his/her role.</p>

<codeblock><i>array</i> <strong>PMFGroupList</strong>(<i>string</i> $regEx = null, <i>int</i> $start = null, <i>int</i> $limit = null)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul>
<li><i>string</i> <strong>regEx</strong>: <i>Optional.</i> A regular expression used to search for groups by their name. If this parameter is not included, all the groups are returned.</li>
<li><i>int</i> <strong>start</strong>: <i>Optional.</i> The number in the list of groups where to start returning groups.</li>
<li><i>int</i> <strong>limit</strong>: <i>Optional.</i> The maximum number of groups to return.</li>
</ul>

<p><strong>Return Value:</strong></p>
<p>An array of groups, with the following structure:</p>

<codeblock>[0] <i>array</i>
(
    <i>associative array</i>
    (
        [<i>string</i> guid]
        [<i>string</i> name]
    )
)
...
</codeblock>

<p>If no group is found, an empty array is returned.</p>
<p><strong>Where:</strong></p>
<ul><li><i>string</i> <strong>guid</strong>: The unique ID of a group.</li>
    <li><i>string</i> <strong>name</strong>: The name of a group.</li></ul>

<p><strong>Examples:</strong></p>
<ul><li><code>$array = PMFGroupList();</code> Returns all the groups in the current workspace.</li>
    <li><code>$array = PMFGroupList('(Ad)+')</code> Returns all groups starting with "Ad".</li>
    <li><code>$array = PMFGroupList('', 3, 4);</code> Returns all groups from the third register and the following 4 items.</li>
    <li><code>$array = PMFGroupList('(Ad)+', 2, 5);</code> Returns all groups starting with Ad, but this time from the second register and the following 5 items.</li></ul>


<h3><span id="PMFRemoveUsersFromGroup.28.29">PMFRemoveUsersFromGroup()</span></h3>

<p><code>PMFRemoveUsersFromGroup()</code> removes users from a group. Take into consideration that only roles with the <a href="Roles.html#PM_USERS">PM_USERS</a> permission will be able to use this function.</p>

<codeblock><i>int</i> <strong>PMFRemoveUsersFromGroup</strong>(<i>string</i> groupUID, <i>array</i> usersUID)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul>
    <li>
<i>string</i> <strong>groupUID</strong>: The unique ID of the group from which the users will be removed. This parameter can be found in the following ways:
<ul>
<li>Use the <a href="#PMFGroupList.28.29">PMFGroupList()</a> or <a href="../index.php/Simple_Trigger_Web_Services.html#WSGroupList" title="Simple Trigger Web Services">WSGroupList()</a> functions or the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#groupList.28.29" title="3.0/ProcessMaker WSDL Web Services">groupList()</a> web service.</li>
<li>Query the <strong><tt>wf_&lt;WORKSPACE&gt;.GROUPWF.GRP_UID</tt></strong> field in the database or use a query like:
<div class="geshifilter"><div class="sql geshifilter-sql" style="font-family:monospace;"><span style="color: #993333; font-weight: bold;">SELECT</span> GRP_TITLE<span style="color: #66cc66;">,</span> GRP_UID <span style="color: #993333; font-weight: bold;">FROM</span> GROUPWF</div></div>
</li>
</ul>
</li>
<li><i>array</i> <strong>usersUID</strong>: An array of the unique IDs of the users who are going to be removed from the group.</li>
</ul>

<p><strong>Return Value:</strong><br>
Returns 1 if the user/group was assigned successfully; otherwise, returns 0 if an error occurred.</p>

<p><b>Example:</b></p>
<codeblock>@@ReturnValue = PMFRemoveUsersFromGroup("523651123582cafe6735068050719273",
array('1338195805812063b044715060827459','2157592775812065fecf8b2028626881'));
</codeblock>

<!-- END GROUP Functions -->
<!-- PROCESS Functions -->
<h2><span id="Process_Functions">Process Functions</span></h2>



<h3><span id="PMFGetProcessUidByName.28.29">PMFGetProcessUidByName()</span></h3>

<p><code>PMFGetProcessUidByName()</code> retrieves the UID of a<a href="Processes.html"> process</a>.</p>

<codeblock><i>string</i> <strong>PMFGetProcessUidByName</strong>(<i>string</i> processName)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>processName</strong>: The name of the process.</li></ul>

<p><strong>Return Value:</strong></p>
<ul><li>With parameter: returns the unique ID of the process name.</li>
    <li>Without parameter: returns the unique ID of the current process.</li></ul>

<p><strong>Example without parameter:</strong></p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>UIDProcess <span style="color: #339933;">=</span> PMFGetProcessUidByName<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p><strong>Example with parameter:</strong></p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>UIDProcess <span style="color: #339933;">=</span> PMFGetProcessUidByName<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Purchase Process&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<h3><span id="PMFProcessList.28.29">PMFProcessList()</span></h3>
<p><code>PMFProcessList()</code> returns a list of processes in the current workspace.</p>

<codeblock><i>array</i> <strong>PMFProcessList</strong>(<i>void</i>)
</codeblock>

<p><strong>Parameters:</strong></p>
<p>None.</p>
<p><strong>Return Value:</strong></p>
<p>An array of associative arrays that contain the unique ID and processes titles. The array has the following structure:</p>

<codeblock>[0] <i>array</i>
(
    <i>associative array</i>
    (
        [<i>string</i> guid]
        [<i>string</i> name]
    )
)
...
</codeblock>

<p><strong>Where:</strong></p>
<ul><li><i>string</i> <strong>guid</strong>: The unique ID of a process.</li>
    <li><i>string</i> <strong>name</strong>: The process title.</li></ul>
<p><strong>Example:</strong></p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>ArrayProcesses <span style="color: #339933;">=</span> PMFProcessList<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
<!-- END ProcessMaker Functions -->

<h2><span id="String_Functions">String Functions</span></h2>
<h3><span id="capitalize.28.29">capitalize()</span></h3>
<p><code>capitalize()</code> converts the first letter in each word into an uppercase letter. Subsequent letters in each word are changed into lowercase letters.</p>

<codeblock> <i>string</i> <strong>capitalize</strong>(<i>string</i> textToConvert)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>textToConvert</strong>: The string to capitalize.</li></ul>
<p><strong>Return value:</strong></p>
<ul><li><i>string</i></code>: Returns the introduced text with the first letter capitalized in each word and the subsequent letters in lowercase letters.</li></ul>
<p><strong>Example:</strong></p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>phrase1 <span style="color: #339933;">=</span> capitalize<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;hello world&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #339933;">@@</span>phrase2 <span style="color: #339933;">=</span> capitalize<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;hElLo wOrLd&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
<p>Both <code>@@phrase1</code> and <code>@@phrase2</code> will be set to <code>"Hello World"</code>.</p>

<h3><span id="lowerCase.28.29">lowerCase()</span></h3>
<p><code>lowerCase()</code> returns a string with all the letters converted into lower case letters.</p>

<codeblock><i>string</i> <strong>lowerCase</strong>(<i>string</i> textToConvert)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><code><i>string</i> <b>textToConvert</b></code>: A string to convert to lower case letters.</li></ul>

<p><strong>Return value:</strong></p>
<ul><li>The function returns a string with the text converted into lower case letters.</li></ul>

<p><strong>Example:</strong></p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>phrase1 <span style="color: #339933;">=</span> lowerCase<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'HELLO WORLD'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #339933;">@@</span>phrase2 <span style="color: #339933;">=</span> lowerCase<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'HeLlO WoRlD'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
<p>Both <code>@@phrase1</code> and <code>@@phrase2</code> will be set to <code>"hello world"</code>.</p>

<h3><span id="upperCase.28.29">upperCase()</span></h3>
<p><code>upperCase()</code> returns a string converted into all UPPERCASE letters.</p>

<codeblock><i>string</i> <strong>upperCase</strong>(<i>string</i> textToConvert)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>textToConvert</strong>: A string to convert to UPPERCASE letters.</li></ul>
<p><strong>Return value:</strong><br>A string converted into UPPERCASE letters.</p>

<p><strong>Example:</strong></p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>phrase1 <span style="color: #339933;">=</span> upperCase<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'hello world'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #339933;">@@</span>phrase2 <span style="color: #339933;">=</span> upperCase<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'helLO WORld'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
<p>Both <code>@@phrase1</code> and <code>@@phrase2</code> will be set to <code>"HELLO WORLD"</code>.</p>

<!-- Task Functions -->
<h2><span id="Task_Functions">Task Functions</span></h2>


<h3><span id="PMFAddUserGroupToTask.28.29">PMFAddUserGroupToTask()</span></h3>
<p><code>PMFAddUserGroupToTask()</code> adds a user or group to the list of users assigned to a task. Note that if the user or group is already assigned then it cannot be assigned again. This function defines internally if the sent UID is from a user or a group.</p>

<codeblock><i>int</i> <strong>PMFAddUserGroupToTask</strong>(<i>string</i> taskUID, <i>string</i> userGroupUID)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul>
    <li><i>string</i> <strong>taskUID</strong>: The unique ID of the task, which can be found in the following ways:
<ul>
  <li>Use the <code>@@TASK</code> system variable to get the unique ID of the current task.</li>
    <li>Use the <a href="#PMFTaskList.28.29">PMFTaskList()</a> function or <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#taskList.28.29" title="3.0/ProcessMaker WSDL Web Services">taskList()</a> web service.</li>
    <li>Query the <strong><tt>wf_&lt;WORKSPACE&gt;.TASK.TAS_UID</tt></strong> field in the database or get the starting task of the current process with the following query:
  </li>
</ul>
</li>

<dl>
    <dd>
        <dl>
            <dd>executeQuery("SELECT TAS_UID FROM TASK WHERE PRO_UID='"</span> <span class="sy0" style="color: rgb(51, 153, 51);">.</span>                <span class="sy0" style="color: rgb(51, 153, 51);">@@</span>PROCESS <span class="sy0" style="color: rgb(51, 153, 51);">.</span>                <span class="st0" style="color: rgb(0, 0, 255);">"' AND TAS_START='TRUE'"</span>)</span>
                </span>
            </dd>
        </dl>
    </dd>
</dl>

<li>
<i>string</i> <strong>userGroupUID</strong>: The unique ID of a group, which can be found in the following ways:
<ul>
<li>Use the <a href="#PMFGroupList.28.29">PMFGroupList()</a> or <a href="../index.php/Simple_Trigger_Web_Services.html#WSGroupList" title="Simple Trigger Web Services">WSGroupList()</a> functions or the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#groupList.28.29" title="3.0/ProcessMaker WSDL Web Services">groupList()</a> web service.</li>
<li>Query the <strong><tt>wf_&lt;WORKSPACE&gt;.GROUPWF.GRP_UID</tt></strong> field in the database.or use a query like:
<div class="geshifilter"><div class="sql geshifilter-sql" style="font-family:monospace;"><span style="color: #993333; font-weight: bold;">SELECT</span> GRP_TITLE<span style="color: #66cc66;">,</span> GRP_UID <span style="color: #993333; font-weight: bold;">FROM</span> GROUPWF</div></div>
</li>
</ul>
</li>
</ul>

<p><strong>Return Value:</strong><br>
Returns 1 if the user/group was assigned successfully; otherwise, returns 0 if an error occurred.</p>

<h3><span id="PMFGetTaskName.28.29">PMFGetTaskName()</span></h3>

<p><code>PMFGetTaskName()</code> retrieves the name of a <a href="Tasks.html">task</a> using the unique ID of the task and given language.</p>

<codeblock><i>string</i> <strong>PMFGetTaskName</strong>(<i>string</i> taskId, <i>string</i> Language)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul>
    <li><i>string</i> <strong>taskId</strong>: The unique ID of the task, which can be found in the following ways:
<ul><li>Use the <code>@@TASK</code> system variable to get the unique ID of the current task.</li>
    <li>Use the <a href="#PMFTaskList.28.29">PMFTaskList()</a> function or <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#taskList.28.29" title="3.0/ProcessMaker WSDL Web Services">taskList()</a> web service.</li>
    <li>Query the <strong><tt>wf_&lt;WORKSPACE&gt;.TASK.TAS_TITLE</tt></strong> field in the database with <a href="#executeQuery.28.29">executeQuery()</a>.</li></ul>
</li>
<li><i>string</i> <strong>Language</strong>: Optional parameter. The language in which the task name will be retrieved. If not specified then the default system language is used.</li></ul>
<p><span style="color: green; "><strong>Note:</strong></span> <span style="color: dimgrey;">Please take into account that returned values directly depend on the current data stored in the <strong><tt>wf_&lt;WORKSPACE&gt;.TASK</tt></strong> table, and more specifically records related to task titles <code>(TAS_TITLE)</code>.</span></p>
<p><strong>Return value:</strong></p>
<ul><li><strong>string</strong>: The function returns the name of the task.</li></ul>
<p><strong>Example:</strong></p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>taskName <span style="color: #339933;">=</span> PMFGetTaskName<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>TASK<span style="color: #339933;">,</span><span style="color: #0000ff;">'es'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
<p>The returned value stored in <code>@@taskName</code> will be <code>"Recibir Factura"</code>.</p>

<h3><span id="PMFGetTaskUID.28.29">PMFGetTaskUID()</span></h3>

<p><code>PMFGetTaskUID()</code> retrieves the unique ID of a <a href="Tasks.html">task</a> using the task name and, if required, the unique ID of the process.</p>

<codeblock><i>string</i> <strong>PMFGetTaskUID</strong>(<i>string </i>taskName, <i>string </i> processUID)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul>
    <li><i>string</i> <strong>taskName</strong>: The name of the task. Remember that task names are case sensitive and can contain spaces.
</li>
    <ul><li><i>string</i> <strong>processUID</strong>: (Optional) The unique ID of the process, where the task is found. If not included or set to null, then assumes that the task is located in the current process. The process UID can be found in the following ways:<br>
<ul>
<li>Use the <code>@@PROCESS</code> system variable to get the unique ID of the current process.</li>

        <li>Use the <a href="#PMFProcessList.28.29">PMFProcessList()</a> function or <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#processList.28.29" title="3.0/ProcessMaker WSDL Web Services">processList()</a> web service.</li>

        <li>Query the <strong><tt>wf_&lt;WORKSPACE&gt;.PROCESS.PRO_UID</tt></strong> field in the database or use a query like:
<div class="geshifilter"><div class="sql geshifilter-sql" style="font-family:monospace;"><span style="color: #993333; font-weight: bold;">SELECT</span> PRO_UID <span style="color: #993333; font-weight: bold;">FROM</span> PROCESS <span style="color: #993333; font-weight: bold;">WHERE</span> PRO_TITLE <span style="color: #66cc66;">=</span> <span style="color: #ff0000;">'Receive Invoice'</span></div></div>
        </li>
</ul>
</li>
</ul>

<p><strong>Return value:</strong></p>
<p>The function returns the unique ID of the task (which is a string of 32 hexadecimal numbers). If not found, then it returns <code>false</code>.</p>

<p><strong>Example:</strong></p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>taskId <span style="color: #339933;">=</span> PMFGetTaskUID<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Receive invoice'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'75150592456d5efe4848088021942802'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p>The returned value stored in <code>@@taskUID</code> will be <code>'52043657456d5f00ed2e468062806376'</code>.</p>

<h3><span id="PMFRemoveUserGroupFromTask.28.29">PMFRemoveUserGroupFromTask()</span></h3>
<p><code>PMFRemoveUserGroupFromTask()</code> removes a user or group from the list of users assigned to a task. This function defines internally if the sent UID is from a user or a group.</p>

<codeblock><i>int</i> <strong>PMFRemoveUserGroupFromTask</strong>(<i>string</i> taskUID, <i>string</i> userGroupUID)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul>
    <li><i>string</i> <strong>taskUID</strong>: The unique ID of the task a user or group will be removed from, which can be found in the following ways:
<ul>
  <li>Use the <code>@@TASK</code> system variable to get the unique ID of the current task.</li>
    <li>Use the <a href="#PMFTaskList.28.29">PMFTaskList()</a> function or <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#taskList.28.29" title="3.0/ProcessMaker WSDL Web Services">taskList()</a> web service.</li>
    <li>Query the <strong><tt>wf_&lt;WORKSPACE&gt;.TASK.TAS_UID</tt></strong> field in the database or get the starting task of the current process with the following query:
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT TAS_UID FROM TASK WHERE PRO_UID='&quot;</span> <span style="color: #339933;">.</span> <span style="color: #339933;">@@</span>PROCESS <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;' AND TAS_START='TRUE'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
    </li>
</ul>
</li>
<li>
<i>string</i> <strong>userGroupUID</strong>: The unique ID of a user or group that will be removed from the list of assignees, which can be found in the following ways:
<ul>
<li>Use the <a href="#PMFGroupList.28.29">PMFGroupList()</a> or <a href="../index.php/Simple_Trigger_Web_Services.html#WSGroupList" title="Simple Trigger Web Services">WSGroupList()</a> functions or the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#groupList.28.29" title="3.0/ProcessMaker WSDL Web Services">groupList()</a> web service.</li>
<li>Query the <strong><tt>wf_&lt;WORKSPACE&gt;.GROUPWF.GRP_UID</tt></strong> field in the database or use a query like:
<div class="geshifilter"><div class="sql geshifilter-sql" style="font-family:monospace;"><span style="color: #993333; font-weight: bold;">SELECT</span> GRP_TITLE<span style="color: #66cc66;">,</span> GRP_UID <span style="color: #993333; font-weight: bold;">FROM</span> GROUPWF</div></div>
</li>
</ul>
</li>
</ul>

<p><strong>Return Value:</strong><br>
Returns 1 if the user/group was assigned successfully; otherwise, returns 0 if an error occurred.</p>


<h3><span id="PMFTaskList.28.29">PMFTaskList()</span></h3>
<p><code>PMFTaskList()</code> returns the list of tasks the specified user has initiated.</p>

<codeblock><i>array</i> <strong>PMFTaskList</strong>(<i>string</i> userId)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>userId</strong>: The unique ID of a user.</li></ul>
<p><strong>Return value:</strong></p>
<p>An array of tasks, with the following structure:</p>


<codeblock>
[0] <i>array</i>
(
   <i>associative array</i>
   (
      [<i>string</i> guid]
      [<i>string</i> name]
      [<i>string</i> processId]
      [<i>int</i> initialTask]
   )
)
...
</codeblock>

<p><strong>Where:</strong></p>
<ul>
    <li><i>string</i> <strong>guid</strong>: The unique ID of a task.</li>
    <li><i>string</i> <strong>name</strong>: The name of a task.</li>
    <li><i>string</i> <strong>processId</strong>: The unique ID of the process.</li>
    <li><i>int</i> <strong>initialTask</strong>: Set to 1 if the task is an initial task. Otherwise, set to 0.</li>
</ul>
<p><strong>Example:</strong><br>
Get the unique ID of the task whose name is "Verify Data"  and place it in the @@taskId variable:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$aTasks</span> <span style="color: #339933;">=</span> PMFTaskList<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$aTasks</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$aTask</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$aTask</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'name'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">===</span> <span style="color: #0000ff;">'Verify Data'</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #339933;">@@</span>taskId <span style="color: #339933;">=</span> <span style="color: #000088;">$aTask</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'guid'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>


<h3><span id="PMFTasksListByProcessId.28.29">PMFTasksListByProcessId()</span></h3>

<p><code>PMFTasksListByProcessId()</code> retrieves the UID and the names of all the tasks in a <a href="Processes.html">Process</a>.</p>

<codeblock><i>array</i> <strong>PMFTasksListByProcessId</strong>(<i>string</i> processUID, <i>string</i> Language)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>processUID</strong>: (Required) The unique ID of the process, which can be found in the following ways:
<ul><li>Use the <code>@@PROCESS</code> system variable to get the unique ID of the current process.</li>
<li>Use the <a href="#PMFProcessList.28.29">PMFProcessList()</a> function or <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#processList.28.29" title="/3.0/ProcessMaker WSDL Web Services">processList()</a> web service.</li>
<li>Query the <strong><tt>wf_&lt;WORKSPACE&gt;.PROCESS.PRO_UID</tt></strong> field in the database or use a query like:
<div class="geshifilter"><div class="sql geshifilter-sql" style="font-family:monospace;"><span style="color: #993333; font-weight: bold;">SELECT</span> PRO_UID <span style="color: #993333; font-weight: bold;">FROM</span> PROCESS <span style="color: #993333; font-weight: bold;">WHERE</span> PRO_TITLE <span style="color: #66cc66;">=</span> <span style="color: #ff0000;">'Expense Report Process'</span></div></div>
</li>
</ul>
</li>

<li><i>string</i> <strong>Language</strong>: (Required) The language used to display the name of the task. If not included, it will be English ('en') by default.</li></ul>

<p><strong>Return Value:</strong></p>
<p>An array of associative arrays. Each one of these arrays contains the UID and the name of each task in the process. The array has the following structure:</p>
<codeblock>[0] <i>array</i>
(
    <i>associative array</i>
    (
        [<i>string</i> TAS_UID]
        [<i>string</i> TAS_TITLE]
    )
)
...
</codeblock>

<p><strong>Example:</strong></p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>ArrayTasks <span style="color: #339933;">=</span> PMFTasksListByProcessId<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>PROCESS<span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>SYS_LANG<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p>In this case, the return value stored in <code>@@ArrayTasks</code> will show the following information:</p>
<codeblock>Array (
    [0] => Array (
        [TAS_UID] => 14850126058f50499a508e6011635086
        [TAS_TITLE] => Task 1
        )
    [1] => Array (
        [TAS_UID] => 22631919158f504994e4669079649122
        [TAS_TITLE] => Task 2
        )
    [2] => Array (
        [TAS_UID] => 31790824558f504c140bd07034804777
        [TAS_TITLE] => Task 3
    )
)
</codeblock>

<!-- END Task Functions -->


<!-- UNIQUE ID Functions -->
<h2><span id="Unique_ID_Functions">Unique ID Functions</span></h2>

<h3><span id="generateCode.28.29">generateCode()</span></h3>
<p><code>generateCode()</code> creates a random string of letters and/or numbers of a specified length, which can be used as the <a href="../3.0/Case_Tracker.html" title="Case Tracker">PIN</a> (public identification numbers) and code for a case. For more info, see <a href="#setCaseTrackerCode.28.29">setCaseTrackerCode()</a>.</p>

<codeblock><i>string</i> <strong>generateCode</strong>(<i>int</i> size, <i>string</i> type)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>int</i> <strong>size</strong>: The number of characters to be generated, which can cannot be less than 4 or greater than 50.</li>
    <li><i>string</i> <strong>type</strong>: The type of of characters to be generated, which can be 'ALPHA' (only letters), 'NUMERIC' (only numbers), and 'ALPHANUMERIC' (both letters and numbers).</li></ul>

<p><strong>Return Value:</strong></p>
<p>The generated string of random characters.</p>
<p><span style="color: green;"><strong>Note:</strong></span> <font color=dimgrey>There is no way to know whether the string returned by <code>generateCode()</code> is unique, so do not use this function to uniquely identify any object in ProcessMaker. For that purpose, use the <code>G::generateUniqueID()</code> function.</font></p>
<p><strong>Example:</strong><br>Create a random alphanumeric string, like "4NJQEWPT89AH":</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>CaseCode <span style="color: #339933;">=</span> generateCode<span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">10</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'ALPHANUMERIC'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<h3><span id="PMFGeti18nText">PMFGeti18nText()</span></h3>
<p><code>PMFGeti18nText()</code> returns the translation of a property of an object in ProcessMaker in a specified language. For example, this function can be used to look up the French translation of a task's title and description. These translations were entered by the process designer and stored in the <code>wf_<font color=purple><i>WORKSPACE</i></font>.CONTENT</code> table of the database.</p>
<codeblock><i>string</i> <strong>PMFGeti18nText</strong>(<i>string</i> ID, <i>string</i> category, <i>string</i> lang = "en")</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>ID</strong>: The unique ID of the object whose property will be looked up to find a translation.</li>
    <li><i>string</i> <strong>category</strong>: The category of the property to be looked up, such as <code>'GRP_TITLE'</code> (a group's title) or <code>'INP_DOC_DESCRIPTION'</code> (an Input Document's description). See <a href="#PMFGetUidFromText">this list</a> of the available categories.</li>
    <li><i>string</i> <strong>lang</strong>: <i>Optional.</i> The <a href="../3.0/Languages.html#Installing_Additional_Translations">code</a> of the language to be retrieved, such as <code>'es'</code> (Spanish) or <code>'pt-BR'</code> (Brazilian Portuguese). Use the <code>@@SYS_LANG</code> system variable to look up the translation in the current system language of the user logged in. If not included, then will return English by default.</li>
</ul>
<p><strong>Return Value:</strong></p>
<p>Returns the translation stored in the <code>CON_VALUE</code> field of the <code>CONTENT</code> table.</p>

<p><strong>Example:</strong> </p>
<p>Look up the description in Spanish of a trigger with the unique ID "63754922456d8c321a978c6078216529":</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>DATOS <span style="color: #339933;">=</span> PMFGeti18nText<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;63754922456d8c321a978c6078216529&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;TRI_DESCRIPTION&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;es&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
<p>Which will get the text in Spanish as seen in the image below.</p>
<p><img src="../sites/default/files/PM3_PMFunction_ObtainDataSpanish.png"></p>
<p>If the same text in French (from France) is needed:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>DATOS <span style="color: #339933;">=</span> PMFGeti18nText<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;63754922456d8c321a978c6078216529&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;TRI_DESCRIPTION&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;fr-FR&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
<p>The text in French will be retrieved, as seen in the image below.</p>
<p><img src="../sites/default/files/PM3_PMFunction_ObtainDataFrench.png"></p>
<p style="margin-left:25px"><strong><font color="green">Note:</font></strong><font color="dimgray"> Note that this function will only return a translation in the specified language if there is one stored in the <code>wf_<font color=purple><i>WORKSPACE</i></font>.CONTENT</code> table.</font></p>

<h3><span id="PMFGetUidFromText">PMFGetUidFromText()</span></h3>

<p><code>PMFGetUidFromText()</code> returns the unique ID of a process element by searching for its text (name, title, description, etc.) in the <code>CONTENT</code> table in the workspace's database. Multiple results may be returned.</p>

<codeblock><i>array</i> <strong>PMFGetUidFromText</strong>(<i>string</i> text, <i>string</i> category, <i>string</i> processUID = null, <i>string</i> lang = @@SYS_LANG)</codeblock>

<p><strong>Parameters:</strong></p>
<ul>
    <li><i>array</i> <strong>text</strong>: The text of the element to search for in the <b><tt>CONTENT.CON_VALUE</tt></b> field in the database, such as the name of a group, department, role, permission, task, process, etc. </li>
    <li><i>string</i> <strong>category</strong>: The category of the text, which is stored in the <b><tt>CONTENT.CON_CATEGORY</tt></b> field in the database. The available categories are:<br>
<table class="codecolumn">
<tr><th>Category</th><th>Description</th></tr>
<tr><td>'APP_TITLE'</td><td>The title of a case, which contains the case number by default, but can be set in the task properties in the process.</td></tr>
<tr><td>'APP_DESCRIPTION'</td><td>Case description, which can be set in the task properties in the process.</td></tr>

<tr><td>'APP_DOC_COMMENT'</td><td>The comment added to an uploaded file in an Input Document.</td></tr>
<tr><td>'APP_DOC_FILENAME'</td><td>The filename of a file that is uploaded to an Input Document or File field, or generated as an Output Document.</td></tr>
<tr><td>'APP_DOC_TITLE'</td><td>The title of a file associated with a case. This feature is outdated and no longer used in version 3 and later.</td></tr>

<tr><td>'PRO_TITLE'</td><td>Process title.</td></tr>
<tr><td>'PRO_DESCRIPTION'</td><td>Process description</td></tr>

<tr><td>'TAS_TITLE'</td><td>Task title, set in the task's properties under <b>Definitions</b>.</td></tr>
<tr><td>'TAS_DESCRIPTION'</td><td>Task description, set in the task's properties under <b>Definitions</b>.</td></tr>
<tr><td>'TAS_DEF_SUBJECT_MESSAGE'</td><td>The subject line of an email, which is set in the task's properties under <b>Notifications</b>.</td></tr>
<tr><td>'TAS_DEF_MESSAGE'</td><td>The body of an email, which is set in the task's properties under  <b>Notifications</b>.</td></tr>
<tr><td>'TAS_DEF_TITLE'</td><td>The title of the case when it arrives at the task, which is set in the task's properties under <b>Case Labels</b>.</td></tr>
<tr><td>'TAS_DEF_DESCRIPTION'</td><td>The description of the case when it arrives at the task, which is set in the task's properties under <b>Case Labels</b>.</td></tr>
<tr><td>'TAS_DEF_PROC_CODE'</td><td>Task property to assign a code. This feature is outdated and no longer used in version 3 and later.</td></tr>

<tr><td>'DYN_TITLE'</td><td>Dynaform title.</td></tr>
<tr><td>'DYN_DESCRIPTION'</td><td>Dynaform description.</td></tr>
<tr><td>'GRP_TITLE'</td><td>Group title.</td></tr>

<tr><td>'DEPO_TITLE'</td><td>Department title.</td></tr>
<tr><td>'INP_DOC_TITLE'</td><td>Input Document title.</td></tr>
<tr><td>'INP_DOC_DESCRIPTION'</td><td>Input Document description.</td></tr>

<tr><td>'OUT_DOC_TITLE'</td><td>Output Document title.</td></tr>
<tr><td>'OUT_DOC_DESCRIPTION'</td><td>Output Document description.</td></tr>
<tr><td>'OUT_DOC_FILENAME'</td><td>Output Document filename, set in the definition of the Output Document. For the filename of a generated Output Document file, use <code>'APP_DOC_FILENAME'</code>.</td></tr>
<tr><td>'OUT_DOC_TEMPLATE'</td><td>The HTML code of the template of the Output Document.</td></tr>

<tr><td>'PER_NAME'</td><td>Name of a role's permission. For example, the PM_REASSIGNCASE permission has the name "Reassign case".</td></tr>
<tr><td>'ROL_NAME'</td><td>Name of the role. For example, the PROCESSMAKER_MANAGER role has the name "Manager".</td></tr>
<tr><td>'TRI_TITLE'</td><td>Trigger title.</td></tr>
<tr><td>'TRI_DESCRIPTION'</td><td>Trigger description.</td></tr>
</table>
</li>

    <li><i>string</i> <strong>processUID</strong>: (Optional) The unique ID of the process, which can be found by running a case and looking at the <code>PROCESS</code> system variable in the <a href="Triggers.html#Enabling_Debug_Mode">Debug Mode</a>. This parameter should be set if elements in multiple processes may have the same text, such as tasks that may have the same title in two different processes. For the current process, set to the <code>@@PROCESS</code> system variable. If @@PROCESS is not included, the current process where the function is executed will be used.

</li>
    <li><i>string</i> <strong>$lang</strong>: (Optional) The language code, such as 'es' (Spanish) or 'pt-BR' (Portuguese from Brazil, which is searched for in the <b><tt>CONTENT.CON_LANG</tt></b> field in the database. The @@SYS_LANG system variable can be used to retrieve the language of the workspace. If @@SYS_LANG is not included, the default language of the workspace will be used.</li>
</ul>
<p><strong>Return Value:</strong><br>
An array with the unique IDs of the matching element(s) found in the <b><tt>CONTENT</tt></b> table.</p>

<p><strong>Example 1:</strong></p>
<p>Retrieve the ID of a task entitled "Review application" in the current process.
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$taskUID</span> <span style="color: #339933;">=</span> PMFGetUidFromText<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Review application'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'TAS_TITLE'</span><span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>PROCESS<span style="color: #339933;">,</span> <span style="color: #0000ff;">'en'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span></div></div>
<div style="margin-left:25px">
<font color=green><b>Note:</b></font> <font color=dimgrey>This code assumes that the task title will never change. If searching for elements whose text might change, then use the <a href="http://php.net/manual/en/function.count.php">count()</a> function to check whether at least one record was returned by <code>PMFGetUidFromText()</code>:</font>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$taskTitle</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'Review application'</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$aTasks</span> <span style="color: #339933;">=</span> PMFGetUidFromText<span style="color: #009900;">&#40;</span><span style="color: #000088;">$taskTitle</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'TAS_TITLE'</span><span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>PROCESS<span style="color: #339933;">,</span> <span style="color: #0000ff;">'en'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aTasks</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">==</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">throw</span> <span style="color: #000000; font-weight: bold;">new</span> Exception<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Error: Task '<span style="color: #006699; font-weight: bold;">$taskTitle</span>' is not found.&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
<span style="color: #000088;">$taskUID</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$aTasks</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span></div></div>
</div>

<p><strong>Example 2:</strong></p>
<p>The following example gets a list of IDs of the users in a group, so it can set the <code>@=assignedUsers</code> variable used by a task with Self Service Value Based Assignment. <code>PMFGetUidFromText()</code> is used to search for the ID of the group with the title "Factory Managers". After checking with <code>count()</code> that at least one record was returned, then it uses <code>Group::getUsersOfGroup()</code> to get the list of users in a group. It then assigns the IDs of these users to the <code>@=assignedUsers</code> array.
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@=</span>assignedUsers <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$aGroups</span> <span style="color: #339933;">=</span> PMFGetUidFromText<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Factory Managers&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;GRP_TITLE&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aGroups</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$groupUID</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$aGroups</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;G<span style="color: #339933;">::</span><span style="color: #004000;">LoadClass</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;groups&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$g</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> Groups<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$aUsers</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getUsersOfGroup</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$groupUID</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$aUsers</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #339933;">@=</span>assignedUsers<span style="color: #009900;">&#91;</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<!-- END UNIQUE ID Functions -->

<!-- USER Functions -->
<h2><span id="User_Functions">User Functions</span></h2>


<h3><span id="PMFCreateUser.28.29">PMFCreateUser()</span></h3>
<p><code>PMFCreateUser()</code> creates a new user with the given data.</p>

<codeblock><i>int</i> <strong>PMFCreateUser</strong>(<i>string</i> username, <i>string</i> password, <i>string</i> firstname, <i>string</i> lastname, <i>string</i> email,
   <i>string</i> role, <i>string</i> $dueDate = null, <i>string</i> $status = null)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>username</strong>: The username of the new user.</li>
    <li><i>string</i> <strong>password</strong>: The password of the new user, which can be up to 32 characters long. For more information, see <a href="../3.0/Authentication_Customization.html" title="Customizing Authentication">Customizing Authentication</a>.</li>
    <li><i>string</i> <strong>firstname</strong>: The first name of the user, which can be up to 50 characters long.</li>
    <li><i>string</i> <strong>lastname</strong>: The last name of the user, which can be up to 50 characters long.</li>
    <li><i>string</i> <strong>email</strong>: The email of the new user, which can be up to 100 characters long.</li>
    <li><i>string</i> <strong>role</strong>: The role of the new user can be the <tt>roleCode</tt> such as <code>'PROCESSMAKER_ADMIN'</code>, <code>'PROCESSMAKER_OPERATOR'</code>, <code>'PROCESSMAKER_MANAGER'</code> or the <tt>roleUid</tt> that is a unique UID of 32 characters long.</li>
    <li><i>string</i> <strong>dueDate</strong>: <i>Optional.</i> The date in <code>'YYYY-MM-DD'</code> format when the user's account will become inactive. If not included, then set to December 31 of the next year by default.</li>
    <li><i>string</i> <strong>status</strong>: <i>Optional.</i> The status of the user, which can be <code>'ACTIVE'</code> (default), <code>'INACTIVE'</code>, or <code>'VACATION'</code>. If set to <code>'INACTIVE'</code> or <code>'VACATION'</code>, the user can't be designated to work on tasks in cases.</li>
</ul>
<p><strong>Return Value:</strong></p>
<ul><li>Returns 1 if the new user was created successfully; otherwise, returns 0 if an error occurred.</li></ul>
<p><strong>Example 1:</strong></p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$var</span> <span style="color: #339933;">=</span> PMFCreateUser<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'jsmith'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'PaSsWoRd'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'John'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'Smith'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'jsmith@company.com'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'PROCESSMAKER_OPERATOR'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$var</span> <span style="color: #339933;">==</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp; <span style="color: #339933;">@@</span>result <span style="color: #339933;">=</span> <span style="color: #0000ff;">'not created'</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">else</span><br />
&nbsp; &nbsp; <span style="color: #339933;">@@</span>result <span style="color: #339933;">=</span> <span style="color: #0000ff;">'created'</span><span style="color: #339933;">;</span></div></div>

<p><strong>Example 2:</strong></p>
<p>PMFCreateUser() does not set all the available properties for a user. The following example shows how to use the Users::create() method to set the rest of the user's properties.
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$username</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'daniela'</span><span style="color: #339933;">;</span><br />
<span style="color: #339933;">@%</span>result <span style="color: #339933;">=</span> PMFCreateUser<span style="color: #009900;">&#40;</span><span style="color: #000088;">$username</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'sample'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'Daniela'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'Baker'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'daniela@example.com'</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp;<span style="color: #0000ff;">'PROCESSMAKER_OPERATOR'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'2018-12-31'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'ACTIVE'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #339933;">@%</span>result<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">require_once</span> <span style="color: #0000ff;">'classes/model/Users.php'</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$u</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> Users<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$aUser</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$u</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">loadByUsernameInArray</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$username</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$aUser</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$u</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">load</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_COUNTRY'</span><span style="color: #009900;">&#93;</span> &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=</span> <span style="color: #0000ff;">'US'</span><span style="color: #339933;">;</span> &nbsp; <span style="color: #666666; font-style: italic;">//United States</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_CITY'</span><span style="color: #009900;">&#93;</span> &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=</span> <span style="color: #0000ff;">'NY'</span><span style="color: #339933;">;</span> &nbsp; <span style="color: #666666; font-style: italic;">//New York</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_LOCATION'</span><span style="color: #009900;">&#93;</span> &nbsp; &nbsp; <span style="color: #339933;">=</span> <span style="color: #0000ff;">'BUF'</span><span style="color: #339933;">;</span> &nbsp;<span style="color: #666666; font-style: italic;">//Buffalo</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_ADDRESS'</span><span style="color: #009900;">&#93;</span> &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;371 Everest Ave<span style="color: #000099; font-weight: bold;">\n</span>Clearview NC&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_PHONE'</span><span style="color: #009900;">&#93;</span> &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=</span> <span style="color: #0000ff;">'1-374-234-2322'</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_ZIP_CODE'</span><span style="color: #009900;">&#93;</span> &nbsp; &nbsp; <span style="color: #339933;">=</span> <span style="color: #0000ff;">'46135'</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_POSITION'</span><span style="color: #009900;">&#93;</span> &nbsp; &nbsp; <span style="color: #339933;">=</span> <span style="color: #0000ff;">'Chief Accountant'</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$aReplaced</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$u</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">loadByUsernameInArray</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'dsmith'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_REPLACED_BY'</span><span style="color: #009900;">&#93;</span> &nbsp;<span style="color: #339933;">=</span> <span style="color: #000088;">$aReplaced</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">&quot;USR_UX&quot;</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;SWITCHABLE&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//$aUser[&quot;USR_COST_BY_HOUR&quot;] = 20.00; &nbsp;//enterprise edition only</span><br />
&nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//$aUser[&quot;USR_UNIT_COST&quot;] = &quot;hours&quot;; &nbsp;//enterprise edition only</span><br />
&nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//$aUser[&quot;USR_TIME_ZONE&quot;] = 'America/New_York'; //enterprise edition only</span><br />
&nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//$aUser[&quot;USR_DEFAULT_LANG&quot;] = 'es'; //enterprise edition only</span><br />
&nbsp; &nbsp;<span style="color: #339933;">@@</span>res <span style="color: #339933;">=</span> <span style="color: #000088;">$u</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">create</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aUser</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>


<h3><span id="PMFInformationUser.28.29">PMFInformationUser()</span></h3>
<p><code>PMFInformationUser()</code> retrieves information about a specified user.</p>

<codeblock><i>array</i> <strong>PMFInformationUser</strong>(<i>string</i> $userUID)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li><i>string</i> <strong>userUID</strong>: The user's unique ID, which can be found in the following ways:
<ul><li>Get the UID of the currently logged-in user with the <code>@@USER_LOGGED</code> system variable or <code>$_SESSION['USER_LOGGED']</code>.</li>
    <li>Use the <a href="#PMFUserList.28.29">PMFUserList()</a> or <a href="../index.php/Simple_Trigger_Web_Services.html#WSUserList" title="Simple Trigger Web Services">WSUserList()</a> functions, or the <a href="../3.0/ProcessMaker_WSDL_Web_Services.html#userList.28.29" title="ProcessMaker WSDL Web Services">userList()</a> web service or the REST endpoint <a href="../3.0/REST_API_Administration.html#Get_Users_List:_GET_.2Fusers">GET /api/1.0/{workspace}/users</a>.</li>
    <li>Query the <strong><tt>wf_&lt;WORKSPACE&gt;.USERS.USR_UID</tt></strong> field in the database with <a href="#executeQuery.28.29">executeQuery()</a>.</li></ul>
</li>
</ul>
<p><strong>Return Value:</strong></p>
<p>An associative array with the following keys:</p>
<table class=codecolumn>
    <tr>
        <td>array( </td>
        <td></td>
    </tr>
    <tr>
        <td> 'username', </td>
        <td>The username, which must be unique.</li>
            <tr>
                <td> 'firstname',</td>
                <td>The user's first name (maximum of 50 characters).</td>
            </tr>
            <tr>
                <td> 'lastname', </td>
                <td>The user's last name (maximum of 50 characters).</td>
            </tr>
            <tr>
                <td> 'mail', </td>
                <td>The user's email address (maximum of 100 characters).</td>
            </tr>
            <tr>
                <td> 'address', </td>
                <td>The user's address (maximum of 255 characters).</td>
            </tr>
            <tr>
                <td> 'zipcode', </td>
                <td>The user's zip or postal code (maximum of 16 characters).</td>
            </tr>
            <tr>
                <td> 'country', </td>
                <td>The user's country.</td>
            </tr>
            <tr>
                <td> 'state', </td>
                <td>The user's state, province or region.</td>
            </tr>
            <tr>
                <td> 'location', </td>
                <td>The user's location.</td>
            </tr>
            <tr>
                <td> 'phone', </td>
                <td>The user's phone number (maximum of 24 characters).</td>
            </tr>
            <tr>
                <td> 'cellular', </td>
                <td>The user's cellular phone number (maximum of 24 characters).</td>
            </tr>
            <tr>
                <td> 'birthday', </td>
                <td>The user's birthday in <code>"YYYY-MM-DD"</code> format. Ex: <code>"1970-11-24"</code></td>
            </tr>
            <tr>
                <td> 'position', </td>
                <td>The user's position.</td>
            </tr>
            <tr>
                <td> 'replacedby', </td>
                <td>The unique ID of the user who will replace the user, when his/her status changes to <code>INACTIVE</code>                    or <code>VACATION</code>.</td>
            </tr>
            <tr>
                <td> 'replacedbyfullname', </td>
                <td>The first and last name of the of the user who will replace the user, when his/her status changes
                    to <code>INACTIVE</code> or <code>VACATION</code>.
                <p style="margin-left:25px"><strong><font color="green">Note:</font></strong> <font color="dimgray">This element is only defined if <code>['replacedby']</code> is not an empty string.</font></p></td>
            </tr>
            <tr>
                <td> 'duedate', </td>
                <td>Date when the user account will expire in <code>'YYYY-MM-DD'</code> format. Ex: <code>"2020-12-31"</code></td>
            </tr>
            <tr>
                <td> 'calendar', </td>
                <td>The unique ID of the user's calendar.</td>
            </tr>
            <tr>
                <td> 'calendarname', </td>
                <td>The name of the user's calendar.
                <p style="margin-left:25px"><strong><font color="green">Note:</font></strong> <font color="dimgray">This element is only defined if <code>['calendar']</code> is not an empty string.</font></p></td>
            </tr>
            <tr>
                <td> 'status', </td>
                <td>The user's status, which can be: <code>ACTIVE</code>, <code>INACTIVE</code> or <code>VACATION</code>.</td>
            </tr>
            <tr>
                <td> 'department', </td>
                <td>The unique ID of the user's department.</td>
            </tr>
            <tr>
                <td> 'departmentname', </td>
                <td>The name of the user's department.
                <p style="margin-left:25px"><strong><font color="green">Note:</font></strong> <font color="dimgray">This element is only defined if <code>['department']</code> is not an empty string.</font></p></td>
            </tr>
            <tr>
                <td> 'reportsto', </td>
                <td>The unique ID of the user's supervisor in the department. Use the <code>PMFInformationUser()</code>                    function a second time to get his/her name.</td>
            </tr>
            <tr>
                <td> 'userexperience', </td>
                <td>The User Experience setting, which can be: <code>NORMAL</code>, <code>SINGLE</code> (for a single
                    application), <code>SIMPLIFIED</code> (for mobile interfaces), or <code>SWITCHABLE</code> (to
                    be able to change between the normal and the simplified interfaces).</td>
            </tr>
            <tr>
                <td> 'photo' </td>
                <td>The path where the user's photo file is stored on the ProcessMaker server at:</br>
                    <code>&lt;INSTALL-DIRECTORY&gt;/shared/sites/&lt;WORKSPACE&gt;/usersPhotographies/&lt;USER-UID&gt;.gif</code><br>                    For example:<br>
                    <code>/opt/processmaker/shared/sites/workflow/usersPhotographies/9108004215481b57a6e38b3002299563.gif</code><br>                    The URL to access the user's photo would be:<br>
                    <code>http://&lt;IP-ADDRESS&gt;/sys&lt;WORKSPACE/&lt;LANG&gt;/&lt;SKIN&gt;/users/users_ViewPhotoGrid?pUID=&lt;USER-UID&gt;</code><br>                    For example:<br>
                    <code>http://example.com/sysworkflow/en/neoclassic/users/users_ViewPhotoGrid?pUID=9108004215481b57a6e38b3002299563</code><br>
                    <strong><font color="green">Note:</font></strong> <font color="dimgrey">The extension of the photo file is always renamed as <strong><tt>.gif</tt></strong>, even if the file is JPEG or PNG, which can cause problems displaying the image in some web browsers because the file extension doesn't match the file type. The <a  href="http://php.net/manual/en/function.finfo-file.php">finfo_file()</a> function can be used to check whether the MIME file type is "image/png", "image/jpeg" or "image/gif".</font></td>
            </tr>
            <tr>
                <td>)</td>
                <td></td>
            </tr>
</table>

<p>For example:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;username&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;Eve&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;firstname&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;Jones&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;lastname&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;ejones&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;mail&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;eve@example.com&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;address&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;235 W. Oak Av.&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;zipcode&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;81643&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;country&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;United States&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;state&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;Florida&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;location&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;Miami Lakes&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;phone&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;1-317-453-8776&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;fax&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;1-305-402-0282&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;cellular&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;1-305-675-1400&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;birthday&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;1980-02-25&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;position&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;Accountant&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;replacedby&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;22515138055fc47dcf0d786050067981&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;replacedbyfullname&quot;</span><span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;Bob Smith&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;duedate&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;2020-01-01&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;calendar&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;16215376855fc5e051e7499057282210&quot;</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;calendarname&quot;</span> &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;Florida Calendar&quot;</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;status&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;ACTIVE&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;department&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;79557529255fc48a94665a1003191338&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;departmentname&quot;</span> &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;Accounting&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;reportsto&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;14944204555fc4860983227093956871&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;userexperience&quot;</span> &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;NORMAL&quot;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; <span style="color: #0000ff;">&quot;photo&quot;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">&quot;/opt/pm3.1/shared/sites/workflow/usersPhotographies/63431366054f5d20ec91ce1029282852.gif&quot;</span><br />
<span style="color: #009900;">&#41;</span></div></div>

<p><strong>Example getting a phone number:</strong></p>
<p>Look up the phone number of the user currently logged in and assign it to a case variable named @@Phone, which will be displayed in a subsequent Dynaform field:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$aUser</span> <span style="color: #339933;">=</span> PMFInformationUser<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #339933;">@@</span>Phone <span style="color: #339933;">=</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'phone'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span></div></div>

<p><b>Example getting an address:</b></p>
<p>Look up the address of a user whose username is "jdoe" and assign it to the @@Address variable, which will be displayed in a textarea associated with that variable in a subsequent Dynaform. The address is a US style address.</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$username</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'jdoe'</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT USR_UID FROM USERS WHERE USR_USERNAME='<span style="color: #006699; font-weight: bold;">$username</span>' &quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$aUser</span> <span style="color: #339933;">=</span> PMFInformationUser<span style="color: #009900;">&#40;</span> <span style="color: #000088;">$result</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_UID'</span><span style="color: #009900;">&#93;</span> <span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #339933;">@@</span>Address <span style="color: #339933;">=</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'address'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#40;</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'location'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span> ? <span style="color: #0000ff;">''</span> <span style="color: #339933;">:</span> <span style="color: #0000ff;">&quot;<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'location'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">.</span><span style="color: #0000ff;">', '</span><span style="color: #339933;">.</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'state'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">.</span><span style="color: #0000ff;">' '</span><span style="color: #339933;">.</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'zipcode'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#40;</span><span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'country'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">==</span> <span style="color: #0000ff;">'United States'</span> or <a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'country'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span> ? <span style="color: #0000ff;">''</span> <span style="color: #339933;">:</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'country'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<p><strong>Example showing user information in a grid:</strong></p>
<p>Create a Dynaform with a grid. When dropping the Grid element, create a new variable named userInformation that is associated to the grid.</p>

<p><img src="../sites/default/files/3.0InfoUserGridsVariable.png"></p>

<p>Add the following controls inside the grid:
<ul>
  <li>A <a href="../3.0/Text_and_Textarea_Controls.html#Textbox_Control">Textbox</a> with ID: <code>username</code>.</li>
  <li>A <a href="../3.0/Text_and_Textarea_Controls.html#Textbox_Control">Textbox</a> with ID: <code>firstname</code>.</li>
  <li>A <a href="../3.0/Text_and_Textarea_Controls.html#Textbox_Control">Textbox</a> with ID: <code>lastname</code>.</li>
  <li>A <a href="../3.0/Text_and_Textarea_Controls.html#Textbox_Control">Textbox</a> with ID: <code>mail</code>.</li>
  <li>A <a href="../3.0/Text_and_Textarea_Controls.html#Textbox_Control">Textbox</a> with ID: <code>address</code>.</li>
  <li>A <a href="../3.0/Text_and_Textarea_Controls.html#Textbox_Control">Textbox</a> with ID: <code>zipcode</code>.</li>
</ul>
</p>

<p><img src="../sites/default/files/3.0InfoUserGridsDynaform.png"></p>

<p>Save the changes and close the Dynaform. Then, create a trigger with the following parameters:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>userInformation <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #339933;">@@</span>userInformation<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> PMFInformationUser<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'50125991157c071f6d684f8088171283'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<p>Where:
<ul>
<li><code>@@userInformation[1]</code>: Name of the grid where the information will be displayed.  Moreover, the grid name is defined as [1] because the return value is a grid and it has to start on 1 to display information in the corresponding fields.
</li>
</ul>

<p>Set the above trigger to fire <i>before</i> the Dynaform. While running a case, the user's information will be displayed in the grid:</p>

<p><img alt="" src="../sites/default/files/3.0InfoUserGridsResult.png"></p>

<p>Also, this function can be created by using the Trigger Wizard:</p>

<p><img alt="" src="../sites/default/files/3.0InfoUserGridsTriggerWizard.png"></p>

<p><strong>Example showing a group of users in a grid:</strong></p>
<p>This example shows a grid in a Dynaform that lists information about the users in a group named <b>Managers</b>.</p>

<p><img src="../sites/default/files/3.0ListUsersGridsManagersGroup.png"></p>

<p>First, create a Dynaform with a grid. When dropping the Grid element, create a new variable named listGroup that is associated to the grid.</p>

<p><img src="../sites/default/files/3.0listUsersGridsVariable.png"></p>


<p>Add the following controls inside the grid:
<ul>
  <li>A <a href="../3.0/Text_and_Textarea_Controls.html#Textbox_Control">Textbox</a> with ID: <code>username</code>.</li>
  <li>A <a href="../3.0/Text_and_Textarea_Controls.html#Textbox_Control">Textbox</a> with ID: <code>firstname</code>.</li>
  <li>A <a href="../3.0/Text_and_Textarea_Controls.html#Textbox_Control">Textbox</a> with ID: <code>lastname</code>.</li>
  <li>A <a href="../3.0/Text_and_Textarea_Controls.html#Textbox_Control">Textbox</a> with ID: <code>mail</code>.</li>
  <li>A <a href="../3.0/Text_and_Textarea_Controls.html#Textbox_Control">Textbox</a> with ID: <code>address</code>.</li>
  <li>A <a href="../3.0/Text_and_Textarea_Controls.html#Textbox_Control">Textbox</a> with ID: <code>zipcode</code>.</li>
</ul>

<p><img src="../sites/default/files/3.0ListUsersGridsDynaform.png"></p>

<p>After that, create the following trigger, which will use the <a href="#executeQuery.28.29">executeQuery()</a> function to look up the members of the group named <b>Managers</b>. It then loops through the list of users and looks up information about each user, then adds it to an array named "ListGroup", which will be displayed in the grid. Remember that grids are stored as an associative array of associative arrays, where the outer array is numbered, starting from 1 for each row in the array, and the keys in the inner array are the fields in the grid:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$query</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;SELECT U.USR_UID<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FROM GROUPWF <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LEFT JOIN GROUP_USER GU &nbsp;ON (GROUPWF.GRP_UID = GU.GRP_UID) <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LEFT JOIN USERS U ON (U.USR_UID = GU.USR_UID)<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WHERE U.USR_STATUS='ACTIVE' AND GROUPWF.GRP_TITLE = 'Managers'&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$users</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$query</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #b1b100;">for</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$i</span> <span style="color: #339933;">=</span> <span style="color: #cc66cc;">1</span><span style="color: #339933;">;</span> <span style="color: #000088;">$i</span> <span style="color: #339933;">&lt;=</span> <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #000088;">$i</span><span style="color: #339933;">++</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339933;">@@</span>listGroup<span style="color: #009900;">&#91;</span><span style="color: #000088;">$i</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> PMFInformationUser<span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span><span style="color: #009900;">&#91;</span><span style="color: #000088;">$i</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<p>While running a case, the information about the Managers group members will be displayed in the grid:</p>

<p><img alt="" src="../sites/default/files/3.0ListUsersGridsResults.png"></p>

<p><strong>Example looking up information about the Supervisor:</strong></p>
<p>The following trigger code retrieves information about the user currently logged in and then looks up information about the user's supervisor, whose unique ID is listed in the 'reportsto' key of the array. It also uses the <a href="#executeQuery.28.29">executeQuery()</a> function to look up the name of the department in the <strong><tt>DEPARTMENT</tt></strong> table. The trigger then uses the <code>G:SendMessageText()</code> function to display a message in the next screen telling the user to contact his/her supervisor:</p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$user</span> <span style="color: #339933;">=</span> PMFInformationUser<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$user</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'reportsto'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">!=</span><span style="color: #009900; font-weight: bold;">NULL</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$infoUser</span> <span style="color: #339933;">=</span> PMFInformationUser<span style="color: #009900;">&#40;</span><span style="color: #000088;">$user</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'reportsto'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$query</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;SELECT DEP_UID FROM DEPARTMENT WHERE DEP_TITLE = '<span style="color: #006699; font-weight: bold;">{$infoUser['department']}</span>'&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$dept</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$query</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
&nbsp; &nbsp; <span style="color: #000088;">$msg</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;Please contact your supervisor <span style="color: #006699; font-weight: bold;">{$infoUser['firstname']}</span> <span style="color: #006699; font-weight: bold;">{$infoUser['lastname']}</span> &quot;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">&quot;(<span style="color: #006699; font-weight: bold;">{$infoUser['mail']}</span>) of the <span style="color: #006699; font-weight: bold;">{$dept[1]['CON_VALUE']}</span> Department for authorization of this decision.&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$g</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> G<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">SendMessageText</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$msg</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;WARNING&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span><br />
<span style="color: #b1b100;">else</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$g</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> G<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; <span style="color: #000088;">$g</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">SendMessageText</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;You do not have authorization for this decision, &quot;</span><span style="color: #339933;">.</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">&quot;because it needs a supervisor's approval, but you don't have a supervisor.&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;ERROR&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>

<p>Note that the PHP variables inserted in the $msg string are enclosed in <code>{...}</code> (curly brackets) so that they can access the array's key correctly.</p>

<p><img alt="" src="../sites/default/files/3.0SupervisorMessageResults.png"></p>

<p><strong>Example getting a Calendar, Replaced By User, or Department safely:</strong></p>
<p><code>PMFInformationUser()</code> defines <code>['calendarname']</code>, <code>['departmentname']</code>, and <code>['replacebyfullname']</code> if <code>['calendar']</code>, <code>['department']</code>, and <code>['replacedby']</code> are not empty strings, respectively. Also <code>PMFInformationUser()</code> doesn't return the user's role and so internal functions have to be used to get the role. Currently, the user has to use this code to get a Calendar, Replaced By User, or Department safely:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$aUser</span> <span style="color: #339933;">=</span> PMFInformationUser<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #339933;">@@</span>calendarName <span style="color: #339933;">=</span> <a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'calendar'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span> ? &nbsp;<span style="color: #0000ff;">''</span> <span style="color: #339933;">:</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'calendarname'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<span style="color: #339933;">@@</span>deptName <span style="color: #339933;">=</span> <a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'department'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span> ? <span style="color: #0000ff;">''</span> <span style="color: #339933;">:</span> &nbsp;<span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'departmentname'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<span style="color: #339933;">@@</span>replacedName <span style="color: #339933;">=</span> &nbsp;<a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'replacedby'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span> ? <span style="color: #0000ff;">''</span> <span style="color: #339933;">:</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'replacedbyfullname'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span></div></div>
<p style="margin-left:25px"><strong><font color="green">Note:</font></strong> <font color="dimgray">Because there is no ProcessMaker function to get the role, the <code>Users::Load()</code> function can be used to get the user's role, as shown in the following example:
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$u</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> Users<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$aUserInfo</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$u</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">Load</span><span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$role</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$aUserInfo</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">&quot;USR_ROLE&quot;</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span></div></div>
</font></p>

<h3><span id="PMFRoleList.28.29">PMFRoleList()</span></h3>
<p><code>PMFRoleList()</code> returns a list of all the <a href="Roles.html" title="Roles">roles</a> in the current workspace.</p>

<codeblock><i>array</i> <strong>PMFRoleList</strong>(<i>void</i>)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul><li>None.</li></ul>
<p><strong>Return Value:</strong></p>
<ul><li>This function returns an array of roles, with the following structure:</li></ul>

<codeblock>[0] <i>array</i>
(
    <i>associative array</i>
    (
        [<i>string</i> guid]
        [<i>string</i> name]
    )
)
...
</codeblock>

<p><strong>Where:</strong></p>
<ul><li><i>string</i> <strong>guid</strong>: The unique ID of a role.</li>
    <li><i>string</i> <strong>name</strong>: The name of a role.</li></ul>
<p><strong>Example:</strong></p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$aRoles</span> <span style="color: #339933;">=</span> PMFRoleList<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #666666; font-style: italic;">//Counting in the array starts from 1</span><br />
<span style="color: #339933;">@@</span>RoleName <span style="color: #339933;">=</span> <span style="color: #000088;">$aRoles</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'name'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span></div></div>


<h3><span id="PMFUpdateUser.28.29">PMFUpdateUser()</span></h3>
<p><code>PMFUpdateUser()</code> updates a specified user's information.</p>

<codeblock><i>int</i> <strong>PMFUpdateUser</strong>(<i>string</i> userUID, <i>string</i> userName, <i>string</i> firstName = null, <i>string</i> lastName = null,
   <i>string</i> email = null, <i>string</i> dueDate = null, <i>string</i> status = null, <i>string</i> role = null, password = null)
</codeblock>

<p><strong>Parameters:</strong></p>
<ul>
    <li><i>string</i> <strong>userUID</strong>: The unique ID of the user whose information will be updated.</li>
    <li><i>string</i> <strong>userName</strong>: The username of the user.</li>
    <li><i>string</i> <strong>firstname</strong>: <i>Optional.</i> The first name of the user, which can be up to 50 characters long.</li>
    <li><i>string</i> <strong>lastname</strong>: <i>Optional.</i> The last name of the user, which can be up to 50 characters long.</li>
    <li><i>string</i> <strong>email</strong>: <i>Optional.</i> The email of the user, which can be up to 100 characters long.</li>
    <li><i>string</i> <strong>dueDate</strong>: <i>Optional.</i> The expiration date of the user's account, which must be a string in the format "YYYY-MM-DD".</li>
    <li><i>string</i> <strong>status</strong>: <i>Optional.</i> The user's status, which can be <code>'ACTIVE'</code>, <code>'INACTIVE'</code> or <code>'VACATION'</code>.</li>
    <li><i>string</i> <strong>role</strong>: <i>Optional.</i> The role of the new user can be the <tt>roleCode</tt> such as <code>'PROCESSMAKER_ADMIN'</code>, <code>'PROCESSMAKER_OPERATOR'</code>, <code>'PROCESSMAKER_MANAGER'</code> or the <tt>roleUid</tt> that is a unique UID of 32 characters long.</li>
    <li><i>string</i> <strong>password</strong>: <i>Optional.</i> The password of the user, which can be up to 32 characters long. For more information, see <a href="../3.0/Authentication_Customization.html" title="Customizing Authentication">Customizing Authentication</a>.</li></ul>

<p><strong>Return Value:</strong></p>
<ul><li>Returns 1 if the user has been successfully updated; otherwise, returns 0 if an error occurred.</li></ul>
<p><strong>Example:</strong></p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span><span style="color: #b1b100;">return</span> <span style="color: #339933;">=</span> PMFUpdateUser<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #339933;">,</span> <span style="color: #0000ff;">'jdoe'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'John'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'Doe'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'jdoe@example.com'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'2020-12-31'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'ACTIVE'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'PROCESSMAKER_OPERATOR'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'p4ssw0rd'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<h3><span id="PMFUserList.28.29">PMFUserList()</span></h3>
<p><code>PMFUserList()</code> returns a list of users whose status is set to "ACTIVE" in the current workspace.</p>

<codeblock> <i>array</i> <strong>PMFUserList</strong>(<i>void</i>)
</codeblock>

<p><strong>Parameters:</strong></p>
<p>None.</p>
<p><strong>Return Value:</strong></p>
<p>An array of users, with the following structure:</p>

<codeblock>[0] <i>array</i>
(
    <i>associative array</i>
    (
        [<i>string</i> guid]
        [<i>string</i> name]
    )
)
...
</codeblock>

<p><strong>Where:</strong></p>
<ul><li><i>string</i> <strong>guid</strong>: The unique ID of a user.</li>
    <li><i>string</i> <strong>name</strong>: The username of a user.</li></ul>
<p><strong>Example:</strong></p>

<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>GRID_USERS <span style="color: #339933;">=</span> PMFUserList<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>

<h3><span id="userInfo.28.29">userInfo()</span></h3>
<p><code>userInfo()</code> in version 3.X is an alias for the <a href="#PMFInformationUser.28.29">PMFInformationUser()</a> function.</p>

<codeblock><i>array</i> <strong>userInfo</strong>(<i>string</i> USER_ID)
</codeblock>

<!-- END USER Functions -->
</div></div></div>  </div>

      <footer>
          </footer>
  
    </div>
  
</div> <!-- /.block -->
</div>
 <!-- /.region -->
      </section>
    </div>
  
      
    </div>

      
</div>

 <!---add diego--->
  <div id="download-app-section" class="download-app mobile-none">
			<div class="row">
				<div class="col-md-12">
					<div class="text_app">Download our app</div>
							<a href="https://itunes.apple.com/us/app/processmaker/id992576284?ls=1&amp;mt=8" target="_blank">
								<img src="../themes/thecompany_responsive_theme/images/appstore.png">
							<a href="https://play.google.com/store/apps/details?id=com.colosa.processmaker" target="_blank">
								<img src="../themes/thecompany_responsive_theme/images/playstore.png">				
				</div>
			</div>
  </div>
  <!---end diego--->
<!----add diego----->    
		<div class="logo_processmaker"><a href="http://www.processmaker.com/">
		<img src="../themes/thecompany_responsive_theme/images/logo_processmaker.png"></div>
<!----end diego----->
<div id="footer">
  <div id="footer_wrapper">
      </div>

  <div class="social-media-wrapper">
         <div id="social-media-icons">
       <ul>
       	<div class="text_contact">Contact us</div>
				<div class="text_number">+1-617-340-3377</div>
        <!--<li><a class="rss" href="/rss.xml">rss</a></li> <!--edit diego-->
        <li><a class="facebook" href="http://facebook.com/processmaker/" target="_blank" rel="me">facebook</a></li>
        <li><a class="twitter" href="https://twitter.com/processmaker" target="_blank" rel="me">twitter</a></li>
        <li><a class="gplus" href="https://www.google.com/+ProcessMakerOpenSource" target="_blank" rel="me">Gplus</a></li>
        <li><a class="linkedin" href="https://www.linkedin.com/groups?mostRecent=&amp;gid=3970335&amp;trk=my_groups-tile-flipgrp" target="_blank" rel="me">Linked in</a></li>
        <!--<li><a class="dribbble" href="http://dribbble.com" target="_blank" rel="me">Dribbble</a></li>
        <li><a class="vimeo" href="http://vimeo.com" target="_blank" rel="me">Vimeo</a></li>-->
        <li><a class="youtube" href="https://www.youtube.com/user/processmaker" target="_blank" rel="me">Youtube</a></li>
       </ul>
      </div>
      </div>
  
  <div class="footer_credit">
    <div class="footer_inner_credit">
           <div id="foot"><div class="region region-footer">
  <div id="block-block-2" class="block block-block">

      
  <div class="content">
    <p><font style="font-family:arial,sans-serif; font-size:15px; font-weight: none; color:#FFF">Automate your Workflow with Business Process Management<br>Software licensed under the <a 1px="" class="external text" href="http://www.gnu.org/licenses/agpl.html" rel="nofollow" style="padding-right: 13px; color:white;">GNU Affero General Public License version 3</a><br>Contact us:&nbsp;<a class="external free" href="mailto:community@processmaker.com" rel="nofollow" style="font-weight:bold;color:white;text-decoration:underline;">community@processmaker.com</a><br><a class="external free" href="https://www.processmaker.com/privacy-statement" rel="nofollow" style="font-weight:bold;color:white;text-decoration:underline;">Privacy Statement</a></font><br><font style="font-family:arial,sans-serif; font-size:15px; font-weight: none; color:#FFF">© Copyright 2000-2024 ProcessMaker Inc. All rights reserved.</font></p>
  </div>
  
</div> <!-- /.block -->
</div>
 <!-- /.region -->
</div>
         
   <!-- <div id="copyright">
      <p class="copyright">Copyright &copy; 2024, Documentation@ProcessMaker </p>
      <!--<p class="credits"> Developed by  <a href="http://www.zymphonies.com">Zymphonies</a></p>
      <div class="clear"></div>
    </div>-->
  </div>
  
  </div>
</div>

</div>

<script type="text/javascript">
  /* <![CDATA[ */
  document.write (
    '<img src="https://marketing.processmaker.com/acton/bn/3812/visitor.gif?ts='+ new Date().getTime()+ '&ref='+escape(document.referrer) + '">'
  );
  /* ]]> */
</script>
  
</div>
    <style>
    .center-div{
        width: 100%;        
        margin: 0 auto;
        z-index:10000;
        position:fixed;
        bottom: 0px;
        cursor:pointer;
    }
    .round-popup{
        margin:0 auto;
        font-family: 'Montserrat', sans-serif;
        font-size: 15px;
        font-weight: lighter;
        width: 412px;
        height: 50px;
        padding-top: 7px;
        text-align: center;
        position:relative;
    }
    .round-popup-button{
        position:absolute;
        top: 11px;
        right: 15px;
        background: transparent;
        border:none;
        font-size:15px;
        font-weight:normal;
        line-height:20px;
        width:20px;
        height:20px;
        padding:0;
    }
    .round-background-blue{
        background: url('http://www.processmaker.com/uploads/blue.png')no-repeat;
        color:white;
        
    }
    #box-pm31-button-blue{
        color: rgba(255, 255, 255, 0.5);
    }
    
    #box-pm31-button-blue:active,#box-pm31-button-blue:focus{
        border:none;
        outline:none;
    }
    .round-background-blue a{
        color: white!important;
        text-decoration: none;
        font-size: 15px;
        line-height:45px;
        font-family:Montserrat, sans-serif;
    }
    .round-background-blue span{
        font-weight: bold;
    }
    /*WHITE background*/
    .round-background-white{
        background: url('http://www.processmaker.com/uploads/white.png')no-repeat;
        background-position-x: -9px;        
        color: #3397E1;
    }
    .round-background-white a:hover{
        color: #3397E1!important;
        text-decoration: none;
        font-size: 15px;
    }
    #box-pm31-button-white{
        color: rgba(51, 151, 225, 0.7);
    }
</style>
    <div id="box-pm31" class="center-div" style="display:none;">
        <div class="round-popup round-background-blue">
            <a onclick="ga('send', 'event', 'WikiBlueBanner','click','PM31Release');" href="http://www.processmaker.com/download-processmaker-landing-page">
                <span>ProcessMaker 3.1</span> is Here! Download Now <span style="font-size:20px;font-weigth:normal;">»</span>
            </a>
            <button id="box-pm31-button-blue" class="round-popup-button">&times;</button>
        </div>
    </div>
    <script>

function pmCreateCookie(name,value,days) {
    if (days) {
        var date = new Date();
        date.setTime(date.getTime()+(days*24*60*60*1000));
        var expires = "; expires="+date.toGMTString();
    }
    else var expires = "";
    document.cookie = name+"="+value+expires+"; path=/";
}

function pmReadCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return null;
}

function pmEraseCookie(name) {
    createCookie(name,"",-1);
}



     jQuery(document).ready(function( $ ) {
        $('#box-pm31-button-blue').click(function(e){
                e.stopPropagation();
                $('#box-pm31').slideUp('fast');
                pmCreateCookie('ppcookie','val',10);
            });
        });
        jQuery(window).load(function() {
            if(pmReadCookie('ppcookie') !== 'val'){
                //jQuery('#box-pm31').delay( 2000 ).slideDown('slow');
            }
        });
    </script>
<link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet">

<script type="text/javascript">
  (function() {
    window._pa = window._pa || {};
    // _pa.orderId = "myOrderId"; // OPTIONAL: attach unique conversion identifier to conversions
    // _pa.revenue = "19.99"; // OPTIONAL: attach dynamic purchase values to conversions
    // _pa.productId = "myProductId"; // OPTIONAL: Include product ID for use with dynamic ads
    var pa = document.createElement('script'); pa.type = 'text/javascript'; pa.async = true;
    pa.src = ('https:' == document.location.protocol ? 'https:' : 'http:') + "//tag.marinsm.com/serve/586a7ec3a2ae6b728400003d.js";
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(pa, s);
  })();
</script>

</body>

<!-- Mirrored from wiki.processmaker.com/3.1/ProcessMaker_Functions by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Feb 2024 09:32:22 GMT -->
</html>
