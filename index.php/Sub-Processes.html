<!DOCTYPE html>

<!-- Mirrored from wiki.processmaker.com/index.php/Sub-Processes by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Feb 2024 09:12:39 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta name="keywords" content="BPM, business process management, workflow, processmaker, business, BPM Windows, BPM Linux, wiki, BPM documentation, BPM FAQ, task documentation, BPM PHP, BPM Open Source, BPM Variables, BPM Installation, BPM Programming, BPM Elements, BPM Concepts, BPM Frequently Asked Questions, BPM 3.0, BPM News, Release notes, DynaForms, BPM Community, BPM Enterprise, BPM Mobile, BPM Responsive Web Design, User Manual, BPM Resources" />
<link rel="alternate" hreflang="en" href="../index.html" />
<link rel="shortcut icon" href="../themes/thecompany_responsive_theme/favicon.ico" type="image/vnd.microsoft.icon" />
<meta name="description" content="ProcessMaker is commercial open source workflow and business process management software." />
<meta name="viewport" content="width=device-width" />
<meta name="Generator" content="Drupal 7 (http://drupal.org)" />
<link rel="canonical" href="Sub-Processes.html" />
<link rel="shortlink" href="../node/129.html" />
<title>2.0 - Sub-Processes | Documentation@ProcessMaker</title>
<style type="text/css" media="all">
@import url("../modules/system/system.base2af9.css?s743n7");
@import url("../modules/system/system.menus2af9.css?s743n7");
@import url("../modules/system/system.messages2af9.css?s743n7");
@import url("../modules/system/system.theme2af9.css?s743n7");
</style>
<style type="text/css" media="all">
@import url("../modules/aggregator/aggregator2af9.css?s743n7");
@import url("../modules/comment/comment2af9.css?s743n7");
@import url("../modules/field/theme/field2af9.css?s743n7");
@import url("../modules/node/node2af9.css?s743n7");
@import url("../modules/search/search2af9.css?s743n7");
@import url("../modules/toc_filter/toc_filter2af9.css?s743n7");
@import url("../modules/user/user2af9.css?s743n7");
@import url("../modules/views/css/views2af9.css?s743n7");
</style>
<style type="text/css" media="all">
@import url("../sites/all/modules/colorbox/styles/default/colorbox_style2af9.css?s743n7");
@import url("../modules/ctools/css/ctools2af9.css?s743n7");
@import url("../sites/all/modules/geshifilter/geshifilter2af9.css?s743n7");
@import url("../modules/panels/css/panels2af9.css?s743n7");
@import url("../modules/nice_menus/css/nice_menus2af9.css?s743n7");
@import url("../modules/nice_menus/css/nice_menus_default2af9.css?s743n7");
@import url("../modules/fivestar/css/fivestar2af9.css?s743n7");
</style>
<style type="text/css" media="all">
@import url("../themes/thecompany_responsive_theme/css/style2af9.css?s743n7");
@import url("../themes/thecompany_responsive_theme/css/media2af9.css?s743n7");
</style>
<script type="text/javascript" src="../modules/jquery_update/replace/jquery/1.9/jquery.min4b17.js?v=1.9.1"></script>
<script type="text/javascript" src="../misc/jquery.once7839.js?v=1.2"></script>
<script type="text/javascript" src="../misc/drupal2af9.js?s743n7"></script>
<script type="text/javascript" src="../modules/nice_menus/js/jquery.bgiframef195.js?v=2.1"></script>
<script type="text/javascript" src="../modules/nice_menus/js/jquery.hoverIntent1f6b.js?v=0.5"></script>
<script type="text/javascript" src="../modules/nice_menus/js/superfish099d.js?v=1.4.8"></script>
<script type="text/javascript" src="../modules/nice_menus/js/nice_menusc619.js?v=1.0"></script>
<script type="text/javascript" src="../modules/jquery_update/replace/ui/external/jquery.cookie1683.js?v=67fb34f6a866c40d0570"></script>
<script type="text/javascript" src="../modules/jquery_update/replace/misc/jquery.form.min97e5.js?v=2.69"></script>
<script type="text/javascript" src="../misc/ajax2347.js?v=7.34"></script>
<script type="text/javascript" src="../modules/jquery_update/js/jquery_update241d.js?v=0.0.1"></script>
<script type="text/javascript" src="../modules/toc_filter/toc_filter2af9.js?s743n7"></script>
<script type="text/javascript" src="../sites/all/modules/colorbox/js/colorbox2af9.js?s743n7"></script>
<script type="text/javascript" src="../sites/all/modules/colorbox/styles/default/colorbox_style2af9.js?s743n7"></script>
<script type="text/javascript" src="../sites/all/modules/google_analytics/googleanalytics2af9.js?s743n7"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
(function(i,s,o,g,r,a,m){i["GoogleAnalyticsObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,"script","../../www.google-analytics.com/analytics.js","ga");ga("create", "UA-3380652-1", {"cookieDomain":"auto"});ga("set", "anonymizeIp", true);ga("send", "pageview");
//--><!]]>
</script>
<script type="text/javascript" src="../misc/progress2347.js?v=7.34"></script>
<script type="text/javascript" src="../modules/fivestar/js/fivestar.ajax2af9.js?s743n7"></script>
<script type="text/javascript" src="../modules/fivestar/js/fivestar2af9.js?s743n7"></script>
<script type="text/javascript" src="../themes/thecompany_responsive_theme/js/jquery-1.10.2.min2af9.js?s743n7"></script>
<script type="text/javascript" src="../themes/thecompany_responsive_theme/js/jquery-ui2af9.js?s743n7"></script>
<script type="text/javascript" src="../themes/thecompany_responsive_theme/js/jquery-ui.min2af9.js?s743n7"></script>
<script type="text/javascript" src="../themes/thecompany_responsive_theme/js/custom2af9.js?s743n7"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"thecompany_responsive_theme","theme_token":"qQ-44ys-BUqyqIZcKl1uEpYSCskjVIg3vG_Cl8CMcr0","jquery_version":"1.9","js":{"modules\/jquery_update\/replace\/jquery\/1.9\/jquery.min.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"modules\/nice_menus\/js\/jquery.bgiframe.js":1,"modules\/nice_menus\/js\/jquery.hoverIntent.js":1,"modules\/nice_menus\/js\/superfish.js":1,"modules\/nice_menus\/js\/nice_menus.js":1,"modules\/jquery_update\/replace\/ui\/external\/jquery.cookie.js":1,"modules\/jquery_update\/replace\/misc\/jquery.form.min.js":1,"misc\/ajax.js":1,"modules\/jquery_update\/js\/jquery_update.js":1,"modules\/toc_filter\/toc_filter.js":1,"sites\/all\/modules\/colorbox\/js\/colorbox.js":1,"sites\/all\/modules\/colorbox\/styles\/default\/colorbox_style.js":1,"sites\/all\/modules\/google_analytics\/googleanalytics.js":1,"0":1,"misc\/progress.js":1,"modules\/fivestar\/js\/fivestar.ajax.js":1,"modules\/fivestar\/js\/fivestar.js":1,"themes\/thecompany_responsive_theme\/js\/jquery-1.10.2.min.js":1,"themes\/thecompany_responsive_theme\/js\/jquery-ui.js":1,"themes\/thecompany_responsive_theme\/js\/jquery-ui.min.js":1,"themes\/thecompany_responsive_theme\/js\/custom.js":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/system\/system.theme.css":1,"modules\/aggregator\/aggregator.css":1,"modules\/comment\/comment.css":1,"modules\/field\/theme\/field.css":1,"modules\/node\/node.css":1,"modules\/search\/search.css":1,"modules\/toc_filter\/toc_filter.css":1,"modules\/user\/user.css":1,"modules\/views\/css\/views.css":1,"sites\/all\/modules\/colorbox\/styles\/default\/colorbox_style.css":1,"modules\/ctools\/css\/ctools.css":1,"sites\/all\/modules\/geshifilter\/geshifilter.css":1,"modules\/panels\/css\/panels.css":1,"modules\/nice_menus\/css\/nice_menus.css":1,"modules\/nice_menus\/css\/nice_menus_default.css":1,"modules\/fivestar\/css\/fivestar.css":1,"themes\/thecompany_responsive_theme\/css\/style.css":1,"themes\/thecompany_responsive_theme\/css\/media.css":1}},"colorbox":{"opacity":"0.85","current":"{current} of {total}","previous":"\u00ab Prev","next":"Next \u00bb","close":"Close","maxWidth":"98%","maxHeight":"98%","fixed":true,"mobiledetect":true,"mobiledevicewidth":"480px","specificPagesDefaultValue":"admin*\nimagebrowser*\nimg_assist*\nimce*\nnode\/add\/*\nnode\/*\/edit\nprint\/*\nprintpdf\/*\nsystem\/ajax\nsystem\/ajax\/*"},"toc_filter_smooth_scroll_duration":"","googleanalytics":{"trackOutbound":1,"trackMailto":1,"trackDownload":1,"trackDownloadExtensions":"7z|aac|arc|arj|asf|asx|avi|bin|csv|doc(x|m)?|dot(x|m)?|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt(x|m)?|pot(x|m)?|pps(x|m)?|ppam|sld(x|m)?|thmx|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls(x|m|b)?|xlt(x|m)|xlam|xml|z|zip","trackColorbox":1},"nice_menus_options":{"delay":"800","speed":"slow"},"ajax":{"edit-vote--2":{"callback":"fivestar_ajax_submit","event":"change","url":"\/system\/ajax","submit":{"_triggering_element_name":"vote"}}}});
//--><!]]>
</script>
<!--[if lt IE 9]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','../../connect.facebook.net/en_US/fbevents.js');
// Insert Your Facebook Pixel ID below.
fbq('init', '735235999992228');
fbq('track', 'PageView');
</script>
<!-- Insert Your Facebook Pixel ID below. -->
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=735235999992228&amp;ev=PageView&amp;noscript=1"
/></noscript>
<!-- End Facebook Pixel Code -->

</head>
<body class="html not-front not-logged-in no-sidebars page-node page-node- page-node-129 node-type-community-edition">
    
<div class="wrap">

<div id="header_wrapper">
  <div id="inner_header_wrapper">

    <header id="header" role="banner">
      
      <div class="header_inner_wrapper">
        <div class="header_left">
                      <div id="logo">
              <a href="../index.html" title="Home"><img src="../sites/default/files/full-logo.png"/></a>
            </div>
                            <!--  <h1 id="site-title">
            <a href="/" title="Home">Documentation@ProcessMaker</a>
            <div id="site-description"></div>
          </h1> -->
            
        </div>
      </div>
      <div class="header_right">
          <div class="region region-search">
  <div id="block-search-form" class="block block-search">

        <h2 >_</h2>
    
  <div class="content">
    <form action="https://wiki.processmaker.com/index.php/Sub-Processes" method="post" id="search-block-form" accept-charset="UTF-8"><div><div class="container-inline">
    <div class="form-item form-type-textfield form-item-search-block-form">
  <label class="element-invisible" for="edit-search-block-form--2">Search </label>
 <input title="Enter the terms you wish to search for." placeholder="Search" type="text" id="edit-search-block-form--2" name="search_block_form" value="" size="15" maxlength="128" class="form-text" />
</div>
<div class="form-actions form-wrapper" id="edit-actions"><input type="submit" id="edit-submit" name="op" value="Search" class="form-submit" /></div><input type="hidden" name="form_build_id" value="form-pCdiSplHNsQ3L132j2cIAhJFXYOV_S1c41_cfp2A8Hs" />
<input type="hidden" name="form_id" value="search_block_form" />
</div>
</div></form>  </div>
  
</div> <!-- /.block -->
</div>
 <!-- /.region -->
                  <h1 class="page-title">2.0 - Sub-Processes</h1>                <p class="page-title-suffix"></p>
                 <div style="margin-top: 5px;"></div>
      </div>
    </header>
    <div class="region-version">
      <span>Version: </span><ul><li><a href="../3.2/Sub-Processes.html" class="">3.8</a></li><li><a href="../3.2/Sub-Processes.html" class="">3.7</a></li><li><a href="../3.2/Sub-Processes.html" class="">3.6</a></li><li><a href="../3.2/Sub-Processes.html" class="">3.5</a></li><li><a href="../3.2/Sub-Processes.html" class="">3.4</a></li><li><a href="../3.2/Sub-Processes.html" class="">3.3</a></li><li><a href="../3.2/Sub-Processes.html" class="">3.2</a></li><li><a href="../3.1/Sub-Processes.html" class="">3.1</a></li><li><a href="../3.0/Sub-Processes.html" class="">3.0</a></li><li><a  class="active-version">2.x</a></li></ul>    </div>
  </div>
</div>
<!-- <ul class="nice-menu nice-menu-down nice-menu-main-menu" id="nice-menu-0"><li class="menu-506 menu-path-node-1078 first odd "><a href="/PM_Classic" title="Learn how to develop business solutions in ProcessMaker Platform while maintaining your existing ProcessMaker 3 solutions in PM Classic: the perfect bridge between your new and existing solutions with a state-of--the-art BPM platform.">PM Classic</a></li>
<li class="menu-319 menu-path-processmakercom-tutorials  even "><a href="http://www.processmaker.com/tutorials" title="">Tutorials</a></li>
<li class="menu-320 menu-path-node-571  odd "><a href="/3.1/user_guide">User Guide</a></li>
<li class="menu-1138 menu-path-node-572  even "><a href="/3.1/developer_info">Developer Info</a></li>
<li class="menu-1197 menu-path-node-876  odd "><a href="/3.2/sys_administration">Sys Administration</a></li>
<li class="menu-1140 menu-path-node-236  even "><a href="/3.1/resources">Helpful Resources</a></li>
<li class="menu-1141 menu-path-node-554  odd "><a href="/Sitemap">Sitemap</a></li>
<li class="menu-1213 menu-path-sprocessmakergitbookio-processmaker-  even last"><a href="https://processmaker.gitbook.io/processmaker/" title="Read ProcessMaker Platform Spring 2023 documentation to learn more about the next generation of BPM.">ProcessMaker Platform</a></li>
</ul>
-->
  
  <div id="container">
    
    <div class="content-sidebar-wrap">

    <div id="content">

              <!-- <div id="breadcrumbs">
        <h2 class="element-invisible">You are here</h2><div class="breadcrumb"><a href="/">Home</a></div></div> -->
      
      <section id="post-content" role="main">
                                        <div class="region region-content">
  <div id="block-system-main" class="block block-system">

      
  <div class="content">
                          <span property="dc:title" content="2.0 - Sub-Processes" class="rdf-meta element-hidden"></span>  
      
    
  <div class="content node-community-edition">
    <div class="field field-name-field-how-useful field-type-fivestar field-label-above"><div class="field-label">Please rate how useful you found this document:&nbsp;</div><div class="field-items"><div class="field-item even"><form class="fivestar-widget" action="https://wiki.processmaker.com/index.php/Sub-Processes" method="post" id="fivestar-custom-widget" accept-charset="UTF-8"><div><div  class="clearfix fivestar-average-text fivestar-average-stars fivestar-form-item fivestar-default"><div class="form-item form-type-fivestar form-item-vote">
 <div class="form-item form-type-select form-item-vote">
 <select id="edit-vote--2" name="vote" class="form-select"><option value="-">Select rating</option><option value="20">Give 2.0 - Sub-Processes 1/5</option><option value="40">Give 2.0 - Sub-Processes 2/5</option><option value="60" selected="selected">Give 2.0 - Sub-Processes 3/5</option><option value="80">Give 2.0 - Sub-Processes 4/5</option><option value="100">Give 2.0 - Sub-Processes 5/5</option></select>
<div class="description"><div class="fivestar-summary fivestar-summary-average-count"><span class="average-rating">Average: <span >2.7</span></span> <span class="total-votes">(<span >3</span> votes)</span></div></div>
</div>

</div>
</div><input class="fivestar-submit form-submit" type="submit" id="edit-fivestar-submit" name="op" value="Rate" /><input type="hidden" name="form_build_id" value="form-RNeeCEmXkVhT4up8K7U8OGy3iaJzuclKbn6rNsJjmRw" />
<input type="hidden" name="form_id" value="fivestar_custom_widget" />
</div></form></div></div></div><div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><div style="float: right; margin-left: 5px; background-color: #f9f9f9; border: 1px solid #aaaaaa; padding: 5px;"><center><strong>Contents:</strong> [<a href="#" onclick="var el = document.getElementById('toc');
        var txt = ('innerText' in el)? 'innerText' : 'textContent';
        if (el.style.display=='none') { 
           el.style.display = '';
           document.getElementById('hideLabel')[txt] = 'hide';
        }
        else {
	        el.style.display = 'none';
           document.getElementById('hideLabel')[txt] = 'show';
        }"><span id="hideLabel">hide</span></a>]</b></center><div id="toc" ><ol class="toc">
<li class="toc"><a href="#Overview">Overview</a></li>
<li class="toc"><a href="#Types_of_Sub-Processes">Types of Sub-Processes</a></li>
<li class="toc"><a href="#Adding_a_Sub-Process_to_a_Master_Process">Adding a Sub-Process to a Master Process</a></li>
<ol class="toc">
<li class="toc"><a href="#Defining_the_Sub-process_Properties">Defining the Sub-process Properties</a></li>
<ol class="toc">
<li class="toc"><a href="#Variables_Out_.28and_In.29">Variables Out (and In)</a></li>
</ol>
<li class="toc"><a href="#Removing_a_subprocess_from_the_starting_cases_list">Removing a subprocess from the starting cases list</a></li>
</ol>
<li class="toc"><a href="#Example">Example</a></li>
<li class="toc"><a href="#Accessing_Objects_from_Master.2FSubprocess_Cases">Accessing Objects from Master/Subprocess Cases</a></li>
<ol class="toc">
<li class="toc"><a href="#Read-only_Access_to_Objects_from_the_Master_Case">Read-only Access to Objects from the Master Case</a></li>
<li class="toc"><a href="#Read-only_Access_to_Objects_from_the_Subprocess_Case.28s.29">Read-only Access to Objects from the Subprocess Case(s)</a></li>
<li class="toc"><a href="#Write_Access_To_Objects_from_the_Master_Case">Write Access To Objects from the Master Case</a></li>
<ol class="toc">
<li class="toc"><a href="#DynaForms">DynaForms</a></li>
<li class="toc"><a href="#Input_Documents">Input Documents</a></li>
<li class="toc"><a href="#Output_Documents">Output Documents</a></li>
</ol>
</ol>
<li class="toc"><a href="#Accessing_Subprocesses_in_Triggers">Accessing Subprocesses in Triggers</a></li>
<ol class="toc">
<li class="toc"><a href="#Accessing_Subprocess_Cases">Accessing Subprocess Cases</a></li>
<li class="toc"><a href="#Setting_Variables_In_Subprocess_Cases">Setting Variables In Subprocess Cases</a></li>
<li class="toc"><a href="#Mailing_currently_Designated_Users_for_Subprocess_Cases">Mailing currently Designated Users for Subprocess Cases</a></li>
<li class="toc"><a href="#Mailing_links_to_Master_and_Subprocess_Cases">Mailing links to Master and Subprocess Cases</a></li>
<li class="toc"><a href="#Displaying_a_List_of_Subprocess_Cases_in_a_Grid">Displaying a List of Subprocess Cases in a Grid</a></li>
<li class="toc"><a href="#Displaying_a_List_of_Subprocess_Cases_in_a_Text_Report">Displaying a List of Subprocess Cases in a Text Report</a></li>
<li class="toc"><a href="#Accessing_the_Master_Process_Case">Accessing the Master Process Case</a></li>
<li class="toc"><a href="#Getting_case_variables_from_the_master_process_case">Getting case variables from the master process case</a></li>
<li class="toc"><a href="#Accessing_all_fellow_Subprocess_Cases">Accessing all fellow Subprocess Cases</a></li>
<li class="toc"><a href="#Accessing_all_Associated_Cases">Accessing all Associated Cases</a></li>
<li class="toc"><a href="#Mailing_all_Participants_in_Master_And_Subprocess_Cases">Mailing all Participants in Master And Subprocess Cases</a></li>
<li class="toc"><a href="#Routing_Subprocess_Cases_after_a_Specified_Time">Routing Subprocess Cases after a Specified Time</a></li>
<li class="toc"><a href="#Routing_Subprocess_Cases_from_the_Master_Case">Routing Subprocess Cases from the Master Case</a></li>
<li class="toc"><a href="#Linking_to_Documents_from_the_Master_Case">Linking to Documents from the Master Case</a></li>
<li class="toc"><a href="#Linking_to_Documents_from_Subprocess_Case.28s.29">Linking to Documents from Subprocess Case(s)</a></li>
</ol>
</div></div>

<h2><span id="Overview">Overview</span></h2>

<p>Sub-Processes allow child processes to be inserted into master processes. It is recommended to break large processes into separate master processes and child processes, because it reduces the complexity of the process map and allows sub-processes to handle exceptional situations and ancillary activities. Sub-Processes are also useful for hooking the functionality of an existing process into another process.</p><p>Master processes and sub-processes are created separately as normal processes, but a sub-process task is added to the master process which calls the sub-process. Cases are started normally in the master process, but when a case reaches the task which links to the sub-process, a new case is created to execute the sub-process. Variables can be passed from the master process's case to the sub-process's case, so the sub-process can work with the data from the master process.</p><h2><span id="Types_of_Sub-Processes">Types of Sub-Processes</span></h2><p>A sub-process can be either <strong>synchronous</strong> or <strong>asynchronous</strong>. If the sub-process is <strong>synchronous</strong>, then the execution of the master process's case will pause and wait for the sub-process's case to complete, before continuing its execution. When an synchronous sub-process finishes, variables can be passed from the sub-process's case back to the master process's case.</p><p>If the sub-process is <strong>asynchronous</strong>, then the execution of the master process does NOT pause and wait for the sub-process case. Instead, the master process immediately continues with its subsequent tasks. Both the master process's case and the sub-process's case continue executing in their own separate time. Because the master process does not wait for the sub-process, variables are NOT passed back to the master process, when an asynchronous sub-process finishes.</p><h2><span id="Adding_a_Sub-Process_to_a_Master_Process">Adding a Sub-Process to a Master Process</span></h2><p>First, create the master process and sub-process separately as normal processes. Then, open the process that will be the master process. <i>Right click</i> on its process map and select the <strong>Add Sub-Process</strong> option from the dropdown menu.</p><p><img alt="" src="../sites/default/files/AddSubProcessFromMenu.png" height="255" width="437"></p><p>After creating the sub-process task, then connect it to a task in the master process with a routing rule. Any type of routing rule can be used to connect the prior task in the master process to the sub-process task.</p><p><img alt="" src="../sites/default/files/ConnectSubProcessWithRoutingRule.png" height="253" width="375"></p><p>Then, connect the sub-process task back to the master process with another routing rule.</p><p><img alt="" src="../sites/default/files/ConnectSubProcessBackToMaster.png" height="255" width="376"></p><p>It is also possible to end the master process on a sub-process task by assigning an <a href="2.0/Routing_Rules.html#End_of_Process_Routing_Rule" title="Routing_Rules">End of Process</a> routing rule to the task.</p><p><img alt="" src="../sites/default/files/EndSubProcess.png" height="183" width="374"></p><h3><span id="Defining_the_Sub-process_Properties">Defining the Sub-process Properties</span></h3><p>After connecting the sub-process with routing rules, then define the properties for the sub-process. <i>Right click</i> on the sub-process task and select the <strong>Properties</strong> option from the dropdown menu.</p><p><img alt="" src="../sites/default/files/SubProcessPropertiesMenu.png" height="256" width="446"></p><p>In the "Properties" dialog box that appears, define the properties of the new sub-process:</p><p><img alt="" src="../sites/default/files/Subprocess3.png" height="357" width="702"></p><p>Fill in the following information:</p><ul><li><strong>SubProcess name:</strong> Enter a name to identify the sub-process.</li><li><strong>Process:</strong> Select the existing process that should be used as a Sub-Process. Choose one process from the list of existing processes.</li><li><strong>Type:</strong> Select whether the sub-process will be <strong>Synchronous</strong> or <strong>Asynchronous</strong>. For more information, see <a href="#Types_of_Sub-Processes">Types of Sub-Processes</a>.</li></ul><h4><span id="Variables_Out_.28and_In.29">Variables Out (and In)</span></h4><p>Select which variables will be passed between the master process and the subprocess. The variables can have different names in the master process and subprocess, so each variable from the master process must be matched with a variable in the subprocess. If the subprocess is synchronous, then also define which the variables will be passed back from the sub-process to the master process.</p><p><strong>Variables Out</strong><br>Select which variables from the master process (<strong>Origin</strong>) will be passed to variables in the Sub-Process (<strong>Target</strong>). Either type in the variable name or click on the <strong>[@@]</strong> button to select a variable from the list of available variables in the process. Remember that variable names are case sensitive, so <strong><tt>@@MyVar</tt></strong> is different from <strong><tt>@@myvar</tt></strong>.</p><ul><li><strong>Origin:</strong> Enter the name of variable(s) from the master process to be passed to the sub-process.</li><li><strong>Target:</strong> Enter the name of variable(s) from the sub-process which will receive the data from the master process's variable(s).</li></ul>

<p style="margin-left:25px"><strong><font color="green">Note:</font></strong><font color="dimgray"> Any case variables defined in triggers, plus grid, checkgroup, file and listbox fields do not appear</a> in the list of available variables to be passed from the master process to the subprocess. Nonetheless, these variables may be passed by manually typing them into the <strong>Origin</strong> and <strong>Target</strong> fields. </font></p>

<p><strong>Variables In</strong><br>If the <strong>Type</strong> of sub-process is <strong>synchronous</strong>, a second section will appear to select which variables are passed back from the subprocess (<strong>Origin</strong>) to the master process (<strong>Target</strong>).</p><ul><li><strong>Origin:</strong> Enter the name of variable(s) from the sub-process to be passed to the master process.</li><li><strong>Target:</strong> Enter the name of variable(s) from the master process which will receive the data from the sub-process's variable(s).</li></ul><p>When done defining the sub-process's properties, click on <strong>Save</strong>. To cancel any changes, click on <strong>[X]</strong> in the upper right hand corner of the dialog box's title bar.</p><h3><span id="Removing_a_subprocess_from_the_starting_cases_list">Removing a subprocess from the starting cases list</span></h3>

<p style="margin-left:25px"><strong><font color="#009688">Available Version:</font></strong><font color="dimgray"> From 2.5 on.</font></p>

<div class="thumb tright"><div class="thumbinner" style="width: 400px;"><div class="thumbcaption"><div class="thumbcaption">Removing a subprocess from the starting cases list</div></div></div></div><p>When a case is about to start, it's difficult to distinguish the main process from the SubProcess or going back to the main list of process to check whether the name of the main process is. To avoid this, a new option was added, where it is possible decide which one will be the SubProcess.</p><p>On <strong>Designer</strong> tab choose the SubProcess from the list of process, double click over it or choose it and click on <strong>Edit</strong>. Then right click in the Process Map and choose the <strong>Edit Process</strong>option. Choose the option: <strong>This is a subprocess</strong>:</p><p><img alt="" src="../sites/default/files/SpecifyingSubProcess.png" height="439" width="701"></p><p>Once this is defined, the subprocess won't be displayed on the list of cases to be started.</p>

<p style="margin-left:25px"><strong><font color="green">Note:</font></strong><font color="dimgray"> This option does not work in the <a href="2.0/User_Experience.html" title="2.0/User Experience">user experience skin</a>.</font></p>

<h2><span id="Example">Example</span></h2><p>The Master Process shown in the image includes a Sub-Process.</p><p><img alt="" src="../sites/default/files/Subprocess4.png" height="391" width="256"></p><p>When a case arrives at the second task, Sub-process Junior, it begins a new case in the Sub-process.</p><p><img alt="" src="../sites/default/files/Subprocess5.png" height="477" width="425"></p><p>The Sub-Process properties are defined as follows:</p><p><img alt="" src="../sites/default/files/Subprocess3.png" height="357" width="702"></p><ul><li>The Sub-Process is called "Junior"</li><li>The Sub-Process is Asynchronous</li><li>Variables in the Master Process give the input for Variables in the Sub-Process</li></ul><h2><span id="Accessing_Objects_from_Master.2FSubprocess_Cases">Accessing Objects from Master/Subprocess Cases</span></h2><p>By default, the users working on subprocess cases will not have access to the DynaForms, Input Documents and Output Documents from the master case. Likewise, the users working on master cases, will not have access to the DynaForms and documents from the subprocess cases.</p><h3><span id="Read-only_Access_to_Objects_from_the_Master_Case">Read-only Access to Objects from the Master Case</span></h3><p>To allow the users working on subprocess cases to have access to the DynaForms, Input Documents and Output Documents from the master case, create <a href="2.0/Process_Permissions.html" title="Process Permissions">Process Permissions</a> in the master process which will give those users <i>read-only</i> access.</p><p><img alt="" src="../sites/default/files/GenericProcessPermissions.png" height="338" width="508"></p><p>When defining the Process Permissions, select "NO" for the <strong>Participation Required?</strong> option (unless the users also participated in the master case). However, this means that the users will have access to <i>all</i> master cases, not just the master case for their subprocess case. If this is not desirable, see the workaround for <a href="#Linking_to_Documents_from_the_Master_Case">Linking to Documents from the Master Case</a>.</p><p>Assigning Process Permissions will give the users of subprocess cases <i>read-only</i> access to the master cases, but normal users with the PROCESSMAKER_OPERATOR <a href="2.0/Roles.html" title="Roles">role</a> won't be able to see those master cases under the <strong>HOME</strong> menu (unless they also were designated to work on them). In order to see the master cases, assign a <a href="2.0/Roles.html" title="Roles">role</a> with the <strong><tt>PM_ALLCASES</tt></strong> permission to those users. Then, the users will be able to find the master cases by going to <strong>HOME &gt; Advanced Search</strong>. In order to easily find the Input and Output Documents from the master cases, assign a <a href="2.0/Roles.html" title="Roles">role</a> with the <strong><tt>PM_FOLDER_VIEW</tt></strong> permission to those users. When defining the Input and Output Documents for the master process, set directories (and subdirectories) for the <strong>Destination Path</strong> so that the files for the master cases can easily be found by the users by going to <strong>HOME &gt; Documents</strong> and clicking on the directory (and subdirectories).</p><p>In the users working on sub-process cases need to be able to <i>change</i> the data in DynaForms and <i>upload new</i> Input Document files in the master case, then assign those users to a <a href="2.0/Roles.html" title="Roles">role</a> which has the <strong><tt>PM_SUPERVISOR</tt></strong> permission and then assign them as <a href="Process_Supervisors.html" title="Process Supervisors">Process Supervisors</a> for the master process.</p><h3><span id="Read-only_Access_to_Objects_from_the_Subprocess_Case.28s.29">Read-only Access to Objects from the Subprocess Case(s)</span></h3><p>To allow the users working on the master case to have access to the DynaForms, Input Documents and Output Documents from the subprocess case(s), create <a href="2.0/Process_Permissions.html" title="Process Permissions">Process Permissions</a> in the master process which will give those users <i>read-only</i> access, as shown in the section above.</p><p>When defining the Process Permissions, select "NO" for the <strong>Participation Required?</strong> option (unless the users also participated in the subprocess case(s)). However, this means that the users will have access to <i>all</i> subprocess cases, not just the subprocess case(s) for their master case. If this is not desirable, see the workaround for <a href="#Linking_to_Documents_from_Subprocess_Case.28s.29">Linking to Documents from Subprocess Case(s)</a>.</p><h3><span id="Write_Access_To_Objects_from_the_Master_Case">Write Access To Objects from the Master Case</span></h3><h4><span id="DynaForms">DynaForms</span></h4><p>If inside a subprocess case and needing write access to DynaForms from the master case, then the best solution is to create a DynaForm with the same fields in the subprocess.</p><p>The XML code from the master process DynaForm can be copied into the the subprocess DynaForm. Remember to <strong>not</strong> copy the XML header which contains the <tt>name</tt> of the DynaForm, since two DynaForms can not have the same <tt>name</tt>:</p>
<div class="geshifilter"><div class="text geshifilter-text" style="font-family:monospace;">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br />
&lt;dynaForm type=&quot;xmlform&quot; name=&quot;4759685564f7da243c321f2021904585/3666076414f7da2ab1ca927068712748&quot; width=&quot;500&quot; enabletemplate=&quot;0&quot; mode=&quot;edit&quot;&gt;</div></div>
<p>When defining the subprocess task, select all the DynaForm fields to be passed from the master process to the subprocess. If the subprocess is asynchronous, so the DynaForm fields might be updated in the master process while the subprocess is running, then see <a href="#Setting_Variables_In_Subprocess_Cases">Setting Variables In Subprocess Cases</a>.</p>
<p>If the master case needs to be able to see the changes made to the DynaForm in the subprocess case, then there are two options:</p>
<ol><li>If a synchronous subprocess, pass the DynaForm field variables from the subprocess to the master process with <strong>Variables Out</strong> option when defining the subprocess task.</li><li>If an asynchronous subprocess, pass the Dynaform field variables from the subprocess to the master process with a trigger in the master process.</li></ol>
<h4><span id="Input_Documents">Input Documents</span></h4>
<p>If inside a subprocess case and needing write access to Input Documents from the master case, then create an Input Document in the subprocess which corresponds to the Input Document from the master case. Then, create a Trigger in the subprocess to transfer the Input Document files from the master case to the subprocess case. Set this Trigger to fire before the Input Document step in the subprocess case.</p>
<p>For example, if the Input Document in the master process has the unique ID "3978814374f637be5852e27080729640" and its corresponding Input Document in the subprocess has the unique ID "8018127764f637c28a5b724062237120", then the following trigger fired in the subprocess could transfer the Input Document files from the master case to the subprocess case:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$masterInpDocId</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;3978814374f637be5852e27080729640&quot;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//set to the UID of the master process' Input Document</span><br />
<span style="color: #000088;">$subInpDocId</span> &nbsp; &nbsp;<span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;8018127764f637c28a5b724062237120&quot;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//set to the UID of the subprocess' Input Document</span><br />
<span style="color: #666666; font-style: italic;">//Find the master process case UID:</span><br />
<span style="color: #000088;">$subcaseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span><br />
<span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT APP_PARENT FROM SUB_APPLICATION WHERE APP_UID='<span style="color: #006699; font-weight: bold;">$subcaseId</span>'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$masterCaseId</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$result</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_PARENT'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//Look up all the Input Document files from the master case</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$files</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT * FROM APP_DOCUMENT WHERE APP_UID='<span style="color: #006699; font-weight: bold;">$masterCaseId</span>' AND DOC_UID='<span style="color: #006699; font-weight: bold;">$masterInpDocId</span>'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$files</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$file</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$file</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_UID'</span><span style="color: #009900;">&#93;</span> &nbsp;<span style="color: #339933;">=</span> <span style="color: #000088;">$subcaseId</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$file</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'DOC_UID'</span><span style="color: #009900;">&#93;</span> &nbsp;<span style="color: #339933;">=</span> <span style="color: #000088;">$subInpDocId</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$appDocTags</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=</span> <a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$file</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_DOC_TAGS'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp;? <span style="color: #0000ff;">'NULL'</span> <span style="color: #339933;">:</span> <span style="color: #0000ff;">&quot;'<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_TAGS']}</span>'&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$appDocStatusDate</span> <span style="color: #339933;">=</span> <a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$file</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_DOC_STATUS_DATE'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span> ? <span style="color: #0000ff;">'NULL'</span> <span style="color: #339933;">:</span> <span style="color: #0000ff;">&quot;'<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_STATUS_DATE']}</span>'&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$query</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;INSERT INTO APP_DOCUMENT (<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;APP_DOC_UID, DOC_VERSION, APP_UID, DEL_INDEX, DOC_UID, USR_UID, APP_DOC_TYPE, APP_DOC_CREATE_DATE, <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;APP_DOC_INDEX, FOLDER_UID, APP_DOC_PLUGIN, APP_DOC_TAGS, APP_DOC_STATUS, APP_DOC_STATUS_DATE<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;) VALUES (<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_UID']}</span>', <span style="color: #006699; font-weight: bold;">{$file['DOC_VERSION']}</span>, '<span style="color: #006699; font-weight: bold;">{$file['APP_UID']}</span>', <span style="color: #006699; font-weight: bold;">{$file['DEL_INDEX']}</span>, '<span style="color: #006699; font-weight: bold;">{$file['DOC_UID']}</span>', <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'<span style="color: #006699; font-weight: bold;">{$file['USR_UID']}</span>', '<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_TYPE']}</span>', '<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_CREATE_DATE']}</span>', <span style="color: #006699; font-weight: bold;">{$file['APP_DOC_INDEX']}</span>, <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'<span style="color: #006699; font-weight: bold;">{$file['FOLDER_UID']}</span>', '<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_PLUGIN']}</span>', <span style="color: #006699; font-weight: bold;">$appDocTags</span>, '<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_STATUS']}</span>', <span style="color: #006699; font-weight: bold;">$appDocStatusDate</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;)&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$query</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<p>If the Input Document files need to be passed back from the subprocess case to the master case, the following trigger can be used to transfer the files. Set this Trigger to fire in the master case:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$masterInpDocId</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;3978814374f637be5852e27080729640&quot;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//set to the UID of the master process' Input Document</span><br />
<span style="color: #000088;">$subInpDocId</span> &nbsp; &nbsp;<span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;8018127764f637c28a5b724062237120&quot;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//set to the UID of the subprocess' Input Document</span><br />
<span style="color: #666666; font-style: italic;">//Find the subprocess case UID:</span><br />
<span style="color: #000088;">$masterCaseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span> <br />
<span style="color: #000088;">$subcases</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT APP_UID FROM SUB_APPLICATION WHERE APP_PARENT='<span style="color: #006699; font-weight: bold;">$masterCaseId</span>'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$subcases</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$subcases</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> &nbsp;<br />
&nbsp; &nbsp;<span style="color: #000088;">$subcaseId</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$subcases</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//assuming that only one subprocess case</span><br />
&nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//Delete the master case Input Document files and replace them with the subprocess case files</span><br />
&nbsp; &nbsp;executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;DELETE * FROM APP_DOCUMENT WHERE APP_UID='<span style="color: #006699; font-weight: bold;">$masterCaseId</span>' AND DOC_UID='<span style="color: #006699; font-weight: bold;">$masterInpDocId</span>'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//Look up the Input Document files from the subprocess case</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$files</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT * FROM APP_DOCUMENT WHERE APP_UID='<span style="color: #006699; font-weight: bold;">$subcaseId</span>' AND DOC_UID='<span style="color: #006699; font-weight: bold;">$subInpDocId</span>'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$files</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$file</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$file</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_UID'</span><span style="color: #009900;">&#93;</span> &nbsp;<span style="color: #339933;">=</span> <span style="color: #000088;">$masterCaseId</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$file</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'DOC_UID'</span><span style="color: #009900;">&#93;</span> &nbsp;<span style="color: #339933;">=</span> <span style="color: #000088;">$masterInpDocId</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$appDocTags</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=</span> <a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$file</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_DOC_TAGS'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp;? <span style="color: #0000ff;">'NULL'</span> <span style="color: #339933;">:</span> <span style="color: #0000ff;">&quot;'<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_TAGS']}</span>'&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$appDocStatusDate</span> <span style="color: #339933;">=</span> <a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$file</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_DOC_STATUS_DATE'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span> ? <span style="color: #0000ff;">'NULL'</span> <span style="color: #339933;">:</span> <span style="color: #0000ff;">&quot;'<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_STATUS_DATE']}</span>'&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$query</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;INSERT INTO APP_DOCUMENT (<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;APP_DOC_UID, DOC_VERSION, APP_UID, DEL_INDEX, DOC_UID, USR_UID, APP_DOC_TYPE, APP_DOC_CREATE_DATE, <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;APP_DOC_INDEX, FOLDER_UID, APP_DOC_PLUGIN, APP_DOC_TAGS, APP_DOC_STATUS, APP_DOC_STATUS_DATE<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;) VALUES (<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_UID']}</span>', <span style="color: #006699; font-weight: bold;">{$file['DOC_VERSION']}</span>, '<span style="color: #006699; font-weight: bold;">{$file['APP_UID']}</span>', <span style="color: #006699; font-weight: bold;">{$file['DEL_INDEX']}</span>, '<span style="color: #006699; font-weight: bold;">{$file['DOC_UID']}</span>', <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'<span style="color: #006699; font-weight: bold;">{$file['USR_UID']}</span>', '<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_TYPE']}</span>', '<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_CREATE_DATE']}</span>', <span style="color: #006699; font-weight: bold;">{$file['APP_DOC_INDEX']}</span>, <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'<span style="color: #006699; font-weight: bold;">{$file['FOLDER_UID']}</span>', '<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_PLUGIN']}</span>', <span style="color: #006699; font-weight: bold;">$appDocTags</span>, '<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_STATUS']}</span>', <span style="color: #006699; font-weight: bold;">$appDocStatusDate</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;)&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$query</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<h4><span id="Output_Documents">Output Documents</span></h4>
<p>If inside a subprocess case and needing write access to Output Documents from the master case, then create an Output Document in the subprocess which corresponds to the Output Document from the master case. Then, create a Trigger in the subprocess to transfer the Output Document files from the master case to the subprocess case. Set this Trigger to fire before the Output Document step in the subprocess case.</p>
<p>For example, if the Output Document in the master process has the unique ID "2167394654f60eb0694cce4042086437" and its corresponding Input Document in the subprocess has the unique ID "8867906164f75e1abc75422081548143", then the following trigger fired in the subprocess could transfer the Input Document files from the master case to the subprocess case:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$masterInpDocId</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;2167394654f60eb0694cce4042086437&quot;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//set to the UID of the master process' Output Document</span><br />
<span style="color: #000088;">$subInpDocId</span> &nbsp; &nbsp;<span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;8867906164f75e1abc75422081548143&quot;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//set to the UID of the subprocess' Output Document</span><br />
<span style="color: #666666; font-style: italic;">//Find the master process case UID:</span><br />
<span style="color: #000088;">$subcaseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span><br />
<span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT APP_PARENT FROM SUB_APPLICATION WHERE APP_UID='<span style="color: #006699; font-weight: bold;">$subcaseId</span>'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$masterCaseId</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$result</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_PARENT'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//Look up all the Input Document files from the master case</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$files</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT * FROM APP_DOCUMENT WHERE APP_UID='<span style="color: #006699; font-weight: bold;">$masterCaseId</span>' AND DOC_UID='<span style="color: #006699; font-weight: bold;">$masterInpDocId</span>'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$files</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$file</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$file</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_UID'</span><span style="color: #009900;">&#93;</span> &nbsp;<span style="color: #339933;">=</span> <span style="color: #000088;">$subcaseId</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$file</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'DOC_UID'</span><span style="color: #009900;">&#93;</span> &nbsp;<span style="color: #339933;">=</span> <span style="color: #000088;">$subInpDocId</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$appDocTags</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=</span> <a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$file</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_DOC_TAGS'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp;? <span style="color: #0000ff;">'NULL'</span> <span style="color: #339933;">:</span> <span style="color: #0000ff;">&quot;'<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_TAGS']}</span>'&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$appDocStatusDate</span> <span style="color: #339933;">=</span> <a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$file</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_DOC_STATUS_DATE'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span> ? <span style="color: #0000ff;">'NULL'</span> <span style="color: #339933;">:</span> <span style="color: #0000ff;">&quot;'<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_STATUS_DATE']}</span>'&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$query</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;INSERT INTO APP_DOCUMENT (<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;APP_DOC_UID, DOC_VERSION, APP_UID, DEL_INDEX, DOC_UID, USR_UID, APP_DOC_TYPE, APP_DOC_CREATE_DATE, <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;APP_DOC_INDEX, FOLDER_UID, APP_DOC_PLUGIN, APP_DOC_TAGS, APP_DOC_STATUS, APP_DOC_STATUS_DATE<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;) VALUES (<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_UID']}</span>', <span style="color: #006699; font-weight: bold;">{$file['DOC_VERSION']}</span>, '<span style="color: #006699; font-weight: bold;">{$file['APP_UID']}</span>', <span style="color: #006699; font-weight: bold;">{$file['DEL_INDEX']}</span>, '<span style="color: #006699; font-weight: bold;">{$file['DOC_UID']}</span>', <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'<span style="color: #006699; font-weight: bold;">{$file['USR_UID']}</span>', '<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_TYPE']}</span>', '<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_CREATE_DATE']}</span>', <span style="color: #006699; font-weight: bold;">{$file['APP_DOC_INDEX']}</span>, <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'<span style="color: #006699; font-weight: bold;">{$file['FOLDER_UID']}</span>', '<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_PLUGIN']}</span>', <span style="color: #006699; font-weight: bold;">$appDocTags</span>, '<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_STATUS']}</span>', <span style="color: #006699; font-weight: bold;">$appDocStatusDate</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;)&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$query</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<p>If the Output Document files need to be passed back from the subprocess case to the master case, the following trigger can be used to transfer the files. Set this Trigger to fire in the master case:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$masterInpDocId</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;2167394654f60eb0694cce4042086437&quot;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//set to the UID of the master process' Output Document</span><br />
<span style="color: #000088;">$subInpDocId</span> &nbsp; &nbsp;<span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;8867906164f75e1abc75422081548143&quot;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//set to the UID of the subprocess' Output Document</span><br />
<span style="color: #666666; font-style: italic;">//Find the subprocess case UID:</span><br />
<span style="color: #000088;">$masterCaseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span> <br />
<span style="color: #000088;">$subcases</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT APP_UID FROM SUB_APPLICATION WHERE APP_PARENT='<span style="color: #006699; font-weight: bold;">$masterCaseId</span>'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$subcases</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$subcases</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> &nbsp;<br />
&nbsp; &nbsp;<span style="color: #000088;">$subcaseId</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$subcases</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//assuming that only one subprocess case</span><br />
&nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//Delete the master case Input Document files and replace them with the subprocess case files</span><br />
&nbsp; &nbsp;executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;DELETE * FROM APP_DOCUMENT WHERE APP_UID='<span style="color: #006699; font-weight: bold;">$masterCaseId</span>' AND DOC_UID='<span style="color: #006699; font-weight: bold;">$masterInpDocId</span>'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//Look up the Input Document files from the subprocess case</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$files</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT * FROM APP_DOCUMENT WHERE APP_UID='<span style="color: #006699; font-weight: bold;">$subcaseId</span>' AND DOC_UID='<span style="color: #006699; font-weight: bold;">$subInpDocId</span>'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$files</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$file</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$file</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_UID'</span><span style="color: #009900;">&#93;</span> &nbsp;<span style="color: #339933;">=</span> <span style="color: #000088;">$masterCaseId</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$file</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'DOC_UID'</span><span style="color: #009900;">&#93;</span> &nbsp;<span style="color: #339933;">=</span> <span style="color: #000088;">$masterInpDocId</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$appDocTags</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=</span> <a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$file</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_DOC_TAGS'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp;? <span style="color: #0000ff;">'NULL'</span> <span style="color: #339933;">:</span> <span style="color: #0000ff;">&quot;'<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_TAGS']}</span>'&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$appDocStatusDate</span> <span style="color: #339933;">=</span> <a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$file</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_DOC_STATUS_DATE'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span> ? <span style="color: #0000ff;">'NULL'</span> <span style="color: #339933;">:</span> <span style="color: #0000ff;">&quot;'<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_STATUS_DATE']}</span>'&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$query</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;INSERT INTO APP_DOCUMENT (<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;APP_DOC_UID, DOC_VERSION, APP_UID, DEL_INDEX, DOC_UID, USR_UID, APP_DOC_TYPE, APP_DOC_CREATE_DATE, <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;APP_DOC_INDEX, FOLDER_UID, APP_DOC_PLUGIN, APP_DOC_TAGS, APP_DOC_STATUS, APP_DOC_STATUS_DATE<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;) VALUES (<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_UID']}</span>', <span style="color: #006699; font-weight: bold;">{$file['DOC_VERSION']}</span>, '<span style="color: #006699; font-weight: bold;">{$file['APP_UID']}</span>', <span style="color: #006699; font-weight: bold;">{$file['DEL_INDEX']}</span>, '<span style="color: #006699; font-weight: bold;">{$file['DOC_UID']}</span>', <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'<span style="color: #006699; font-weight: bold;">{$file['USR_UID']}</span>', '<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_TYPE']}</span>', '<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_CREATE_DATE']}</span>', <span style="color: #006699; font-weight: bold;">{$file['APP_DOC_INDEX']}</span>, <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'<span style="color: #006699; font-weight: bold;">{$file['FOLDER_UID']}</span>', '<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_PLUGIN']}</span>', <span style="color: #006699; font-weight: bold;">$appDocTags</span>, '<span style="color: #006699; font-weight: bold;">{$file['APP_DOC_STATUS']}</span>', <span style="color: #006699; font-weight: bold;">$appDocStatusDate</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;)&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$query</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<h2><span id="Accessing_Subprocesses_in_Triggers">Accessing Subprocesses in Triggers</span></h2>
<p>When a subprocess case is created, it is created like a normal case with a record in the <strong><tt>wf_<font color=blue><i>WORKSPACE</i></font>.APPLICATION</tt></strong> table with a separate case unique ID and case number which is different from the master case. In addition, a new record is added to the <strong><tt>wf_<font color=blue><i>WORKSPACE</i></font>.SUB_APPLICATION</tt></strong> table, whose <strong><tt>APP_PARENT</tt></strong> field is set to the case UID for the parent case. Just like a normal case, as each task is executed in the subprocess case, a new record is added to the <strong><tt>wf_<font color=blue><i>WORKSPACE</i></font>.APP_DELEGATION</tt></strong> table. <strong><tt>wf_<font color=blue><i>WORKSPACE</i></font>.APP_DELEGATION</tt></strong> table needs to be queried to find out who are is currently assigned user to the subprocess case. <a href="ProcessMaker_Functions.html#executeQuery.28.29" title="ProcessMaker Functions">executeQuery()</a> function can be used inside a <a href="2.0/Triggers.html" title="2.0/Triggers">Trigger</a> to query these tables to look up the master process case and subprocess cases.</p>
<h3><span id="Accessing_Subprocess_Cases">Accessing Subprocess Cases</span></h3>
<p>If running a case in the master process, then all the subprocess cases can be found with the following query in a trigger:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$caseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//get the master case UID</span><br />
<span style="color: #000088;">$subcases</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT APP_UID FROM SUB_APPLICATION WHERE APP_PARENT='<span style="color: #006699; font-weight: bold;">$caseId</span>'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$subcases</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$subcases</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> &nbsp;<br />
&nbsp; &nbsp;<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$subcases</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$subcase</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//do something with the child cases</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<h3><span id="Setting_Variables_In_Subprocess_Cases">Setting Variables In Subprocess Cases</span></h3>
<p>In the following example, the subprocess cases are asynchronous to the master process so the master process case is still being worked on and its data is being changes as the subprocess cases are running. To make sure that the subprocess cases are kept apprised of the master case's data as it changes, a trigger is fired in the master process case to create a new case variable named "masterCaseVars" in all the subprocess cases. "masterCaseVars" is an associative array of all the case variables from the master case, which all the subprocess cases can then access:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$caseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//get the master case UID</span><br />
<span style="color: #000088;">$masterC</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> Cases<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$aInfo</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$masterC</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">loadCase</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$caseId</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$masterCaseVars</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$aInfo</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_DATA'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$subcases</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT APP_UID FROM SUB_APPLICATION WHERE APP_PARENT='<span style="color: #006699; font-weight: bold;">$caseId</span>'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$subcases</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$subcases</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> &nbsp;<br />
&nbsp; &nbsp;<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$subcases</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$subcase</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$subcaseId</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$subcase</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$subC</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> Cases<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$aCaseInfo</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$subC</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">loadCase</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$subcaseId</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> &nbsp; <br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$subCaseAppData</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$aCaseInfo</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_DATA'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//get case variables from subprocess case</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$subCaseAppData</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'masterCaseVars'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$masterCaseVars</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//add @@masterCaseVars case variable</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$subCaseAppData</span> <span style="color: #339933;">=</span> <a href="http://php.net/serialize"><span style="color: #990000;">serialize</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$subCaseAppData</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//store in serialized form for insert into DB</span><br />
&nbsp; &nbsp; &nbsp; executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;UPDATE APPLICATION SET APP_DATA='<span style="color: #006699; font-weight: bold;">$subCaseAppData</span>' WHERE APP_UID = '<span style="color: #006699; font-weight: bold;">$subcaseId</span>'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp;<br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<p>Now the case variables from the master case can be accessed inside the subprocess cases through triggers. For example, to display the @#runningTotal and @=expensesGrid variables from the master case in a DynaForm in the subprocess case, fire the following trigger <i>before</i> the DynaForm:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/isset"><span style="color: #990000;">isset</span></a><span style="color: #009900;">&#40;</span><span style="color: #339933;">@=</span>masterCaseVars<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #666666; font-style: italic;">//check whether the variable has been set</span><br />
&nbsp; <span style="color: #339933;">@@</span>runningTotal <span style="color: #339933;">=</span> <span style="color: #339933;">@=</span>masterCaseVars<span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'runningTotal'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; <span style="color: #339933;">@=</span>expenseGrid <span style="color: #339933;">=</span> <span style="color: #339933;">@=</span>masterCaseVars<span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'expenseGrid'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<p>If the subsequent DynaForm has a currency box named "runningTotal" and a grid named "expenseGrid", then it will display that data from the master case.</p>
<h3><span id="Mailing_currently_Designated_Users_for_Subprocess_Cases">Mailing currently Designated Users for Subprocess Cases</span></h3>
<p>The following trigger looks up all the currently designated users to work on the subprocess cases and sends them an email message from the boss:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$caseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//UID for master case</span><br />
<span style="color: #000088;">$users</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT AD.USR_UID FROM APP_DELEGATION AD, SUB_APPLICATION SA <br />
&nbsp; &nbsp;WHERE SA.APP_PARENT='<span style="color: #006699; font-weight: bold;">$caseId</span>' AND SA.APP_UID=AD.APP_UID AND AD.DEL_THREAD_STATUS='OPEN'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$emailTo</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//empty string to hold the emails of the participants in case &nbsp;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$user</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$aUser</span> <span style="color: #339933;">=</span> userInfo<span style="color: #009900;">&#40;</span><span style="color: #000088;">$user</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000088;">$emailTo</span> <span style="color: #339933;">.=</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$emailTo</span><span style="color: #009900;">&#41;</span> ? <span style="color: #0000ff;">&quot;&quot;</span> <span style="color: #339933;">:</span> <span style="color: #0000ff;">&quot;, &quot;</span> <span style="color: #009900;">&#41;</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'boss@example.com'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$emailTo</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <br />
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">&quot;Update on Case Progress&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'caseStatus.html'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<p>The same trigger could be used to email all users who have participated in the subprocess cases (not just the currently designated users). Just remove <code>"AND D.DEL_THREAD_STATUS = 'OPEN'"</code> from the SQL query.</p>
<h3><span id="Mailing_links_to_Master_and_Subprocess_Cases">Mailing links to Master and Subprocess Cases</span></h3>
<p>To mail links to open a master case and its subprocess cases, first look up the unique ID and delegation index for the master case and its subprocess cases in the <strong><tt>wf_<font color=blue><i>WORKSPACE</i></font>.APP_DELEGATION</tt></strong> table. Then insert that information into an email template which has the web addresses to open the cases.</p>
<p>In this example, an email is sent to each of the currently designated users for the subprocess cases, with links to the master case and the subprocess case which that user is assigned to.</p>
<p>First create an email template named "openCaseLetter.html" in the <strong>mailTemplates</strong> directory with the <a href="Process_Files_Manager.html" title="Process Files Manager">Process Files Manager</a>:</p>
<div class="geshifilter"><div class="text geshifilter-text" style="font-family:monospace;">You have been assigned to work on subprocess case @#subcaseNo :<br />
&nbsp; http://example.com/sysworkflow/en/classic/cases/cases_Open?APP_UID=@#subcaseId&amp;DEL_INDEX=@#subcaseIndex<br />
<br />
To open the master case @#masterCaseNo, click on the following link:<br />
&nbsp; http://example.com/sysworkflow/en/classic/cases/cases_Open?APP_UID=@#masterCaseId&amp;DEL_INDEX=@#masterCaseIndex</div></div>
<p>Then, create the following trigger which will be fired in the master process. The email will be sent from the currently logged in user working on the master case to each of the currently assigned users working on the subprocess cases.</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$oMasterCase</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> Cases<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$masterCaseInfo</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$oMasterCase</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">loadCase</span><span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #339933;">@%</span>INDEX<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$masterCaseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//get the master case UID</span><br />
<span style="color: #000088;">$subcases</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT AD.APP_UID, AD.DEL_INDEX, AD.USR_UID <br />
&nbsp; &nbsp;FROM SUB_APPLICATION SA, APP_DELEGATION AD WHERE SA.APP_PARENT='<span style="color: #006699; font-weight: bold;">$masterCaseId</span>' <br />
&nbsp; &nbsp;AND SA.APP_UID=AD.APP_UID AND AD.DEL_THREAD_STATUS='OPEN'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$subcases</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$subcases</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> &nbsp;<br />
&nbsp; &nbsp;<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$subcases</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$subcase</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> &nbsp; <br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$emailFrom</span> <span style="color: #339933;">=</span> userInfo<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>USER_LOGGED<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$emailTo</span> <span style="color: #339933;">=</span> userInfo<span style="color: #009900;">&#40;</span><span style="color: #000088;">$subcase</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_UID'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$oSubcase</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> Cases<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$subcaseInfo</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$oSubcase</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">loadCase</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$subcase</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$aVariables</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'subcaseNo'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$subcaseInfo</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_NUMBER'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'subcaseId'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$subcase</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> &nbsp;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'subcaseIndex'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$subcase</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'DEL_INDEX'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> &nbsp;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'masterCaseNo'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$masterCaseInfo</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_NUMBER'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'masterCaseId'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$masterCaseInfo</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> &nbsp;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'masterCaseIndex'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$masterCaseInfo</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'DEL_INDEX'</span><span style="color: #009900;">&#93;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp; &nbsp; &nbsp; PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #000088;">$emailFrom</span><span style="color: #339933;">,</span> <span style="color: #000088;">$emailTo</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'Open your subprocess case'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'openCaseLetter.html'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$aVariables</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<h3><span id="Displaying_a_List_of_Subprocess_Cases_in_a_Grid">Displaying a List of Subprocess Cases in a Grid</span></h3>
<p>To display a grid in a DynaForm with information about the progress of subprocess cases, the following trigger looks up information about the subprocess cases and constructs an associative array of associative arrays about those cases which can be displayed in a grid named "subcasesGrid" with the fields "caseNo", "status", "currentUser", "index", "createDate", "updateDate", "dueDate", "caseLink" and a hidden field named "caseURL" in a subsequent DynaForm.</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #339933;">@@</span>caseLink <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;x&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #339933;">@=</span>subcasesGrid <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//empty array to hold grid data</span><br />
<span style="color: #000088;">$caseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//UID for current master process case</span><br />
<span style="color: #339933;">@@</span>caseLink <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;xx&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$subcases</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT APP_UID FROM SUB_APPLICATION WHERE APP_PARENT = '<span style="color: #006699; font-weight: bold;">$caseId</span>'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #339933;">@@</span>caseLink <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;xxx&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$subcases</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$subcases</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> &nbsp; &nbsp; <br />
&nbsp; &nbsp;<span style="color: #b1b100;">for</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$i</span> <span style="color: #339933;">=</span> <span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <span style="color: #000088;">$tot</span> <span style="color: #339933;">=</span> <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$subcases</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #000088;">$i</span> <span style="color: #339933;">&lt;=</span> <span style="color: #000088;">$tot</span><span style="color: #339933;">;</span> <span style="color: #000088;">$i</span><span style="color: #339933;">++</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000088;">$subcase</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> Cases<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp;<br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000088;">$aSubCase</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$subcase</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">loadCase</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$subcases</span><span style="color: #009900;">&#91;</span><span style="color: #000088;">$i</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000088;">$aSubCase</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$subcase</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">loadCase</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aSubCase</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="color: #000088;">$aSubCase</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_DATA'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'INDEX'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp;<br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #339933;">@=</span>subcasesGrid<span style="color: #009900;">&#91;</span><span style="color: #000088;">$i</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'caseNo'</span> &nbsp; &nbsp; &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$aSubCase</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_NUMBER'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'status'</span> &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$aSubCase</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'STATUS'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'currentUser'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$aSubCase</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'CURRENT_USER'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'index'</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$aSubCase</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'DEL_INDEX'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'createDate'</span> &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$aSubCase</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'CREATE_DATE'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'updateDate'</span> &nbsp;<span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$aSubCase</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'UPDATE_DATE'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'dueDate'</span> &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$aSubCase</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'DEL_TASK_DUE_DATE'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">'caseURL'</span> &nbsp; &nbsp; <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'../cases/cases_Open?APP_UID='</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$aSubCase</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_UID'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">'&amp;DEL_INDEX='</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$aSubCase</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'DEL_INDEX'</span><span style="color: #009900;">&#93;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <br />
&nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<p>Then, add the following JavaScript code to the DynaForm, to set the links to the subprocess cases in the grid when the DynaForm loads:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">var</span> totalRows <span style="color: #339933;">=</span> Number_Rows_Grid<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;subcasesGrid&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;caseURL&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">for</span> <span style="color: #009900;">&#40;</span><span style="color: #000000; font-weight: bold;">var</span> i <span style="color: #339933;">=</span> <span style="color: #cc66cc;">1</span><span style="color: #339933;">;</span> i <span style="color: #339933;">&lt;=</span> totalRows<span style="color: #339933;">;</span> i<span style="color: #339933;">++</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;getGridField<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;subcasesGrid&quot;</span><span style="color: #339933;">,</span> i<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;caseLink&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">.</span>href <span style="color: #339933;">=</span> getGridField<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;subcasesGrid&quot;</span><span style="color: #339933;">,</span> i<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;caseURL&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">.</span>value<span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//set URL</span><br />
&nbsp; &nbsp;getGridField<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;subcasesGrid&quot;</span><span style="color: #339933;">,</span> i<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;caseLink&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">.</span>innerHTML <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;open&quot;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//set label</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<h3><span id="Displaying_a_List_of_Subprocess_Cases_in_a_Text_Report">Displaying a List of Subprocess Cases in a Text Report</span></h3>
<p>A similar trigger could be used to generate a text report that could be displayed in a textarea field in a subsequent DynaForm or written to an Output Document file or a text file in the process' "public" directory:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$caseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//UID for current master process case</span><br />
<span style="color: #000088;">$master</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> Cases<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$aMaster</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$master</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">LoadCase</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$caseId</span><span style="color: #339933;">,</span> <span style="color: #339933;">@%</span>INDEX<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$masterURL</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;http://<span style="color: #006699; font-weight: bold;">{$_SERVER['HTTP_HOST']}</span>/sys&quot;</span> <span style="color: #339933;">.</span> <span style="color: #339933;">@@</span>SYS_SYS <span style="color: #339933;">.</span> <span style="color: #0000ff;">'/'</span> <span style="color: #339933;">.</span> <span style="color: #339933;">@@</span>SYS_LANG <span style="color: #339933;">.</span> <span style="color: #0000ff;">'/'</span> <span style="color: #339933;">.</span> <span style="color: #339933;">@@</span>SYS_SKIN <span style="color: #339933;">.</span> <br />
&nbsp; &nbsp;<span style="color: #0000ff;">&quot;/cases/cases_Open?APP_UID=<span style="color: #006699; font-weight: bold;">{$aMaster['APP_UID']}</span>&amp;DEL_INDEX=<span style="color: #006699; font-weight: bold;">{$aMaster['DEL_INDEX']}</span>&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #339933;">@@</span>casesReport <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;Master Case:<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp;<span style="color: #0000ff;">&quot;Case No: <span style="color: #006699; font-weight: bold;">{$aMaster['APP_NUMBER']}</span> Status: <span style="color: #006699; font-weight: bold;">{$aMaster['STATUS']}</span> &quot;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp;<span style="color: #0000ff;">&quot;Cur. User: <span style="color: #006699; font-weight: bold;">{$aMaster['CURRENT_USER']}</span> Step No: <span style="color: #006699; font-weight: bold;">{$aMaster['DEL_INDEX']}</span> <span style="color: #000099; font-weight: bold;">\n</span>&quot;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp;<span style="color: #0000ff;">&quot;Started: <span style="color: #006699; font-weight: bold;">{$aMaster['CREATE_DATE']}</span> Updated: <span style="color: #006699; font-weight: bold;">{$aMaster['UPDATE_DATE']}</span> &quot;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp;<span style="color: #0000ff;">&quot;Due: <span style="color: #006699; font-weight: bold;">{$aMaster['DEL_TASK_DUE_DATE']}</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp;<span style="color: #0000ff;">&quot;Link: <span style="color: #006699; font-weight: bold;">$masterURL</span> <span style="color: #000099; font-weight: bold;">\n</span>&quot;</span> <span style="color: #339933;">.</span> <br />
&nbsp; &nbsp;<span style="color: #0000ff;">&quot;SubCases:<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$subCases</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT APP_UID FROM APPLICATION WHERE APP_PARENT = '<span style="color: #006699; font-weight: bold;">$caseId</span>'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$subCases</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$subCases</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> &nbsp; <br />
&nbsp; &nbsp;<span style="color: #b1b100;">foreach</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$subCases</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$subCase</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$subcase</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> Cases<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$aSubCase</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$subcase</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">loadCase</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$subCase</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$aSubCase</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$subcase</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">loadCase</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$subCase</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="color: #000088;">$aSubCase</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_DATA'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'INDEX'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$subcaseURL</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;http://<span style="color: #006699; font-weight: bold;">{$_SERVER['HTTP_HOST']}</span>/sys&quot;</span> <span style="color: #339933;">.</span> <span style="color: #339933;">@@</span>SYS_SYS <span style="color: #339933;">.</span> <span style="color: #0000ff;">'/'</span> <span style="color: #339933;">.</span> <span style="color: #339933;">@@</span>SYS_LANG <span style="color: #339933;">.</span> <span style="color: #0000ff;">'/'</span> <span style="color: #339933;">.</span> <span style="color: #339933;">@@</span>SYS_SKIN <span style="color: #339933;">.</span> <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">&quot;/cases/cases_Open?APP_UID=<span style="color: #006699; font-weight: bold;">{$aSubCase['APP_UID']}</span>&amp;DEL_INDEX=<span style="color: #006699; font-weight: bold;">{$aSubCase['DEL_INDEX']}</span>&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #339933;">@@</span>casesReport <span style="color: #339933;">.=</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">&quot;Case No: <span style="color: #006699; font-weight: bold;">{$aSubCase['APP_NUMBER']}</span> Status: <span style="color: #006699; font-weight: bold;">{$aSubCase['STATUS']}</span> &quot;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">&quot;Cur. User: <span style="color: #006699; font-weight: bold;">{$aSubCase['CURRENT_USER']}</span> Step No: <span style="color: #006699; font-weight: bold;">{$aSubCase['DEL_INDEX']}</span> <span style="color: #000099; font-weight: bold;">\n</span>&quot;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">&quot;Started: <span style="color: #006699; font-weight: bold;">{$aSubCase['CREATE_DATE']}</span> Updated: <span style="color: #006699; font-weight: bold;">{$aSubCase['UPDATE_DATE']}</span> &quot;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">&quot;Due: <span style="color: #006699; font-weight: bold;">{$aSubCase['DEL_TASK_DUE_DATE']}</span> <span style="color: #000099; font-weight: bold;">\n</span>&quot;</span> <span style="color: #339933;">.</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">&quot;Link: <span style="color: #006699; font-weight: bold;">$subcaseURL</span> <span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span><br />
<span style="color: #666666; font-style: italic;">//if needing to save to a file in the &quot;public&quot; directory:</span><br />
<a href="http://php.net/file_put_contents"><span style="color: #990000;">file_put_contents</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;/opt/processmaker/shared/sites/workflow/public/casesReport_<span style="color: #006699; font-weight: bold;">$caseId</span>.txt&quot;</span><span style="color: #339933;">,</span> <span style="color: #339933;">@@</span>casesReport<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
<p>Then, add a textarea named "casesReport" to a subsequent DynaForm or create an Output Document with the text:</p>
<dl><dd>
<span class="geshifilter"><code class="text geshifilter-text">@#casesReport</code></span>
</dd></dl>
<h3><span id="Accessing_the_Master_Process_Case">Accessing the Master Process Case</span></h3>
<p>To find the master process case when inside one of its subprocess cases, then the case UID for the master case can be looked up in the <strong><tt>wf_<font color=blue><i>WORKSPACE</i></font>.SUB_APPLICATION</tt></strong> table:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$subcaseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span><br />
<span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT APP_PARENT FROM SUB_APPLICATION WHERE APP_UID='<span style="color: #006699; font-weight: bold;">$subcaseId</span>'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$masterCaseId</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$result</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_PARENT'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//do something with the parent case using its unique ID</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<h3><span id="Getting_case_variables_from_the_master_process_case">Getting case variables from the master process case</span></h3>
<p>In the following example, the subprocess cases needs to display a currency box named "runningTotal" and grid named "expenseGrid" from the master process case. The following trigger is used to look up these variables from the master process case so they can be displayed in a subsequent DynaForm:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$subcaseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span><br />
<span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT APP_PARENT FROM SUB_APPLICATION WHERE APP_UID='<span style="color: #006699; font-weight: bold;">$subcaseId</span>'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$result</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$subcase</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> Cases<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$aSubCase</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$subcase</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">loadCase</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$subcaseId</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$masterCaseId</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$result</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_PARENT'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$masterCase</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> Cases<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$aMasterCase</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$masterCase</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">loadCase</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #339933;">@</span><span style="color: #666666; font-style: italic;">#runningTotal = $aMasterCase['APP_DATA']['runningTotal'];<br />
</span> &nbsp; <span style="color: #339933;">@=</span>expenseGrid <span style="color: #339933;">=</span> <span style="color: #000088;">$aMasterCase</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_DATA'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'expenseGrid'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<h3><span id="Accessing_all_fellow_Subprocess_Cases">Accessing all fellow Subprocess Cases</span></h3>
<p>To find all the fellow subprocess cases when firing a trigger inside a subprocess case:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$currentSubcaseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span><br />
<span style="color: #666666; font-style: italic;">//find all the subcases except for the current subcase</span><br />
<span style="color: #000088;">$query</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;SELECT APP_UID FROM SUB_APPLICATION WHERE <br />
&nbsp; &nbsp;APP_PARENT=(SELECT APP_PARENT FROM SUB_APPLICATION WHERE APP_UID='<span style="color: #006699; font-weight: bold;">$currentSubcaseId</span>')<br />
&nbsp; &nbsp;AND APP_UID&lt;&gt;'<span style="color: #006699; font-weight: bold;">$currentSubcaseId</span>'&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$subcases</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$query</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$subcases</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$subcases</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$subcases</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$subcase</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$subcaseId</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$subcase</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span> <br />
&nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//do something with the fellow child cases</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<h3><span id="Accessing_all_Associated_Cases">Accessing all Associated Cases</span></h3>
<p>To find the master process case and all subprocess cases associated with it in a single query, regardless of whether in the master process case or a subprocess case:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$currentCaseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span> <br />
<span style="color: #000088;">$cases</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT DISTINCT APP_UID FROM SUB_APPLICATION WHERE <br />
&nbsp; &nbsp;APP_UID = '<span style="color: #006699; font-weight: bold;">$currentCaseId</span>' OR APP_PARENT = '<span style="color: #006699; font-weight: bold;">$currentCaseId</span>'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$cases</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$cases</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$cases</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$case</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$caseId</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$case</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//do something with all the cases</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<h3><span id="Mailing_all_Participants_in_Master_And_Subprocess_Cases">Mailing all Participants in Master And Subprocess Cases</span></h3>
<p>For example, to send an email every user who has participated in the master process case or any of the subprocess cases:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$caseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//UID for current case</span><br />
<span style="color: #000088;">$query</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;SELECT DISTINCT USR_UID FROM APP_DELEGATION WHERE APP_UID = <br />
&nbsp; &nbsp;(SELECT APP_UID FROM SUB_APPLICATION WHERE APP_UID = '<span style="color: #006699; font-weight: bold;">$caseId</span>' OR APP_PARENT = '<span style="color: #006699; font-weight: bold;">$caseId</span>')&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$users</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #000088;">$query</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$emailTo</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//empty string to hold the emails of the participants in case</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$users</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$user</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$aUser</span> <span style="color: #339933;">=</span> userInfo<span style="color: #009900;">&#40;</span><span style="color: #000088;">$user</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000088;">$emailTo</span> <span style="color: #339933;">.=</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/empty"><span style="color: #990000;">empty</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$emailTo</span><span style="color: #009900;">&#41;</span> ? <span style="color: #0000ff;">&quot;&quot;</span> <span style="color: #339933;">:</span> <span style="color: #0000ff;">&quot;, &quot;</span> <span style="color: #009900;">&#41;</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$aUser</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'boss@example.com'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$emailTo</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <br />
&nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">&quot;Update on Case Progress&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'caseStatus.html'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<h3><span id="Routing_Subprocess_Cases_after_a_Specified_Time">Routing Subprocess Cases after a Specified Time</span></h3>
<p>If using synchronous subprocesses, the subprocess case can hold up the master process case. To prevent the subprocess case from stopping the master case for too long, define an <a href="2.0/Events.html" title="Events">Event</a> in the subprocess which will fire a trigger after a certain amount of time which will route on the subprocess case and set default values for its case variables.</p>
<p>In addition, it may be useful to create a prior <a href="2.0/Events.html#Configuring_a_Send_Message_Event" title="Events">Message Event</a> in the subprocess, which sends an email to the designated user(s) of the subprocess case(s), reminding them that they are holding up the master case.</p>
<p>For example, the following trigger could be created in the subprocess to automatically route on the subprocess case and finish it:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;">PMFDerivateCase<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #339933;">@%</span>INDEX<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
<p>Then, create an Event in the subprocess, which will fire this trigger after a specified amount of time. The trigger will only fire if the user has not completed the task within the specified time.</p>
<p>A similar trigger could be used to set some default values for the case variables in the subprocess case and inform the designated user that the case has been automatically routed on:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #666666; font-style: italic;">//set default values for case variables:</span><br />
<span style="color: #339933;">@@</span>caseVariable1 <span style="color: #339933;">=</span> <span style="color: #0000ff;">'value X'</span><span style="color: #339933;">;</span> &nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//a string</span><br />
<span style="color: #339933;">@</span><span style="color: #666666; font-style: italic;">#caseVariable2 = 23.56; &nbsp; &nbsp; &nbsp; &nbsp;//a floating point number<br />
</span><span style="color: #339933;">@%</span>caseVariable3 <span style="color: #339933;">=</span> <span style="color: #cc66cc;">15</span><span style="color: #339933;">;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//an integer</span><br />
<span style="color: #339933;">@@</span>caseVariable4 <span style="color: #339933;">=</span> <span style="color: #0000ff;">'2012-12-31'</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//a date in 'YYYY-MM-DD' format</span><br />
PMFDerivateCase<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #339933;">@%</span>INDEX<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #666666; font-style: italic;">//email currently designated user for subprocess:</span><br />
<span style="color: #000088;">$oCase</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> Cases<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$caseInfo</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$oCase</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">loadCase</span><span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #339933;">@%</span>INDEX<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$emailTo</span> <span style="color: #339933;">=</span> userInfo<span style="color: #009900;">&#40;</span><span style="color: #000088;">$caseInfo</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'CURRENT_USER_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'mail'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$caseNo</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$caseInfo</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_NUMBER'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
PMFSendMessage<span style="color: #009900;">&#40;</span><span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">,</span> <span style="color: #0000ff;">'boss@example.com'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$emailTo</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp;<span style="color: #0000ff;">&quot;Case #<span style="color: #006699; font-weight: bold;">$caseNo</span> automatically routed&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'caseRouted.html'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></div>
<h3><span id="Routing_Subprocess_Cases_from_the_Master_Case">Routing Subprocess Cases from the Master Case</span></h3>
<p>The <a href="ProcessMaker_Functions.html#PMFDerivateCase.28.29" title="ProcessMaker Functions">PMFDerivateCase()</a> function can only be called for cases for which the currently logged in user has rights to open. Therefore, the PMFDerivateCase() function can not be called in the master case to route on the subprocess cases (unless the same user is designated to work on both the master case and the subprocess cases). In order to route on the subprocess cases, the trigger will have to login as the designated user for the subprocess case with the <a href="Simple_Trigger_Web_Services.html#WSLogin" title="Simple Trigger Web Services">WSLogin()</a> or the <a href="ProcessMaker_WSDL_Web_Services.html#Logging_in_with_ProcessMaker.27s_WSDL_web_services" title="ProcessMaker WSDL Web Services">login()</a> web service, and then call <a href="Simple_Trigger_Web_Services.html#WSDerivateCase" title="Simple Trigger Web Services">WSDerivateCase()</a> or the <a href="ProcessMaker_WSDL_Web_Services.html#Route_.28derivate.29_a_case" title="ProcessMaker WSDL Web Services">routeCase()</a> web service as that user.</p>
<p>For example, the following trigger is created in the master process to automatically route on all the subprocess cases:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #666666; font-style: italic;">//look up all the subprocess cases for the current master case:</span><br />
<span style="color: #000088;">$masterCaseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//get the master case UID</span><br />
<span style="color: #000088;">$subcases</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT AD.APP_UID, AD.DEL_INDEX, AD.USR_UID <br />
&nbsp; &nbsp;FROM SUB_APPLICATION SA, APP_DELEGATION AD WHERE SA.APP_PARENT='<span style="color: #006699; font-weight: bold;">$masterCaseId</span>' <br />
&nbsp; &nbsp;AND SA.APP_UID=AD.APP_UID AND AD.DEL_THREAD_STATUS='OPEN'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$subcases</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$subcases</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> &nbsp;<br />
&nbsp; &nbsp;<span style="color: #b1b100;">foreach</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$subcases</span> <span style="color: #b1b100;">as</span> <span style="color: #000088;">$subcase</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$userId</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$subcase</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//Lookup the MD5 hash for the password of designated user of subprocess case</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$usrQuery</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT USR_USERNAME, USR_PASSWORD FROM USERS WHERE USR_UID='<span style="color: #006699; font-weight: bold;">$userId</span>'&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'rbac'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//login with web services as the designated user for the subprocess case</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$client</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> SoapClient<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'http://myserver.com/sysworkflow/en/classic/services/wsdl2'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$params</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'userid'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$usrQuery</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_USERNAME'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'password'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #0000ff;">'md5:'</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$usrQuery</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'USR_PASSWORD'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$loginResult</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$client</span><span style="color: #339933;">-&gt;</span>__SoapCall<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'login'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$params</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$loginResult</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">status_code</span> <span style="color: #339933;">==</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000088;">$sessionId</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$result</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">message</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">else</span> <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href="http://php.net/die"><span style="color: #990000;">die</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Unable to connect to ProcessMaker.<span style="color: #000099; font-weight: bold;">\n</span>Error Message: <span style="color: #006699; font-weight: bold;">$result-&gt;message</span>&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//route case:</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$params</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'sessionId'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$sessionId</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'caseId'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$subcase</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'APP_UID'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'delIndex'</span> <span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$subcase</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'DEL_INDEX'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$routeResult</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$client</span><span style="color: #339933;">-&gt;</span>__SoapCall<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'routeCase'</span><span style="color: #339933;">,</span> <span style="color: #000088;">$params</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$routeResult</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">status_code</span> <span style="color: #339933;">!=</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href="http://php.net/die"><span style="color: #990000;">die</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;Error routing case: <span style="color: #006699; font-weight: bold;">$result-&gt;message</span>&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<h3><span id="Linking_to_Documents_from_the_Master_Case">Linking to Documents from the Master Case</span></h3>
<p>A grid can be displayed in the subprocesss case for all the Input Documents, Output Documents and attached <a href="2.0/Files.html" title="DynaForm Fields">files</a> from the master case. This a good solution if the subprocess users do not have <a href="2.0/Roles.html" title="Roles">roles</a> with the <strong><tt>PM_ALLCASES</tt></strong> and <strong><tt>PM_FOLDER_VIEW</tt></strong> permissions, so they can't easily see lists of master cases and their documents.</p>
<p>Give the subprocess users <a href="2.0/Process_Permissions.html" title="Process Permissions">Process Permissions</a> in the master process to access the Input and Output Documents. Then, give them access to the master case's Input Documents and Output Documents by creating a grid in a suprocess DynaForm, which has direct links to open those objects. First, create a grid DynaForm with fields named "type", "createDate", "user", "link1" and "link2". Then, embed that grid in a master DynaForm and assign the master DynaForm as a step in one of the tasks in the subprocess. Also add a <a href="2.0/Other_DynaForm_Fields.html#Hidden" title="DynaForm Fields">hidden</a> field to the master DynaForm to hold the grid's serialized data, which will contain the URLs and labels for the links in the grid.</p>
<p>Then, create a trigger which is set to fire <i>before</i> the DynaForm to populate the grid with links to open the Input Documents, Output Documents and attached files. For example, if the grid embedded in the master DynaForm is named "masterObjectsGrid" and the hidden field is named "sGrid", the following trigger will populate it:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$subcaseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span><br />
<span style="color: #000088;">$grd</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #666666; font-style: italic;">//Look up all the documents from the master case</span><br />
<span style="color: #000088;">$query</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;SELECT DISTINCT DOC.APP_DOC_UID AS fileId, DOC.APP_DOC_CREATE_DATE AS createDate, <br />
&nbsp; &nbsp;DOC.APP_DOC_TYPE AS type, DOC.DOC_UID AS docDefId, C.CON_VALUE AS filename, <br />
&nbsp; &nbsp;CONCAT(U.USR_FIRSTNAME, ' ', U.USR_FIRSTNAME) AS user &nbsp;<br />
&nbsp; &nbsp;FROM SUB_APPLICATION SA, APP_DOCUMENT DOC, CONTENT C, USERS U <br />
&nbsp; &nbsp;WHERE SA.APP_UID='<span style="color: #006699; font-weight: bold;">$subcaseId</span>' AND SA.APP_PARENT=DOC.APP_UID AND DOC.APP_DOC_STATUS='ACTIVE' AND <br />
&nbsp; &nbsp;DOC.APP_DOC_UID=C.CON_ID AND C.CON_CATEGORY='APP_DOC_FILENAME' AND C.CON_VALUE&lt;&gt;'' AND DOC.USR_UID=U.USR_UID&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$docs</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$docs</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$docs</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$total</span> <span style="color: #339933;">=</span> <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$docs</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> &nbsp;<br />
&nbsp; &nbsp;<span style="color: #b1b100;">for</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$i</span> <span style="color: #339933;">=</span> <span style="color: #cc66cc;">1</span><span style="color: #339933;">;</span> <span style="color: #000088;">$i</span> <span style="color: #339933;">&lt;</span> <span style="color: #000088;">$total</span><span style="color: #339933;">;</span> <span style="color: #000088;">$i</span><span style="color: #339933;">++</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$type</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$docs</span><span style="color: #009900;">&#91;</span><span style="color: #000088;">$i</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'type'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$label1</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$label2</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$url1</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$url2</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$type</span> <span style="color: #339933;">==</span> <span style="color: #0000ff;">'OUTPUT'</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//if output document, then look up whether DOC, PDF or BOTH:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$executeQuery</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT OUT_DOC_GENERATE FROM OUTPUT_DOCUMENT WHERE OUT_DOC_UID='&quot;</span> <span style="color: #339933;">.</span> <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000088;">$docs</span><span style="color: #009900;">&#91;</span><span style="color: #000088;">$i</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'docDefId'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000088;">$docExt</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$result</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'OUT_DOC_GENERATE'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span> &nbsp;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$docExt</span> <span style="color: #339933;">!=</span> <span style="color: #0000ff;">'BOTH'</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000088;">$docExt</span> <span style="color: #339933;">=</span> <a href="http://php.net/strtolower"><span style="color: #990000;">strtolower</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$docExt</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000088;">$label1</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;{<span style="color: #006699; font-weight: bold;">$docs</span>[<span style="color: #006699; font-weight: bold;">$i</span>]['filename']}.<span style="color: #006699; font-weight: bold;">$docExt</span>&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000088;">$url1</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;../cases/cases_ShowOutputDocument?a={<span style="color: #006699; font-weight: bold;">$docs</span>[<span style="color: #006699; font-weight: bold;">$i</span>]['fileId']}&amp;ext=<span style="color: #006699; font-weight: bold;">$docExt</span>&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #b1b100;">else</span> <span style="color: #009900;">&#123;</span> &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//if both PDF and DOC</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000088;">$label1</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$docs</span><span style="color: #009900;">&#91;</span><span style="color: #000088;">$i</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'filename'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">'.pdf'</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000088;">$url1</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;../cases/cases_ShowOutputDocument?a={<span style="color: #006699; font-weight: bold;">$docs</span>[<span style="color: #006699; font-weight: bold;">$i</span>]['fileId']}&amp;ext=pdf&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000088;">$label2</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$docs</span><span style="color: #009900;">&#91;</span><span style="color: #000088;">$i</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'filename'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">'.doc'</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000088;">$url2</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;../cases/cases_ShowOutputDocument?a={<span style="color: #006699; font-weight: bold;">$docs</span>[<span style="color: #006699; font-weight: bold;">$i</span>]['fileId']}&amp;ext=doc&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">else</span> <span style="color: #009900;">&#123;</span> &nbsp;<span style="color: #666666; font-style: italic;">//if an input document or attached file</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000088;">$label1</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$docs</span><span style="color: #009900;">&#91;</span><span style="color: #000088;">$i</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'filename'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000088;">$url1</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'../cases/cases_ShowDocument?a='</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$docs</span><span style="color: #009900;">&#91;</span><span style="color: #000088;">$i</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'fileId'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span> &nbsp; &nbsp;<br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$grd</span><span style="color: #009900;">&#91;</span><span style="color: #000088;">$i</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'type'</span><span style="color: #339933;">=&gt;</span><span style="color: #000088;">$type</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'createDate'</span><span style="color: #339933;">=&gt;</span><span style="color: #000088;">$docs</span><span style="color: #009900;">&#91;</span><span style="color: #000088;">$i</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'createDate'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'user'</span><span style="color: #339933;">=&gt;</span><span style="color: #000088;">$docs</span><span style="color: #009900;">&#91;</span><span style="color: #000088;">$i</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'user'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'label1'</span><span style="color: #339933;">=&gt;</span><span style="color: #000088;">$label1</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'url1'</span><span style="color: #339933;">=&gt;</span><span style="color: #000088;">$url1</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'label2'</span><span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$label2</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'url2'</span><span style="color: #339933;">=&gt;</span><span style="color: #000088;">$url2</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; <br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span><br />
<span style="color: #339933;">@=</span>masterObjectsGrid <span style="color: #339933;">=</span> <span style="color: #000088;">$grd</span><span style="color: #339933;">;</span><br />
<span style="color: #339933;">@@</span>sGrid <span style="color: #339933;">=</span> <a href="http://php.net/json_encode"><span style="color: #990000;">json_encode</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$grd</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//serialized grid</span></div></div>
<p>Then, add the following JavaScript code to unserialize the grid in the form of a JSON string when the DynaForm loads and insert the URLs and labels in the links in the grid:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">var</span> gridDecoded <span style="color: #339933;">=</span> <a href="http://php.net/eval"><span style="color: #990000;">eval</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'('</span> <span style="color: #339933;">+</span> getField<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;sGrid&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">.</span>value <span style="color: #339933;">+</span> <span style="color: #0000ff;">')'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <br />
<span style="color: #b1b100;">for</span> <span style="color: #009900;">&#40;</span><span style="color: #000000; font-weight: bold;">var</span> rowNo in gridDecoded<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;getGridField<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'masterObjectsGrid'</span><span style="color: #339933;">,</span> rowNo<span style="color: #339933;">,</span> <span style="color: #0000ff;">'link1'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">.</span>innerHTML <span style="color: #339933;">=</span> gridDecoded<span style="color: #009900;">&#91;</span>rowNo<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'label1'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;getGridField<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'masterObjectsGrid'</span><span style="color: #339933;">,</span> rowNo<span style="color: #339933;">,</span> <span style="color: #0000ff;">'link1'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">.</span>href <span style="color: #339933;">=</span> gridDecoded<span style="color: #009900;">&#91;</span>rowNo<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'url1'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;getGridField<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'masterObjectsGrid'</span><span style="color: #339933;">,</span> rowNo<span style="color: #339933;">,</span> <span style="color: #0000ff;">'link1'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">.</span>target <span style="color: #339933;">=</span> <span style="color: #0000ff;">'_blank'</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//to open in separate page</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span>gridDecoded<span style="color: #009900;">&#91;</span>rowNo<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'label2'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">!=</span> <span style="color: #0000ff;">''</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; getGridField<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'masterObjectsGrid'</span><span style="color: #339933;">,</span> rowNo<span style="color: #339933;">,</span> <span style="color: #0000ff;">'link2'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">.</span>innerHTML <span style="color: #339933;">=</span> gridDecoded<span style="color: #009900;">&#91;</span>rowNo<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'label2'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; getGridField<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'masterObjectsGrid'</span><span style="color: #339933;">,</span> rowNo<span style="color: #339933;">,</span> <span style="color: #0000ff;">'link2'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">.</span>href <span style="color: #339933;">=</span> gridDecoded<span style="color: #009900;">&#91;</span>rowNo<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'url2'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; getGridField<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'masterObjectsGrid'</span><span style="color: #339933;">,</span> rowNo<span style="color: #339933;">,</span> <span style="color: #0000ff;">'link2'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">.</span>target <span style="color: #339933;">=</span> <span style="color: #0000ff;">'_blank'</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//to open in separate page</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">else</span><br />
&nbsp; &nbsp; &nbsp; hidden<span style="color: #009900;">&#40;</span>getGridField<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'masterObjectsGrid'</span><span style="color: #339933;">,</span> rowNo<span style="color: #339933;">,</span> <span style="color: #0000ff;">'link2'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div>
<h3><span id="Linking_to_Documents_from_Subprocess_Case.28s.29">Linking to Documents from Subprocess Case(s)</span></h3>
<p>A grid can be displayed in the master case to display the all the Input Documents, Output Documents and attached <a href="2.0/Files.html" title="DynaForm Fields">files</a> from its subprocess case(s). This a good solution if the the master case users do not have <a href="2.0/Roles.html" title="Roles">roles</a> with the <strong><tt>PM_ALLCASES</tt></strong> and <strong><tt>PM_FOLDER_VIEW</tt></strong> permissions, so they can't easily see lists of subprocess cases and their documents.</p>
<p>Give the master process users <a href="2.0/Process_Permissions.html" title="Process Permissions">Process Permissions</a> in the subprocess to access the Input and Output Documents. Then, give them access to the subprocess case's Input Documents and Output Documents by creating a grid in a suprocess DynaForm, which has direct links to open those objects. First, create a grid DynaForm with fields named "caseNo", "type", "createDate", "user", "link1" and "link2". Then, embed that grid in a master DynaForm and assign the master DynaForm as a step in one of the tasks in the subprocess. Also add a <a href="2.0/Other_DynaForm_Fields.html#Hidden" title="DynaForm Fields">hidden</a> field to the master DynaForm to hold the grid's serialized data, which will contain the URLs and labels for the links in the grid.</p>
<p>Then, create a trigger which is set to fire <i>before</i> the DynaForm to populate the grid with links to open the Input Documents, Output Documents and attached files. For example, if the grid embedded in the master DynaForm is named "masterObjectsGrid" and the hidden field is named "sGrid", the following trigger will populate it:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000088;">$masterCaseId</span> <span style="color: #339933;">=</span> <span style="color: #339933;">@@</span>APPLICATION<span style="color: #339933;">;</span><br />
<span style="color: #000088;">$grd</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #666666; font-style: italic;">//Look up all the documents from the master case</span><br />
<span style="color: #000088;">$query</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;SELECT DISTINCT DOC.APP_DOC_UID AS fileId, DOC.APP_DOC_CREATE_DATE AS createDate, <br />
&nbsp; &nbsp;DOC.APP_DOC_TYPE AS type, DOC.DOC_UID AS docDefId, C.CON_VALUE AS filename, <br />
&nbsp; &nbsp;CONCAT(U.USR_FIRSTNAME, ' ', U.USR_FIRSTNAME) AS user, A.APP_NUMBER AS caseNo &nbsp; <br />
&nbsp; &nbsp;FROM SUB_APPLICATION SA, APP_DOCUMENT DOC, CONTENT C, USERS U, APPLICATION A <br />
&nbsp; &nbsp;WHERE SA.APP_PARENT='<span style="color: #006699; font-weight: bold;">$masterCaseId</span>' AND SA.APP_UID=DOC.APP_UID AND DOC.APP_DOC_STATUS='ACTIVE' AND <br />
&nbsp; &nbsp;DOC.APP_DOC_UID=C.CON_ID AND C.CON_CATEGORY='APP_DOC_FILENAME' AND C.CON_VALUE&lt;&gt;'' AND <br />
&nbsp; &nbsp;DOC.USR_UID=U.USR_UID AND DOC.APP_UID=A.APP_UID&quot;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$docs</span> <span style="color: #339933;">=</span> executeQuery<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><a href="http://php.net/is_array"><span style="color: #990000;">is_array</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$docs</span><span style="color: #009900;">&#41;</span> and <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$docs</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&gt;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;<span style="color: #000088;">$total</span> <span style="color: #339933;">=</span> <a href="http://php.net/count"><span style="color: #990000;">count</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$docs</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> &nbsp;<br />
&nbsp; <span style="color: #b1b100;">for</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$i</span> <span style="color: #339933;">=</span> <span style="color: #cc66cc;">1</span><span style="color: #339933;">;</span> <span style="color: #000088;">$i</span> <span style="color: #339933;">&lt;=</span> <span style="color: #000088;">$total</span><span style="color: #339933;">;</span> <span style="color: #000088;">$i</span><span style="color: #339933;">++</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$type</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$docs</span><span style="color: #009900;">&#91;</span><span style="color: #000088;">$i</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'type'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$label1</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$label2</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$url1</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$url2</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">''</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$type</span> <span style="color: #339933;">==</span> <span style="color: #0000ff;">'OUTPUT'</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #666666; font-style: italic;">//if output document, then look up whether DOC, PDF or BOTH:</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000088;">$result</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$executeQuery</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SELECT OUT_DOC_GENERATE FROM OUTPUT_DOCUMENT WHERE OUT_DOC_UID='&quot;</span> <span style="color: #339933;">.</span> <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000088;">$docs</span><span style="color: #009900;">&#91;</span><span style="color: #000088;">$i</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'docDefId'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">&quot;'&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000088;">$docExt</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$result</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'OUT_DOC_GENERATE'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span> &nbsp;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$docExt</span> <span style="color: #339933;">!=</span> <span style="color: #0000ff;">'BOTH'</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000088;">$docExt</span> <span style="color: #339933;">=</span> <a href="http://php.net/strtolower"><span style="color: #990000;">strtolower</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$docExt</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000088;">$label1</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;{<span style="color: #006699; font-weight: bold;">$docs</span>[<span style="color: #006699; font-weight: bold;">$i</span>]['filename']}.<span style="color: #006699; font-weight: bold;">$docExt</span>&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000088;">$url1</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;../cases/cases_ShowOutputDocument?a={<span style="color: #006699; font-weight: bold;">$docs</span>[<span style="color: #006699; font-weight: bold;">$i</span>]['fileId']}&amp;ext=<span style="color: #006699; font-weight: bold;">$docExt</span>&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #b1b100;">else</span> <span style="color: #009900;">&#123;</span> &nbsp; &nbsp; <span style="color: #666666; font-style: italic;">//if both PDF and DOC</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000088;">$label1</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$docs</span><span style="color: #009900;">&#91;</span><span style="color: #000088;">$i</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'filename'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">'.pdf'</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000088;">$url1</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;../cases/cases_ShowOutputDocument?a={<span style="color: #006699; font-weight: bold;">$docs</span>[<span style="color: #006699; font-weight: bold;">$i</span>]['fileId']}&amp;ext=pdf&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000088;">$label2</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$docs</span><span style="color: #009900;">&#91;</span><span style="color: #000088;">$i</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'filename'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">'.doc'</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000088;">$url2</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;../cases/cases_ShowOutputDocument?a={<span style="color: #006699; font-weight: bold;">$docs</span>[<span style="color: #006699; font-weight: bold;">$i</span>]['fileId']}&amp;ext=doc&quot;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">else</span> <span style="color: #009900;">&#123;</span> &nbsp;<span style="color: #666666; font-style: italic;">//if an input document or attached file</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000088;">$label1</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$docs</span><span style="color: #009900;">&#91;</span><span style="color: #000088;">$i</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'filename'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000088;">$url1</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">'../cases/cases_ShowDocument?a='</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$docs</span><span style="color: #009900;">&#91;</span><span style="color: #000088;">$i</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'fileId'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; <span style="color: #009900;">&#125;</span> &nbsp; &nbsp;<br />
&nbsp; &nbsp; &nbsp; <span style="color: #000088;">$grd</span><span style="color: #009900;">&#91;</span><span style="color: #000088;">$i</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">=</span> <a href="http://php.net/array"><span style="color: #990000;">array</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'caseNo'</span><span style="color: #339933;">=&gt;</span><span style="color: #000088;">$docs</span><span style="color: #009900;">&#91;</span><span style="color: #000088;">$i</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'caseNo'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'type'</span><span style="color: #339933;">=&gt;</span><span style="color: #000088;">$type</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'createDate'</span><span style="color: #339933;">=&gt;</span><span style="color: #000088;">$docs</span><span style="color: #009900;">&#91;</span><span style="color: #000088;">$i</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'createDate'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'user'</span><span style="color: #339933;">=&gt;</span><span style="color: #000088;">$docs</span><span style="color: #009900;">&#91;</span><span style="color: #000088;">$i</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'user'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">'label1'</span><span style="color: #339933;">=&gt;</span><span style="color: #000088;">$label1</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'url1'</span><span style="color: #339933;">=&gt;</span><span style="color: #000088;">$url1</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'label2'</span><span style="color: #339933;">=&gt;</span> <span style="color: #000088;">$label2</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'url2'</span><span style="color: #339933;">=&gt;</span><span style="color: #000088;">$url2</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> &nbsp; &nbsp; <br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
<span style="color: #009900;">&#125;</span><br />
<span style="color: #339933;">@=</span>masterObjectsGrid <span style="color: #339933;">=</span> <span style="color: #000088;">$grd</span><span style="color: #339933;">;</span><br />
<span style="color: #339933;">@@</span>sGrid <span style="color: #339933;">=</span> <a href="http://php.net/json_encode"><span style="color: #990000;">json_encode</span></a><span style="color: #009900;">&#40;</span><span style="color: #000088;">$grd</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//serialized grid</span></div></div>
<p>Then, add the following JavaScript code to unserialize the grid in the form of a JSON string when the DynaForm loads and insert the URLs and labels in the links in the grid:</p>
<div class="geshifilter"><div class="php geshifilter-php" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">var</span> gridDecoded <span style="color: #339933;">=</span> <a href="http://php.net/eval"><span style="color: #990000;">eval</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'('</span> <span style="color: #339933;">+</span> getField<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;sGrid&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">.</span>value <span style="color: #339933;">+</span> <span style="color: #0000ff;">')'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <br />
<span style="color: #b1b100;">for</span> <span style="color: #009900;">&#40;</span><span style="color: #000000; font-weight: bold;">var</span> rowNo in gridDecoded<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp;getGridField<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'masterObjectsGrid'</span><span style="color: #339933;">,</span> rowNo<span style="color: #339933;">,</span> <span style="color: #0000ff;">'link1'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">.</span>innerHTML <span style="color: #339933;">=</span> gridDecoded<span style="color: #009900;">&#91;</span>rowNo<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'label1'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;getGridField<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'masterObjectsGrid'</span><span style="color: #339933;">,</span> rowNo<span style="color: #339933;">,</span> <span style="color: #0000ff;">'link1'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">.</span>href <span style="color: #339933;">=</span> gridDecoded<span style="color: #009900;">&#91;</span>rowNo<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'url1'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp;getGridField<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'masterObjectsGrid'</span><span style="color: #339933;">,</span> rowNo<span style="color: #339933;">,</span> <span style="color: #0000ff;">'link1'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">.</span>target <span style="color: #339933;">=</span> <span style="color: #0000ff;">'_blank'</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//to open in separate page</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span>gridDecoded<span style="color: #009900;">&#91;</span>rowNo<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'label2'</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">!=</span> <span style="color: #0000ff;">''</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; &nbsp; getGridField<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'masterObjectsGrid'</span><span style="color: #339933;">,</span> rowNo<span style="color: #339933;">,</span> <span style="color: #0000ff;">'link2'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">.</span>innerHTML <span style="color: #339933;">=</span> gridDecoded<span style="color: #009900;">&#91;</span>rowNo<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'label2'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; getGridField<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'masterObjectsGrid'</span><span style="color: #339933;">,</span> rowNo<span style="color: #339933;">,</span> <span style="color: #0000ff;">'link2'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">.</span>href <span style="color: #339933;">=</span> gridDecoded<span style="color: #009900;">&#91;</span>rowNo<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">'url2'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; getGridField<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'masterObjectsGrid'</span><span style="color: #339933;">,</span> rowNo<span style="color: #339933;">,</span> <span style="color: #0000ff;">'link2'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">.</span>target <span style="color: #339933;">=</span> <span style="color: #0000ff;">'_blank'</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//to open in separate page</span><br />
&nbsp; &nbsp;<span style="color: #009900;">&#125;</span><br />
&nbsp; &nbsp;<span style="color: #b1b100;">else</span><br />
&nbsp; &nbsp; &nbsp; hidden<span style="color: #009900;">&#40;</span>getGridField<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'masterObjectsGrid'</span><span style="color: #339933;">,</span> rowNo<span style="color: #339933;">,</span> <span style="color: #0000ff;">'link2'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #009900;">&#125;</span></div></div></div></div></div>  </div>

      <footer>
          </footer>
  
    </div>
  
</div> <!-- /.block -->
</div>
 <!-- /.region -->
      </section>
    </div>
  
      
    </div>

      
</div>

 <!---add diego--->
  <div id="download-app-section" class="download-app mobile-none">
			<div class="row">
				<div class="col-md-12">
					<div class="text_app">Download our app</div>
							<a href="https://itunes.apple.com/us/app/processmaker/id992576284?ls=1&amp;mt=8" target="_blank">
								<img src="../themes/thecompany_responsive_theme/images/appstore.png">
							<a href="https://play.google.com/store/apps/details?id=com.colosa.processmaker" target="_blank">
								<img src="../themes/thecompany_responsive_theme/images/playstore.png">				
				</div>
			</div>
  </div>
  <!---end diego--->
<!----add diego----->    
		<div class="logo_processmaker"><a href="http://www.processmaker.com/">
		<img src="../themes/thecompany_responsive_theme/images/logo_processmaker.png"></div>
<!----end diego----->
<div id="footer">
  <div id="footer_wrapper">
      </div>

  <div class="social-media-wrapper">
         <div id="social-media-icons">
       <ul>
       	<div class="text_contact">Contact us</div>
				<div class="text_number">+1-617-340-3377</div>
        <!--<li><a class="rss" href="/rss.xml">rss</a></li> <!--edit diego-->
        <li><a class="facebook" href="http://facebook.com/processmaker/" target="_blank" rel="me">facebook</a></li>
        <li><a class="twitter" href="https://twitter.com/processmaker" target="_blank" rel="me">twitter</a></li>
        <li><a class="gplus" href="https://www.google.com/+ProcessMakerOpenSource" target="_blank" rel="me">Gplus</a></li>
        <li><a class="linkedin" href="https://www.linkedin.com/groups?mostRecent=&amp;gid=3970335&amp;trk=my_groups-tile-flipgrp" target="_blank" rel="me">Linked in</a></li>
        <!--<li><a class="dribbble" href="http://dribbble.com" target="_blank" rel="me">Dribbble</a></li>
        <li><a class="vimeo" href="http://vimeo.com" target="_blank" rel="me">Vimeo</a></li>-->
        <li><a class="youtube" href="https://www.youtube.com/user/processmaker" target="_blank" rel="me">Youtube</a></li>
       </ul>
      </div>
      </div>
  
  <div class="footer_credit">
    <div class="footer_inner_credit">
           <div id="foot"><div class="region region-footer">
  <div id="block-block-2" class="block block-block">

      
  <div class="content">
    <p><font style="font-family:arial,sans-serif; font-size:15px; font-weight: none; color:#FFF">Automate your Workflow with Business Process Management<br>Software licensed under the <a 1px="" class="external text" href="http://www.gnu.org/licenses/agpl.html" rel="nofollow" style="padding-right: 13px; color:white;">GNU Affero General Public License version 3</a><br>Contact us:&nbsp;<a class="external free" href="mailto:community@processmaker.com" rel="nofollow" style="font-weight:bold;color:white;text-decoration:underline;">community@processmaker.com</a><br><a class="external free" href="https://www.processmaker.com/privacy-statement" rel="nofollow" style="font-weight:bold;color:white;text-decoration:underline;">Privacy Statement</a></font><br><font style="font-family:arial,sans-serif; font-size:15px; font-weight: none; color:#FFF">© Copyright 2000-2024 ProcessMaker Inc. All rights reserved.</font></p>
  </div>
  
</div> <!-- /.block -->
</div>
 <!-- /.region -->
</div>
         
   <!-- <div id="copyright">
      <p class="copyright">Copyright &copy; 2024, Documentation@ProcessMaker </p>
      <!--<p class="credits"> Developed by  <a href="http://www.zymphonies.com">Zymphonies</a></p>
      <div class="clear"></div>
    </div>-->
  </div>
  
  </div>
</div>

</div>

<script type="text/javascript">
  /* <![CDATA[ */
  document.write (
    '<img src="https://marketing.processmaker.com/acton/bn/3812/visitor.gif?ts='+ new Date().getTime()+ '&ref='+escape(document.referrer) + '">'
  );
  /* ]]> */
</script>
  
</div>
    <style>
    .center-div{
        width: 100%;        
        margin: 0 auto;
        z-index:10000;
        position:fixed;
        bottom: 0px;
        cursor:pointer;
    }
    .round-popup{
        margin:0 auto;
        font-family: 'Montserrat', sans-serif;
        font-size: 15px;
        font-weight: lighter;
        width: 412px;
        height: 50px;
        padding-top: 7px;
        text-align: center;
        position:relative;
    }
    .round-popup-button{
        position:absolute;
        top: 11px;
        right: 15px;
        background: transparent;
        border:none;
        font-size:15px;
        font-weight:normal;
        line-height:20px;
        width:20px;
        height:20px;
        padding:0;
    }
    .round-background-blue{
        background: url('http://www.processmaker.com/uploads/blue.png')no-repeat;
        color:white;
        
    }
    #box-pm31-button-blue{
        color: rgba(255, 255, 255, 0.5);
    }
    
    #box-pm31-button-blue:active,#box-pm31-button-blue:focus{
        border:none;
        outline:none;
    }
    .round-background-blue a{
        color: white!important;
        text-decoration: none;
        font-size: 15px;
        line-height:45px;
        font-family:Montserrat, sans-serif;
    }
    .round-background-blue span{
        font-weight: bold;
    }
    /*WHITE background*/
    .round-background-white{
        background: url('http://www.processmaker.com/uploads/white.png')no-repeat;
        background-position-x: -9px;        
        color: #3397E1;
    }
    .round-background-white a:hover{
        color: #3397E1!important;
        text-decoration: none;
        font-size: 15px;
    }
    #box-pm31-button-white{
        color: rgba(51, 151, 225, 0.7);
    }
</style>
    <div id="box-pm31" class="center-div" style="display:none;">
        <div class="round-popup round-background-blue">
            <a onclick="ga('send', 'event', 'WikiBlueBanner','click','PM31Release');" href="http://www.processmaker.com/download-processmaker-landing-page">
                <span>ProcessMaker 3.1</span> is Here! Download Now <span style="font-size:20px;font-weigth:normal;">»</span>
            </a>
            <button id="box-pm31-button-blue" class="round-popup-button">&times;</button>
        </div>
    </div>
    <script>

function pmCreateCookie(name,value,days) {
    if (days) {
        var date = new Date();
        date.setTime(date.getTime()+(days*24*60*60*1000));
        var expires = "; expires="+date.toGMTString();
    }
    else var expires = "";
    document.cookie = name+"="+value+expires+"; path=/";
}

function pmReadCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return null;
}

function pmEraseCookie(name) {
    createCookie(name,"",-1);
}



     jQuery(document).ready(function( $ ) {
        $('#box-pm31-button-blue').click(function(e){
                e.stopPropagation();
                $('#box-pm31').slideUp('fast');
                pmCreateCookie('ppcookie','val',10);
            });
        });
        jQuery(window).load(function() {
            if(pmReadCookie('ppcookie') !== 'val'){
                //jQuery('#box-pm31').delay( 2000 ).slideDown('slow');
            }
        });
    </script>
<link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet">

<script type="text/javascript">
  (function() {
    window._pa = window._pa || {};
    // _pa.orderId = "myOrderId"; // OPTIONAL: attach unique conversion identifier to conversions
    // _pa.revenue = "19.99"; // OPTIONAL: attach dynamic purchase values to conversions
    // _pa.productId = "myProductId"; // OPTIONAL: Include product ID for use with dynamic ads
    var pa = document.createElement('script'); pa.type = 'text/javascript'; pa.async = true;
    pa.src = ('https:' == document.location.protocol ? 'https:' : 'http:') + "//tag.marinsm.com/serve/586a7ec3a2ae6b728400003d.js";
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(pa, s);
  })();
</script>

</body>

<!-- Mirrored from wiki.processmaker.com/index.php/Sub-Processes by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Feb 2024 09:12:43 GMT -->
</html>
